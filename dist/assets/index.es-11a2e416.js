import{ak as rs,al as ur,am as ne,an as R_,ao as ef,ap as tf,aq as Nc,ar as wo,as as A_,a3 as rf,at as bi,au as T_,av as C_,aw as Z,ax as $_,ay as pc,az as N_,aA as D_,aB as F_,aC as Vh,aD as j_,aE as L_,aF as q_,aG as Kh,aH as M_,aI as z_,aJ as Qn,aK as Gh,aL as U_,aM as H_,aN as nf,aO as Dr,aP as B_,aQ as k_,aR as hn,aS as Nt,aT as er,aU as wi,aV as cr,aW as V_,aX as ln,aY as sf,aZ as K_,a_ as G_,a$ as W_,b0 as of,b1 as J_,b2 as af,b3 as cf,b4 as pn,b5 as dc,b6 as po,b7 as gn,b8 as Q_,b9 as go,ba as Y_,bb as X_,bc as Z_,bd as uo,be as em,bf as tm,bg as Ya,bh as Wh,bi as rm,bj as im,bk as nm,bl as Jh,bm as sm,bn as om,bo as am,bp as cm,bq as um,br as hm,bs as lm,bt as Kn,bu as uf,bv as Xa,bw as fm,bx as pm,a7 as dm}from"./index-c2e11835.js";import{e as Pr,$ as Dc}from"./events-b12aac63.js";var bo={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gc=function(a,r){return gc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},gc(a,r)};function gm(a,r){gc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var yc=function(){return yc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},yc.apply(this,arguments)};function ym(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function vm(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function _m(a,r){return function(t,n){r(t,n,a)}}function mm(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function wm(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(j){l(j)}}function m(O){try{y(n.throw(O))}catch(j){l(j)}}function y(O){O.done?c(O.value):s(O.value).then(p,m)}y((n=n.apply(a,r||[])).next())})}function bm(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return m([y,O])}}function m(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function Em(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function xm(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function vc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function hf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(p){l={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function Im(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(hf(arguments[r]));return a}function Sm(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,s++)n[s]=c[l];return n}function Yn(a){return this instanceof Yn?(this.v=a,this):new Yn(a)}function Pm(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(A){n[A]&&(s[A]=function(M){return new Promise(function(F,K){c.push([A,M,F,K])>1||p(A,M)})})}function p(A,M){try{m(n[A](M))}catch(F){j(c[0][3],F)}}function m(A){A.value instanceof Yn?Promise.resolve(A.value.v).then(y,O):j(c[0][2],A)}function y(A){p("next",A)}function O(A){p("throw",A)}function j(A,M){A(M),c.shift(),c.length&&p(c[0][0],c[0][1])}}function Om(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Yn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function Rm(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof vc=="function"?vc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,m){l=a[c](l),s(p,m,l.done,l.value)})}}function s(c,l,p,m){Promise.resolve(m).then(function(y){c({value:y,done:p})},l)}}function Am(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Tm(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function Cm(a){return a&&a.__esModule?a:{default:a}}function $m(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Nm(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const Dm=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return yc},__asyncDelegator:Om,__asyncGenerator:Pm,__asyncValues:Rm,__await:Yn,__awaiter:wm,__classPrivateFieldGet:$m,__classPrivateFieldSet:Nm,__createBinding:Em,__decorate:vm,__exportStar:xm,__extends:gm,__generator:bm,__importDefault:Cm,__importStar:Tm,__makeTemplateObject:Am,__metadata:mm,__param:_m,__read:hf,__rest:ym,__spread:Im,__spreadArrays:Sm,__values:vc},Symbol.toStringTag,{value:"Module"})),lf=rs(Dm);var is={};Object.defineProperty(is,"__esModule",{value:!0});function Fm(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return JSON.parse(a)}catch{return a}}is.safeJsonParse=Fm;function jm(a){return typeof a=="string"?a:JSON.stringify(a,(r,t)=>typeof t>"u"?null:t)}is.safeJsonStringify=jm;var jn={exports:{}},Qh;function Lm(){return Qh||(Qh=1,function(){let a;function r(){}a=r,a.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},a.prototype.setItem=function(t,n){this[t]=String(n)},a.prototype.removeItem=function(t){delete this[t]},a.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},a.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ur<"u"&&ur.localStorage?jn.exports=ur.localStorage:typeof window<"u"&&window.localStorage?jn.exports=window.localStorage:jn.exports=new r}()),jn.exports}var Za={},Ln={},Yh;function qm(){if(Yh)return Ln;Yh=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.IKeyValueStorage=void 0;class a{}return Ln.IKeyValueStorage=a,Ln}var qn={},Xh;function Mm(){if(Xh)return qn;Xh=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.parseEntry=void 0;const a=is;function r(t){var n;return[t[0],a.safeJsonParse((n=t[1])!==null&&n!==void 0?n:"")]}return qn.parseEntry=r,qn}var Zh;function zm(){return Zh||(Zh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=lf;r.__exportStar(qm(),a),r.__exportStar(Mm(),a)}(Za)),Za}Object.defineProperty(bo,"__esModule",{value:!0});bo.KeyValueStorage=void 0;const fn=lf,el=is,Um=fn.__importDefault(Lm()),Hm=zm();class ff{constructor(){this.localStorage=Um.default}getKeys(){return fn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return fn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Hm.parseEntry)})}getItem(r){return fn.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(r);if(t!==null)return el.safeJsonParse(t)})}setItem(r,t){return fn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(r,el.safeJsonStringify(t))})}removeItem(r){return fn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(r)})}}bo.KeyValueStorage=ff;var Bm=bo.default=ff,yn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _c=function(a,r){return _c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},_c(a,r)};function km(a,r){_c(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var mc=function(){return mc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},mc.apply(this,arguments)};function Vm(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function Km(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function Gm(a,r){return function(t,n){r(t,n,a)}}function Wm(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function Jm(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(j){l(j)}}function m(O){try{y(n.throw(O))}catch(j){l(j)}}function y(O){O.done?c(O.value):s(O.value).then(p,m)}y((n=n.apply(a,r||[])).next())})}function Qm(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return m([y,O])}}function m(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function Ym(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function Xm(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function wc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function pf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(p){l={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function Zm(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(pf(arguments[r]));return a}function e1(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,s++)n[s]=c[l];return n}function Xn(a){return this instanceof Xn?(this.v=a,this):new Xn(a)}function t1(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(A){n[A]&&(s[A]=function(M){return new Promise(function(F,K){c.push([A,M,F,K])>1||p(A,M)})})}function p(A,M){try{m(n[A](M))}catch(F){j(c[0][3],F)}}function m(A){A.value instanceof Xn?Promise.resolve(A.value.v).then(y,O):j(c[0][2],A)}function y(A){p("next",A)}function O(A){p("throw",A)}function j(A,M){A(M),c.shift(),c.length&&p(c[0][0],c[0][1])}}function r1(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Xn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function i1(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof wc=="function"?wc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,m){l=a[c](l),s(p,m,l.done,l.value)})}}function s(c,l,p,m){Promise.resolve(m).then(function(y){c({value:y,done:p})},l)}}function n1(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function s1(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function o1(a){return a&&a.__esModule?a:{default:a}}function a1(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function c1(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const u1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return mc},__asyncDelegator:r1,__asyncGenerator:t1,__asyncValues:i1,__await:Xn,__awaiter:Jm,__classPrivateFieldGet:a1,__classPrivateFieldSet:c1,__createBinding:Ym,__decorate:Km,__exportStar:Xm,__extends:km,__generator:Qm,__importDefault:o1,__importStar:s1,__makeTemplateObject:n1,__metadata:Wm,__param:Gm,__read:pf,__rest:Vm,__spread:Zm,__spreadArrays:e1,__values:wc},Symbol.toStringTag,{value:"Module"})),Eo=rs(u1);var Mn={},ec={},zn={};let Ui=class{};const h1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ui},Symbol.toStringTag,{value:"Module"})),l1=rs(h1);var tl;function f1(){if(tl)return zn;tl=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.IHeartBeat=void 0;const a=l1;class r extends a.IEvents{constructor(n){super()}}return zn.IHeartBeat=r,zn}var rl;function df(){return rl||(rl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Eo.__exportStar(f1(),a)}(ec)),ec}var tc={},Mi={},il;function p1(){if(il)return Mi;il=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.HEARTBEAT_EVENTS=Mi.HEARTBEAT_INTERVAL=void 0;const a=ne;return Mi.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Mi}var nl;function gf(){return nl||(nl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Eo.__exportStar(p1(),a)}(tc)),tc}var sl;function d1(){if(sl)return Mn;sl=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.HeartBeat=void 0;const a=Eo,r=Pr,t=ne,n=df(),s=gf();class c extends n.IHeartBeat{constructor(p){super(p),this.events=new r.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(p==null?void 0:p.interval)||s.HEARTBEAT_INTERVAL}static init(p){return a.__awaiter(this,void 0,void 0,function*(){const m=new c(p);return yield m.init(),m})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,m){this.events.on(p,m)}once(p,m){this.events.once(p,m)}off(p,m){this.events.off(p,m)}removeListener(p,m){this.events.removeListener(p,m)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return Mn.HeartBeat=c,Mn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Eo;r.__exportStar(d1(),a),r.__exportStar(df(),a),r.__exportStar(gf(),a)})(yn);var Te={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bc=function(a,r){return bc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},bc(a,r)};function g1(a,r){bc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Ec=function(){return Ec=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},Ec.apply(this,arguments)};function y1(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function v1(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function _1(a,r){return function(t,n){r(t,n,a)}}function m1(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function w1(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(j){l(j)}}function m(O){try{y(n.throw(O))}catch(j){l(j)}}function y(O){O.done?c(O.value):s(O.value).then(p,m)}y((n=n.apply(a,r||[])).next())})}function b1(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return m([y,O])}}function m(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function E1(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function x1(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function xc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function yf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(p){l={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function I1(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(yf(arguments[r]));return a}function S1(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,s++)n[s]=c[l];return n}function Zn(a){return this instanceof Zn?(this.v=a,this):new Zn(a)}function P1(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(A){n[A]&&(s[A]=function(M){return new Promise(function(F,K){c.push([A,M,F,K])>1||p(A,M)})})}function p(A,M){try{m(n[A](M))}catch(F){j(c[0][3],F)}}function m(A){A.value instanceof Zn?Promise.resolve(A.value.v).then(y,O):j(c[0][2],A)}function y(A){p("next",A)}function O(A){p("throw",A)}function j(A,M){A(M),c.shift(),c.length&&p(c[0][0],c[0][1])}}function O1(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Zn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function R1(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof xc=="function"?xc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,m){l=a[c](l),s(p,m,l.done,l.value)})}}function s(c,l,p,m){Promise.resolve(m).then(function(y){c({value:y,done:p})},l)}}function A1(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function T1(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function C1(a){return a&&a.__esModule?a:{default:a}}function $1(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function N1(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const D1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ec},__asyncDelegator:O1,__asyncGenerator:P1,__asyncValues:R1,__await:Zn,__awaiter:w1,__classPrivateFieldGet:$1,__classPrivateFieldSet:N1,__createBinding:E1,__decorate:v1,__exportStar:x1,__extends:g1,__generator:b1,__importDefault:C1,__importStar:T1,__makeTemplateObject:A1,__metadata:m1,__param:_1,__read:yf,__rest:y1,__spread:I1,__spreadArrays:S1,__values:xc},Symbol.toStringTag,{value:"Module"})),F1=rs(D1);var rc,ol;function j1(){if(ol)return rc;ol=1;function a(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}rc=r;function r(t,n,s){var c=s&&s.stringify||a,l=1;if(typeof t=="object"&&t!==null){var p=n.length+l;if(p===1)return t;var m=new Array(p);m[0]=c(t);for(var y=1;y<p;y++)m[y]=c(n[y]);return m.join(" ")}if(typeof t!="string")return t;var O=n.length;if(O===0)return t;for(var j="",A=1-l,M=-1,F=t&&t.length||0,K=0;K<F;){if(t.charCodeAt(K)===37&&K+1<F){switch(M=M>-1?M:0,t.charCodeAt(K+1)){case 100:case 102:if(A>=O||n[A]==null)break;M<K&&(j+=t.slice(M,K)),j+=Number(n[A]),M=K+2,K++;break;case 105:if(A>=O||n[A]==null)break;M<K&&(j+=t.slice(M,K)),j+=Math.floor(Number(n[A])),M=K+2,K++;break;case 79:case 111:case 106:if(A>=O||n[A]===void 0)break;M<K&&(j+=t.slice(M,K));var ie=typeof n[A];if(ie==="string"){j+="'"+n[A]+"'",M=K+2,K++;break}if(ie==="function"){j+=n[A].name||"<anonymous>",M=K+2,K++;break}j+=c(n[A]),M=K+2,K++;break;case 115:if(A>=O)break;M<K&&(j+=t.slice(M,K)),j+=String(n[A]),M=K+2,K++;break;case 37:M<K&&(j+=t.slice(M,K)),j+="%",M=K+2,K++,A--;break}++A}++K}return M===-1?t:(M<F&&(j+=t.slice(M)),j)}return rc}var ic,al;function L1(){if(al)return ic;al=1;const a=j1();ic=s;const r=le().console||{},t={mapHttpRequest:F,mapHttpResponse:F,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:F,res:F,err:A};function n(N,U){return Array.isArray(N)?N.filter(function(ye){return ye!=="!stdSerializers.err"}):N===!0?Object.keys(U):!1}function s(N){N=N||{},N.browser=N.browser||{};const U=N.browser.transmit;if(U&&typeof U.send!="function")throw Error("pino: transmit option must have a send function");const W=N.browser.write||r;N.browser.write&&(N.browser.asObject=!0);const ye=N.serializers||{},re=n(N.browser.serialize,ye);let ue=N.browser.serialize;Array.isArray(N.browser.serialize)&&N.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Ce=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),N.enabled===!1&&(N.level="silent");const ze=N.level||"info",_=Object.create(W);_.log||(_.log=ie),Object.defineProperty(_,"levelVal",{get:Y}),Object.defineProperty(_,"level",{get:ce,set:V});const x={transmit:U,serialize:re,asObject:N.browser.asObject,levels:Ce,timestamp:M(N)};_.levels=s.levels,_.level=ze,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=ie,_.serializers=ye,_._serialize=re,_._stdErrSerialize=ue,_.child=H,U&&(_._logEvent=j());function Y(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function V(k){if(k!=="silent"&&!this.levels.values[k])throw Error("unknown level "+k);this._level=k,c(x,_,"error","log"),c(x,_,"fatal","error"),c(x,_,"warn","error"),c(x,_,"info","log"),c(x,_,"debug","log"),c(x,_,"trace","log")}function H(k,G){if(!k)throw new Error("missing bindings for child Pino");G=G||{},re&&k.serializers&&(G.serializers=k.serializers);const Je=G.serializers;if(re&&Je){var Be=Object.assign({},ye,Je),jr=N.browser.serialize===!0?Object.keys(Be):re;delete k.serializers,m([k],jr,Be,this._stdErrSerialize)}function xe(xt){this._childLevel=(xt._childLevel|0)+1,this.error=y(xt,k,"error"),this.fatal=y(xt,k,"fatal"),this.warn=y(xt,k,"warn"),this.info=y(xt,k,"info"),this.debug=y(xt,k,"debug"),this.trace=y(xt,k,"trace"),Be&&(this.serializers=Be,this._serialize=jr),U&&(this._logEvent=j([].concat(xt._logEvent.bindings,k)))}return xe.prototype=this,new xe(this)}return _}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=t,s.stdTimeFunctions=Object.assign({},{nullTime:Ee,epochTime:ge,unixTime:pe,isoTime:he});function c(N,U,W,ye){const re=Object.getPrototypeOf(U);U[W]=U.levelVal>U.levels.values[W]?ie:re[W]?re[W]:r[W]||r[ye]||ie,l(N,U,W)}function l(N,U,W){!N.transmit&&U[W]===ie||(U[W]=function(ye){return function(){const ue=N.timestamp(),Ce=new Array(arguments.length),ze=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var _=0;_<Ce.length;_++)Ce[_]=arguments[_];if(N.serialize&&!N.asObject&&m(Ce,this._serialize,this.serializers,this._stdErrSerialize),N.asObject?ye.call(ze,p(this,W,Ce,ue)):ye.apply(ze,Ce),N.transmit){const x=N.transmit.level||U.level,Y=s.levels.values[x],ce=s.levels.values[W];if(ce<Y)return;O(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:x,transmitValue:s.levels.values[N.transmit.level||U.level],send:N.transmit.send,val:U.levelVal},Ce)}}}(U[W]))}function p(N,U,W,ye){N._serialize&&m(W,N._serialize,N.serializers,N._stdErrSerialize);const re=W.slice();let ue=re[0];const Ce={};ye&&(Ce.time=ye),Ce.level=s.levels.values[U];let ze=(N._childLevel|0)+1;if(ze<1&&(ze=1),ue!==null&&typeof ue=="object"){for(;ze--&&typeof re[0]=="object";)Object.assign(Ce,re.shift());ue=re.length?a(re.shift(),re):void 0}else typeof ue=="string"&&(ue=a(re.shift(),re));return ue!==void 0&&(Ce.msg=ue),Ce}function m(N,U,W,ye){for(const re in N)if(ye&&N[re]instanceof Error)N[re]=s.stdSerializers.err(N[re]);else if(typeof N[re]=="object"&&!Array.isArray(N[re]))for(const ue in N[re])U&&U.indexOf(ue)>-1&&ue in W&&(N[re][ue]=W[ue](N[re][ue]))}function y(N,U,W){return function(){const ye=new Array(1+arguments.length);ye[0]=U;for(var re=1;re<ye.length;re++)ye[re]=arguments[re-1];return N[W].apply(this,ye)}}function O(N,U,W){const ye=U.send,re=U.ts,ue=U.methodLevel,Ce=U.methodValue,ze=U.val,_=N._logEvent.bindings;m(W,N._serialize||Object.keys(N.serializers),N.serializers,N._stdErrSerialize===void 0?!0:N._stdErrSerialize),N._logEvent.ts=re,N._logEvent.messages=W.filter(function(x){return _.indexOf(x)===-1}),N._logEvent.level.label=ue,N._logEvent.level.value=Ce,ye(ue,N._logEvent,ze),N._logEvent=j(_)}function j(N){return{ts:0,messages:[],bindings:N||[],level:{label:"",value:0}}}function A(N){const U={type:N.constructor.name,msg:N.message,stack:N.stack};for(const W in N)U[W]===void 0&&(U[W]=N[W]);return U}function M(N){return typeof N.timestamp=="function"?N.timestamp:N.timestamp===!1?Ee:ge}function F(){return{}}function K(N){return N}function ie(){}function Ee(){return!1}function ge(){return Date.now()}function pe(){return Math.round(Date.now()/1e3)}function he(){return new Date(Date.now()).toISOString()}function le(){function N(U){return typeof U<"u"&&U}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return N(self)||N(window)||N(this)||{}}}return ic}var zi={},cl;function vf(){return cl||(cl=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.PINO_CUSTOM_CONTEXT_KEY=zi.PINO_LOGGER_DEFAULTS=void 0,zi.PINO_LOGGER_DEFAULTS={level:"info"},zi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),zi}var Zt={},ul;function q1(){if(ul)return Zt;ul=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.generateChildLogger=Zt.formatChildLoggerContext=Zt.getLoggerContext=Zt.setBrowserLoggerContext=Zt.getBrowserLoggerContext=Zt.getDefaultLoggerOptions=void 0;const a=vf();function r(p){return Object.assign(Object.assign({},p),{level:(p==null?void 0:p.level)||a.PINO_LOGGER_DEFAULTS.level})}Zt.getDefaultLoggerOptions=r;function t(p,m=a.PINO_CUSTOM_CONTEXT_KEY){return p[m]||""}Zt.getBrowserLoggerContext=t;function n(p,m,y=a.PINO_CUSTOM_CONTEXT_KEY){return p[y]=m,p}Zt.setBrowserLoggerContext=n;function s(p,m=a.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof p.bindings>"u"?y=t(p,m):y=p.bindings().context||"",y}Zt.getLoggerContext=s;function c(p,m,y=a.PINO_CUSTOM_CONTEXT_KEY){const O=s(p,y);return O.trim()?`${O}/${m}`:m}Zt.formatChildLoggerContext=c;function l(p,m,y=a.PINO_CUSTOM_CONTEXT_KEY){const O=c(p,m,y),j=p.child({context:O});return n(j,O,y)}return Zt.generateChildLogger=l,Zt}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const r=F1,t=r.__importDefault(L1());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return t.default}}),r.__exportStar(vf(),a),r.__exportStar(q1(),a)})(Te);class M1 extends Ui{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class z1 extends Ui{constructor(r,t){super(),this.core=r,this.logger=t,this.records=new Map}}class U1{constructor(r,t){this.logger=r,this.core=t}}let H1=class extends Ui{constructor(r,t){super(),this.relayer=r,this.logger=t}},B1=class extends Ui{constructor(r){super()}},k1=class{constructor(r,t,n,s){this.core=r,this.logger=t,this.name=n}};class V1 extends Ui{constructor(r,t){super(),this.relayer=r,this.logger=t}}let K1=class extends Ui{constructor(r,t){super(),this.core=r,this.logger=t}},G1=class{constructor(r,t){this.projectId=r,this.logger=t}},W1=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},J1=class{constructor(r){this.client=r}};const Q1=a=>JSON.stringify(a,(r,t)=>typeof t=="bigint"?t.toString()+"n":t),Y1=a=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=a.replace(r,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Fc(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return Y1(a)}catch{return a}}function es(a){return typeof a=="string"?a:Q1(a)||""}var jc={},_f={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=R_,t=ef;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function p(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},p.prototype.update=function(m,y){if(y===void 0&&(y=m.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var O=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=m[O++],y--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(O=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,m,O,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=m[O++],y--;return this},p.prototype.finish=function(m){if(!this._finished){var y=this._bytesHashed,O=this._bufferLength,j=y/536870912|0,A=y<<3,M=y%128<112?128:256;this._buffer[O]=128;for(var F=O+1;F<M-8;F++)this._buffer[F]=0;r.writeUint32BE(j,this._buffer,M-8),r.writeUint32BE(A,this._buffer,M-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,M),this._finished=!0}for(var F=0;F<this.digestLength/8;F++)r.writeUint32BE(this._stateHi[F],m,F*8),r.writeUint32BE(this._stateLo[F],m,F*8+4);return this},p.prototype.digest=function(){var m=new Uint8Array(this.digestLength);return this.finish(m),m},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(m){return this._stateHi.set(m.stateHi),this._stateLo.set(m.stateLo),this._bufferLength=m.bufferLength,m.buffer&&this._buffer.set(m.buffer),this._bytesHashed=m.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(m){t.wipe(m.stateHi),t.wipe(m.stateLo),m.buffer&&t.wipe(m.buffer),m.bufferLength=0,m.bytesHashed=0},p}();a.SHA512=n;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(p,m,y,O,j,A,M){for(var F=y[0],K=y[1],ie=y[2],Ee=y[3],ge=y[4],pe=y[5],he=y[6],le=y[7],N=O[0],U=O[1],W=O[2],ye=O[3],re=O[4],ue=O[5],Ce=O[6],ze=O[7],_,x,Y,ce,V,H,k,G;M>=128;){for(var Je=0;Je<16;Je++){var Be=8*Je+A;p[Je]=r.readUint32BE(j,Be),m[Je]=r.readUint32BE(j,Be+4)}for(var Je=0;Je<80;Je++){var jr=F,xe=K,xt=ie,$=Ee,C=ge,R=pe,h=he,E=le,ee=N,fe=U,we=W,$e=ye,De=re,Pe=ue,It=Ce,_t=ze;if(_=le,x=ze,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=(ge>>>14|re<<32-14)^(ge>>>18|re<<32-18)^(re>>>41-32|ge<<32-(41-32)),x=(re>>>14|ge<<32-14)^(re>>>18|ge<<32-18)^(ge>>>41-32|re<<32-(41-32)),V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,_=ge&pe^~ge&he,x=re&ue^~re&Ce,V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,_=s[Je*2],x=s[Je*2+1],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,_=p[Je%16],x=m[Je%16],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,Y=k&65535|G<<16,ce=V&65535|H<<16,_=Y,x=ce,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=(F>>>28|N<<32-28)^(N>>>34-32|F<<32-(34-32))^(N>>>39-32|F<<32-(39-32)),x=(N>>>28|F<<32-28)^(F>>>34-32|N<<32-(34-32))^(F>>>39-32|N<<32-(39-32)),V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,_=F&K^F&ie^K&ie,x=N&U^N&W^U&W,V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,E=k&65535|G<<16,_t=V&65535|H<<16,_=$,x=$e,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=Y,x=ce,V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,$=k&65535|G<<16,$e=V&65535|H<<16,K=jr,ie=xe,Ee=xt,ge=$,pe=C,he=R,le=h,F=E,U=ee,W=fe,ye=we,re=$e,ue=De,Ce=Pe,ze=It,N=_t,Je%16===15)for(var Be=0;Be<16;Be++)_=p[Be],x=m[Be],V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=p[(Be+9)%16],x=m[(Be+9)%16],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,Y=p[(Be+1)%16],ce=m[(Be+1)%16],_=(Y>>>1|ce<<32-1)^(Y>>>8|ce<<32-8)^Y>>>7,x=(ce>>>1|Y<<32-1)^(ce>>>8|Y<<32-8)^(ce>>>7|Y<<32-7),V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,Y=p[(Be+14)%16],ce=m[(Be+14)%16],_=(Y>>>19|ce<<32-19)^(ce>>>61-32|Y<<32-(61-32))^Y>>>6,x=(ce>>>19|Y<<32-19)^(Y>>>61-32|ce<<32-(61-32))^(ce>>>6|Y<<32-6),V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[Be]=k&65535|G<<16,m[Be]=V&65535|H<<16}_=F,x=N,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=y[0],x=O[0],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,y[0]=F=k&65535|G<<16,O[0]=N=V&65535|H<<16,_=K,x=U,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=y[1],x=O[1],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,y[1]=K=k&65535|G<<16,O[1]=U=V&65535|H<<16,_=ie,x=W,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=y[2],x=O[2],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,y[2]=ie=k&65535|G<<16,O[2]=W=V&65535|H<<16,_=Ee,x=ye,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=y[3],x=O[3],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,y[3]=Ee=k&65535|G<<16,O[3]=ye=V&65535|H<<16,_=ge,x=re,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=y[4],x=O[4],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,y[4]=ge=k&65535|G<<16,O[4]=re=V&65535|H<<16,_=pe,x=ue,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=y[5],x=O[5],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,y[5]=pe=k&65535|G<<16,O[5]=ue=V&65535|H<<16,_=he,x=Ce,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=y[6],x=O[6],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,y[6]=he=k&65535|G<<16,O[6]=Ce=V&65535|H<<16,_=le,x=ze,V=x&65535,H=x>>>16,k=_&65535,G=_>>>16,_=y[7],x=O[7],V+=x&65535,H+=x>>>16,k+=_&65535,G+=_>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,y[7]=le=k&65535|G<<16,O[7]=ze=V&65535|H<<16,A+=128,M-=128}return A}function l(p){var m=new n;m.update(p);var y=m.digest();return m.clean(),y}a.hash=l})(_f);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const r=tf,t=_f,n=ef;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function s($){const C=new Float64Array(16);if($)for(let R=0;R<$.length;R++)C[R]=$[R];return C}const c=new Uint8Array(32);c[0]=9;const l=s(),p=s([1]),m=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),O=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),j=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function M($,C){for(let R=0;R<16;R++)$[R]=C[R]|0}function F($){let C=1;for(let R=0;R<16;R++){let h=$[R]+C+65535;C=Math.floor(h/65536),$[R]=h-C*65536}$[0]+=C-1+37*(C-1)}function K($,C,R){const h=~(R-1);for(let E=0;E<16;E++){const ee=h&($[E]^C[E]);$[E]^=ee,C[E]^=ee}}function ie($,C){const R=s(),h=s();for(let E=0;E<16;E++)h[E]=C[E];F(h),F(h),F(h);for(let E=0;E<2;E++){R[0]=h[0]-65517;for(let fe=1;fe<15;fe++)R[fe]=h[fe]-65535-(R[fe-1]>>16&1),R[fe-1]&=65535;R[15]=h[15]-32767-(R[14]>>16&1);const ee=R[15]>>16&1;R[14]&=65535,K(h,R,1-ee)}for(let E=0;E<16;E++)$[2*E]=h[E]&255,$[2*E+1]=h[E]>>8}function Ee($,C){let R=0;for(let h=0;h<32;h++)R|=$[h]^C[h];return(1&R-1>>>8)-1}function ge($,C){const R=new Uint8Array(32),h=new Uint8Array(32);return ie(R,$),ie(h,C),Ee(R,h)}function pe($){const C=new Uint8Array(32);return ie(C,$),C[0]&1}function he($,C){for(let R=0;R<16;R++)$[R]=C[2*R]+(C[2*R+1]<<8);$[15]&=32767}function le($,C,R){for(let h=0;h<16;h++)$[h]=C[h]+R[h]}function N($,C,R){for(let h=0;h<16;h++)$[h]=C[h]-R[h]}function U($,C,R){let h,E,ee=0,fe=0,we=0,$e=0,De=0,Pe=0,It=0,_t=0,ot=0,je=0,Ye=0,Xe=0,at=0,Ue=0,Ze=0,Ne=0,ke=0,ht=0,qe=0,St=0,Dt=0,zt=0,Ut=0,Lt=0,Gt=0,tr=0,Lr=0,Wt=0,kr=0,ui=0,Si=0,lt=R[0],rt=R[1],ft=R[2],pt=R[3],ct=R[4],it=R[5],Pt=R[6],Ot=R[7],dt=R[8],Rt=R[9],gt=R[10],mt=R[11],yt=R[12],Qe=R[13],At=R[14],Tt=R[15];h=C[0],ee+=h*lt,fe+=h*rt,we+=h*ft,$e+=h*pt,De+=h*ct,Pe+=h*it,It+=h*Pt,_t+=h*Ot,ot+=h*dt,je+=h*Rt,Ye+=h*gt,Xe+=h*mt,at+=h*yt,Ue+=h*Qe,Ze+=h*At,Ne+=h*Tt,h=C[1],fe+=h*lt,we+=h*rt,$e+=h*ft,De+=h*pt,Pe+=h*ct,It+=h*it,_t+=h*Pt,ot+=h*Ot,je+=h*dt,Ye+=h*Rt,Xe+=h*gt,at+=h*mt,Ue+=h*yt,Ze+=h*Qe,Ne+=h*At,ke+=h*Tt,h=C[2],we+=h*lt,$e+=h*rt,De+=h*ft,Pe+=h*pt,It+=h*ct,_t+=h*it,ot+=h*Pt,je+=h*Ot,Ye+=h*dt,Xe+=h*Rt,at+=h*gt,Ue+=h*mt,Ze+=h*yt,Ne+=h*Qe,ke+=h*At,ht+=h*Tt,h=C[3],$e+=h*lt,De+=h*rt,Pe+=h*ft,It+=h*pt,_t+=h*ct,ot+=h*it,je+=h*Pt,Ye+=h*Ot,Xe+=h*dt,at+=h*Rt,Ue+=h*gt,Ze+=h*mt,Ne+=h*yt,ke+=h*Qe,ht+=h*At,qe+=h*Tt,h=C[4],De+=h*lt,Pe+=h*rt,It+=h*ft,_t+=h*pt,ot+=h*ct,je+=h*it,Ye+=h*Pt,Xe+=h*Ot,at+=h*dt,Ue+=h*Rt,Ze+=h*gt,Ne+=h*mt,ke+=h*yt,ht+=h*Qe,qe+=h*At,St+=h*Tt,h=C[5],Pe+=h*lt,It+=h*rt,_t+=h*ft,ot+=h*pt,je+=h*ct,Ye+=h*it,Xe+=h*Pt,at+=h*Ot,Ue+=h*dt,Ze+=h*Rt,Ne+=h*gt,ke+=h*mt,ht+=h*yt,qe+=h*Qe,St+=h*At,Dt+=h*Tt,h=C[6],It+=h*lt,_t+=h*rt,ot+=h*ft,je+=h*pt,Ye+=h*ct,Xe+=h*it,at+=h*Pt,Ue+=h*Ot,Ze+=h*dt,Ne+=h*Rt,ke+=h*gt,ht+=h*mt,qe+=h*yt,St+=h*Qe,Dt+=h*At,zt+=h*Tt,h=C[7],_t+=h*lt,ot+=h*rt,je+=h*ft,Ye+=h*pt,Xe+=h*ct,at+=h*it,Ue+=h*Pt,Ze+=h*Ot,Ne+=h*dt,ke+=h*Rt,ht+=h*gt,qe+=h*mt,St+=h*yt,Dt+=h*Qe,zt+=h*At,Ut+=h*Tt,h=C[8],ot+=h*lt,je+=h*rt,Ye+=h*ft,Xe+=h*pt,at+=h*ct,Ue+=h*it,Ze+=h*Pt,Ne+=h*Ot,ke+=h*dt,ht+=h*Rt,qe+=h*gt,St+=h*mt,Dt+=h*yt,zt+=h*Qe,Ut+=h*At,Lt+=h*Tt,h=C[9],je+=h*lt,Ye+=h*rt,Xe+=h*ft,at+=h*pt,Ue+=h*ct,Ze+=h*it,Ne+=h*Pt,ke+=h*Ot,ht+=h*dt,qe+=h*Rt,St+=h*gt,Dt+=h*mt,zt+=h*yt,Ut+=h*Qe,Lt+=h*At,Gt+=h*Tt,h=C[10],Ye+=h*lt,Xe+=h*rt,at+=h*ft,Ue+=h*pt,Ze+=h*ct,Ne+=h*it,ke+=h*Pt,ht+=h*Ot,qe+=h*dt,St+=h*Rt,Dt+=h*gt,zt+=h*mt,Ut+=h*yt,Lt+=h*Qe,Gt+=h*At,tr+=h*Tt,h=C[11],Xe+=h*lt,at+=h*rt,Ue+=h*ft,Ze+=h*pt,Ne+=h*ct,ke+=h*it,ht+=h*Pt,qe+=h*Ot,St+=h*dt,Dt+=h*Rt,zt+=h*gt,Ut+=h*mt,Lt+=h*yt,Gt+=h*Qe,tr+=h*At,Lr+=h*Tt,h=C[12],at+=h*lt,Ue+=h*rt,Ze+=h*ft,Ne+=h*pt,ke+=h*ct,ht+=h*it,qe+=h*Pt,St+=h*Ot,Dt+=h*dt,zt+=h*Rt,Ut+=h*gt,Lt+=h*mt,Gt+=h*yt,tr+=h*Qe,Lr+=h*At,Wt+=h*Tt,h=C[13],Ue+=h*lt,Ze+=h*rt,Ne+=h*ft,ke+=h*pt,ht+=h*ct,qe+=h*it,St+=h*Pt,Dt+=h*Ot,zt+=h*dt,Ut+=h*Rt,Lt+=h*gt,Gt+=h*mt,tr+=h*yt,Lr+=h*Qe,Wt+=h*At,kr+=h*Tt,h=C[14],Ze+=h*lt,Ne+=h*rt,ke+=h*ft,ht+=h*pt,qe+=h*ct,St+=h*it,Dt+=h*Pt,zt+=h*Ot,Ut+=h*dt,Lt+=h*Rt,Gt+=h*gt,tr+=h*mt,Lr+=h*yt,Wt+=h*Qe,kr+=h*At,ui+=h*Tt,h=C[15],Ne+=h*lt,ke+=h*rt,ht+=h*ft,qe+=h*pt,St+=h*ct,Dt+=h*it,zt+=h*Pt,Ut+=h*Ot,Lt+=h*dt,Gt+=h*Rt,tr+=h*gt,Lr+=h*mt,Wt+=h*yt,kr+=h*Qe,ui+=h*At,Si+=h*Tt,ee+=38*ke,fe+=38*ht,we+=38*qe,$e+=38*St,De+=38*Dt,Pe+=38*zt,It+=38*Ut,_t+=38*Lt,ot+=38*Gt,je+=38*tr,Ye+=38*Lr,Xe+=38*Wt,at+=38*kr,Ue+=38*ui,Ze+=38*Si,E=1,h=ee+E+65535,E=Math.floor(h/65536),ee=h-E*65536,h=fe+E+65535,E=Math.floor(h/65536),fe=h-E*65536,h=we+E+65535,E=Math.floor(h/65536),we=h-E*65536,h=$e+E+65535,E=Math.floor(h/65536),$e=h-E*65536,h=De+E+65535,E=Math.floor(h/65536),De=h-E*65536,h=Pe+E+65535,E=Math.floor(h/65536),Pe=h-E*65536,h=It+E+65535,E=Math.floor(h/65536),It=h-E*65536,h=_t+E+65535,E=Math.floor(h/65536),_t=h-E*65536,h=ot+E+65535,E=Math.floor(h/65536),ot=h-E*65536,h=je+E+65535,E=Math.floor(h/65536),je=h-E*65536,h=Ye+E+65535,E=Math.floor(h/65536),Ye=h-E*65536,h=Xe+E+65535,E=Math.floor(h/65536),Xe=h-E*65536,h=at+E+65535,E=Math.floor(h/65536),at=h-E*65536,h=Ue+E+65535,E=Math.floor(h/65536),Ue=h-E*65536,h=Ze+E+65535,E=Math.floor(h/65536),Ze=h-E*65536,h=Ne+E+65535,E=Math.floor(h/65536),Ne=h-E*65536,ee+=E-1+37*(E-1),E=1,h=ee+E+65535,E=Math.floor(h/65536),ee=h-E*65536,h=fe+E+65535,E=Math.floor(h/65536),fe=h-E*65536,h=we+E+65535,E=Math.floor(h/65536),we=h-E*65536,h=$e+E+65535,E=Math.floor(h/65536),$e=h-E*65536,h=De+E+65535,E=Math.floor(h/65536),De=h-E*65536,h=Pe+E+65535,E=Math.floor(h/65536),Pe=h-E*65536,h=It+E+65535,E=Math.floor(h/65536),It=h-E*65536,h=_t+E+65535,E=Math.floor(h/65536),_t=h-E*65536,h=ot+E+65535,E=Math.floor(h/65536),ot=h-E*65536,h=je+E+65535,E=Math.floor(h/65536),je=h-E*65536,h=Ye+E+65535,E=Math.floor(h/65536),Ye=h-E*65536,h=Xe+E+65535,E=Math.floor(h/65536),Xe=h-E*65536,h=at+E+65535,E=Math.floor(h/65536),at=h-E*65536,h=Ue+E+65535,E=Math.floor(h/65536),Ue=h-E*65536,h=Ze+E+65535,E=Math.floor(h/65536),Ze=h-E*65536,h=Ne+E+65535,E=Math.floor(h/65536),Ne=h-E*65536,ee+=E-1+37*(E-1),$[0]=ee,$[1]=fe,$[2]=we,$[3]=$e,$[4]=De,$[5]=Pe,$[6]=It,$[7]=_t,$[8]=ot,$[9]=je,$[10]=Ye,$[11]=Xe,$[12]=at,$[13]=Ue,$[14]=Ze,$[15]=Ne}function W($,C){U($,C,C)}function ye($,C){const R=s();let h;for(h=0;h<16;h++)R[h]=C[h];for(h=253;h>=0;h--)W(R,R),h!==2&&h!==4&&U(R,R,C);for(h=0;h<16;h++)$[h]=R[h]}function re($,C){const R=s();let h;for(h=0;h<16;h++)R[h]=C[h];for(h=250;h>=0;h--)W(R,R),h!==1&&U(R,R,C);for(h=0;h<16;h++)$[h]=R[h]}function ue($,C){const R=s(),h=s(),E=s(),ee=s(),fe=s(),we=s(),$e=s(),De=s(),Pe=s();N(R,$[1],$[0]),N(Pe,C[1],C[0]),U(R,R,Pe),le(h,$[0],$[1]),le(Pe,C[0],C[1]),U(h,h,Pe),U(E,$[3],C[3]),U(E,E,y),U(ee,$[2],C[2]),le(ee,ee,ee),N(fe,h,R),N(we,ee,E),le($e,ee,E),le(De,h,R),U($[0],fe,we),U($[1],De,$e),U($[2],$e,we),U($[3],fe,De)}function Ce($,C,R){for(let h=0;h<4;h++)K($[h],C[h],R)}function ze($,C){const R=s(),h=s(),E=s();ye(E,C[2]),U(R,C[0],E),U(h,C[1],E),ie($,h),$[31]^=pe(R)<<7}function _($,C,R){M($[0],l),M($[1],p),M($[2],p),M($[3],l);for(let h=255;h>=0;--h){const E=R[h/8|0]>>(h&7)&1;Ce($,C,E),ue(C,$),ue($,$),Ce($,C,E)}}function x($,C){const R=[s(),s(),s(),s()];M(R[0],O),M(R[1],j),M(R[2],p),U(R[3],O,j),_($,R,C)}function Y($){if($.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const C=(0,t.hash)($);C[0]&=248,C[31]&=127,C[31]|=64;const R=new Uint8Array(32),h=[s(),s(),s(),s()];x(h,C),ze(R,h);const E=new Uint8Array(64);return E.set($),E.set(R,32),{publicKey:R,secretKey:E}}a.generateKeyPairFromSeed=Y;function ce($){const C=(0,r.randomBytes)(32,$),R=Y(C);return(0,n.wipe)(C),R}a.generateKeyPair=ce;function V($){if($.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array($.subarray(32))}a.extractPublicKeyFromSecretKey=V;const H=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k($,C){let R,h,E,ee;for(h=63;h>=32;--h){for(R=0,E=h-32,ee=h-12;E<ee;++E)C[E]+=R-16*C[h]*H[E-(h-32)],R=Math.floor((C[E]+128)/256),C[E]-=R*256;C[E]+=R,C[h]=0}for(R=0,E=0;E<32;E++)C[E]+=R-(C[31]>>4)*H[E],R=C[E]>>8,C[E]&=255;for(E=0;E<32;E++)C[E]-=R*H[E];for(h=0;h<32;h++)C[h+1]+=C[h]>>8,$[h]=C[h]&255}function G($){const C=new Float64Array(64);for(let R=0;R<64;R++)C[R]=$[R];for(let R=0;R<64;R++)$[R]=0;k($,C)}function Je($,C){const R=new Float64Array(64),h=[s(),s(),s(),s()],E=(0,t.hash)($.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const ee=new Uint8Array(64);ee.set(E.subarray(32),32);const fe=new t.SHA512;fe.update(ee.subarray(32)),fe.update(C);const we=fe.digest();fe.clean(),G(we),x(h,we),ze(ee,h),fe.reset(),fe.update(ee.subarray(0,32)),fe.update($.subarray(32)),fe.update(C);const $e=fe.digest();G($e);for(let De=0;De<32;De++)R[De]=we[De];for(let De=0;De<32;De++)for(let Pe=0;Pe<32;Pe++)R[De+Pe]+=$e[De]*E[Pe];return k(ee.subarray(32),R),ee}a.sign=Je;function Be($,C){const R=s(),h=s(),E=s(),ee=s(),fe=s(),we=s(),$e=s();return M($[2],p),he($[1],C),W(E,$[1]),U(ee,E,m),N(E,E,$[2]),le(ee,$[2],ee),W(fe,ee),W(we,fe),U($e,we,fe),U(R,$e,E),U(R,R,ee),re(R,R),U(R,R,E),U(R,R,ee),U(R,R,ee),U($[0],R,ee),W(h,$[0]),U(h,h,ee),ge(h,E)&&U($[0],$[0],A),W(h,$[0]),U(h,h,ee),ge(h,E)?-1:(pe($[0])===C[31]>>7&&N($[0],l,$[0]),U($[3],$[0],$[1]),0)}function jr($,C,R){const h=new Uint8Array(32),E=[s(),s(),s(),s()],ee=[s(),s(),s(),s()];if(R.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(Be(ee,$))return!1;const fe=new t.SHA512;fe.update(R.subarray(0,32)),fe.update($),fe.update(C);const we=fe.digest();return G(we),_(E,ee,we),x(ee,R.subarray(32)),ue(E,ee),ze(h,E),!Ee(R,h)}a.verify=jr;function xe($){let C=[s(),s(),s(),s()];if(Be(C,$))throw new Error("Ed25519: invalid public key");let R=s(),h=s(),E=C[1];le(R,p,E),N(h,p,E),ye(h,h),U(R,R,h);let ee=new Uint8Array(32);return ie(ee,R),ee}a.convertPublicKeyToX25519=xe;function xt($){const C=(0,t.hash)($.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const R=new Uint8Array(C.subarray(0,32));return(0,n.wipe)(C),R}a.convertSecretKeyToX25519=xt})(jc);const X1="EdDSA",Z1="JWT",mf=".",wf="base64url",ew="utf8",tw="utf8",rw=":",iw="did",nw="key",hl="base58btc",sw="z",ow="K36",aw=32;function vo(a){return wo(Nc(es(a),ew),wf)}function bf(a){const r=Nc(ow,hl),t=sw+wo(A_([r,a]),hl);return[iw,nw,t].join(rw)}function cw(a){return wo(a,wf)}function uw(a){return Nc([vo(a.header),vo(a.payload)].join(mf),tw)}function hw(a){return[vo(a.header),vo(a.payload),cw(a.signature)].join(mf)}function ll(a=tf.randomBytes(aw)){return jc.generateKeyPairFromSeed(a)}async function lw(a,r,t,n,s=ne.fromMiliseconds(Date.now())){const c={alg:X1,typ:Z1},l=bf(n.publicKey),p=s+t,m={iss:l,sub:a,aud:r,iat:s,exp:p},y=uw({header:c,payload:m}),O=jc.sign(n.secretKey,y);return hw({header:c,payload:m,signature:O})}const fw="PARSE_ERROR",pw="INVALID_REQUEST",dw="METHOD_NOT_FOUND",gw="INVALID_PARAMS",Ef="INTERNAL_ERROR",Lc="SERVER_ERROR",yw=[-32700,-32600,-32601,-32602,-32603],Jn={[fw]:{code:-32700,message:"Parse error"},[pw]:{code:-32600,message:"Invalid Request"},[dw]:{code:-32601,message:"Method not found"},[gw]:{code:-32602,message:"Invalid params"},[Ef]:{code:-32603,message:"Internal error"},[Lc]:{code:-32e3,message:"Server error"}},xf=Lc;function vw(a){return yw.includes(a)}function fl(a){return Object.keys(Jn).includes(a)?Jn[a]:Jn[xf]}function _w(a){const r=Object.values(Jn).find(t=>t.code===a);return r||Jn[xf]}function If(a,r,t){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${r}`):a}var Sf={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ic=function(a,r){return Ic=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},Ic(a,r)};function mw(a,r){Ic(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Sc=function(){return Sc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},Sc.apply(this,arguments)};function ww(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function bw(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function Ew(a,r){return function(t,n){r(t,n,a)}}function xw(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function Iw(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(j){l(j)}}function m(O){try{y(n.throw(O))}catch(j){l(j)}}function y(O){O.done?c(O.value):s(O.value).then(p,m)}y((n=n.apply(a,r||[])).next())})}function Sw(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return m([y,O])}}function m(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function Pw(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function Ow(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function Pc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(p){l={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function Rw(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(Pf(arguments[r]));return a}function Aw(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,s++)n[s]=c[l];return n}function ts(a){return this instanceof ts?(this.v=a,this):new ts(a)}function Tw(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(A){n[A]&&(s[A]=function(M){return new Promise(function(F,K){c.push([A,M,F,K])>1||p(A,M)})})}function p(A,M){try{m(n[A](M))}catch(F){j(c[0][3],F)}}function m(A){A.value instanceof ts?Promise.resolve(A.value.v).then(y,O):j(c[0][2],A)}function y(A){p("next",A)}function O(A){p("throw",A)}function j(A,M){A(M),c.shift(),c.length&&p(c[0][0],c[0][1])}}function Cw(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:ts(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function $w(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof Pc=="function"?Pc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,m){l=a[c](l),s(p,m,l.done,l.value)})}}function s(c,l,p,m){Promise.resolve(m).then(function(y){c({value:y,done:p})},l)}}function Nw(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Dw(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function Fw(a){return a&&a.__esModule?a:{default:a}}function jw(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Lw(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const qw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Sc},__asyncDelegator:Cw,__asyncGenerator:Tw,__asyncValues:$w,__await:ts,__awaiter:Iw,__classPrivateFieldGet:jw,__classPrivateFieldSet:Lw,__createBinding:Pw,__decorate:bw,__exportStar:Ow,__extends:mw,__generator:Sw,__importDefault:Fw,__importStar:Dw,__makeTemplateObject:Nw,__metadata:xw,__param:Ew,__read:Pf,__rest:ww,__spread:Rw,__spreadArrays:Aw,__values:Pc},Symbol.toStringTag,{value:"Module"})),Mw=rs(qw);var ri={},pl;function zw(){if(pl)return ri;pl=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.isBrowserCryptoAvailable=ri.getSubtleCrypto=ri.getBrowerCrypto=void 0;function a(){return(ur===null||ur===void 0?void 0:ur.crypto)||(ur===null||ur===void 0?void 0:ur.msCrypto)||{}}ri.getBrowerCrypto=a;function r(){const n=a();return n.subtle||n.webkitSubtle}ri.getSubtleCrypto=r;function t(){return!!a()&&!!r()}return ri.isBrowserCryptoAvailable=t,ri}var ii={},dl;function Uw(){if(dl)return ii;dl=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.isBrowser=ii.isNode=ii.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ii.isReactNative=a;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ii.isNode=r;function t(){return!a()&&!r()}return ii.isBrowser=t,ii}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Mw;r.__exportStar(zw(),a),r.__exportStar(Uw(),a)})(Sf);function qc(a=3){const r=Date.now()*Math.pow(10,a),t=Math.floor(Math.random()*Math.pow(10,a));return r+t}function Of(a=6){return BigInt(qc(a))}function dn(a,r,t){return{id:t||qc(),jsonrpc:"2.0",method:a,params:r}}function Mc(a,r){return{id:a,jsonrpc:"2.0",result:r}}function xo(a,r,t){return{id:a,jsonrpc:"2.0",error:Hw(r,t)}}function Hw(a,r){return typeof a>"u"?fl(Ef):(typeof a=="string"&&(a=Object.assign(Object.assign({},fl(Lc)),{message:a})),typeof r<"u"&&(a.data=r),vw(a.code)&&(a=_w(a.code)),a)}class Bw{}class kw extends Bw{constructor(){super()}}class Vw extends kw{constructor(r){super()}}const Kw="^https?:",Gw="^wss?:";function Ww(a){const r=a.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function Rf(a,r){const t=Ww(a);return typeof t>"u"?!1:new RegExp(r).test(t)}function gl(a){return Rf(a,Kw)}function yl(a){return Rf(a,Gw)}function Jw(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Af(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function zc(a){return Af(a)&&"method"in a}function Io(a){return Af(a)&&(oi(a)||Fr(a))}function oi(a){return"result"in a}function Fr(a){return"error"in a}class ai extends Vw{constructor(r){super(r),this.events=new Pr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async request(r,t){return this.requestStrict(dn(r.method,r.params||[],r.id||Of().toString()),t)}async requestStrict(r,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(c){s(c)}this.events.on(`${r.id}`,c=>{Fr(c)?s(c.error):n(c.result)});try{await this.connection.send(r,t)}catch(c){s(c)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),Io(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Qw=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Yw=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",vl=a=>a.split("?")[0],_l=10,Xw=Qw();class Zw{constructor(r){if(this.url=r,this.events=new Pr.EventEmitter,this.registering=!1,!yl(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(es(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!yl(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((t,n)=>{const s=Sf.isReactNative()?void 0:{rejectUnauthorized:!Jw(r)},c=new Xw(r,[],s);Yw()?c.onerror=l=>{const p=l;n(this.emitError(p.error))}:c.on("error",l=>{n(this.emitError(l))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(r){r.onmessage=t=>this.onPayload(t),r.onclose=t=>this.onClose(t),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?Fc(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),s=n.message||n.toString(),c=xo(r,s);this.events.emit("payload",c)}parseError(r,t=this.url){return If(r,vl(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>_l&&this.events.setMaxListeners(_l)}emitError(r){const t=this.parseError(new Error((r==null?void 0:r.message)||`WebSocket connection failed for host: ${vl(this.url)}`));return this.events.emit("register_error",t),t}}var _o={exports:{}};_o.exports;(function(a,r){var t=200,n="__lodash_hash_undefined__",s=1,c=2,l=9007199254740991,p="[object Arguments]",m="[object Array]",y="[object AsyncFunction]",O="[object Boolean]",j="[object Date]",A="[object Error]",M="[object Function]",F="[object GeneratorFunction]",K="[object Map]",ie="[object Number]",Ee="[object Null]",ge="[object Object]",pe="[object Promise]",he="[object Proxy]",le="[object RegExp]",N="[object Set]",U="[object String]",W="[object Symbol]",ye="[object Undefined]",re="[object WeakMap]",ue="[object ArrayBuffer]",Ce="[object DataView]",ze="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",Y="[object Int16Array]",ce="[object Int32Array]",V="[object Uint8Array]",H="[object Uint8ClampedArray]",k="[object Uint16Array]",G="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,jr=/^(?:0|[1-9]\d*)$/,xe={};xe[ze]=xe[_]=xe[x]=xe[Y]=xe[ce]=xe[V]=xe[H]=xe[k]=xe[G]=!0,xe[p]=xe[m]=xe[ue]=xe[O]=xe[Ce]=xe[j]=xe[A]=xe[M]=xe[K]=xe[ie]=xe[ge]=xe[le]=xe[N]=xe[U]=xe[re]=!1;var xt=typeof ur=="object"&&ur&&ur.Object===Object&&ur,$=typeof self=="object"&&self&&self.Object===Object&&self,C=xt||$||Function("return this")(),R=r&&!r.nodeType&&r,h=R&&!0&&a&&!a.nodeType&&a,E=h&&h.exports===R,ee=E&&xt.process,fe=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),we=fe&&fe.isTypedArray;function $e(v,I){for(var z=-1,Q=v==null?0:v.length,Ke=0,ve=[];++z<Q;){var et=v[z];I(et,z,v)&&(ve[Ke++]=et)}return ve}function De(v,I){for(var z=-1,Q=I.length,Ke=v.length;++z<Q;)v[Ke+z]=I[z];return v}function Pe(v,I){for(var z=-1,Q=v==null?0:v.length;++z<Q;)if(I(v[z],z,v))return!0;return!1}function It(v,I){for(var z=-1,Q=Array(v);++z<v;)Q[z]=I(z);return Q}function _t(v){return function(I){return v(I)}}function ot(v,I){return v.has(I)}function je(v,I){return v==null?void 0:v[I]}function Ye(v){var I=-1,z=Array(v.size);return v.forEach(function(Q,Ke){z[++I]=[Ke,Q]}),z}function Xe(v,I){return function(z){return v(I(z))}}function at(v){var I=-1,z=Array(v.size);return v.forEach(function(Q){z[++I]=Q}),z}var Ue=Array.prototype,Ze=Function.prototype,Ne=Object.prototype,ke=C["__core-js_shared__"],ht=Ze.toString,qe=Ne.hasOwnProperty,St=function(){var v=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Dt=Ne.toString,zt=RegExp("^"+ht.call(qe).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=E?C.Buffer:void 0,Lt=C.Symbol,Gt=C.Uint8Array,tr=Ne.propertyIsEnumerable,Lr=Ue.splice,Wt=Lt?Lt.toStringTag:void 0,kr=Object.getOwnPropertySymbols,ui=Ut?Ut.isBuffer:void 0,Si=Xe(Object.keys,Object),lt=hr(C,"DataView"),rt=hr(C,"Map"),ft=hr(C,"Promise"),pt=hr(C,"Set"),ct=hr(C,"WeakMap"),it=hr(Object,"create"),Pt=Kr(lt),Ot=Kr(rt),dt=Kr(ft),Rt=Kr(pt),gt=Kr(ct),mt=Lt?Lt.prototype:void 0,yt=mt?mt.valueOf:void 0;function Qe(v){var I=-1,z=v==null?0:v.length;for(this.clear();++I<z;){var Q=v[I];this.set(Q[0],Q[1])}}function At(){this.__data__=it?it(null):{},this.size=0}function Tt(v){var I=this.has(v)&&delete this.__data__[v];return this.size-=I?1:0,I}function Oo(v){var I=this.__data__;if(it){var z=I[v];return z===n?void 0:z}return qe.call(I,v)?I[v]:void 0}function Ro(v){var I=this.__data__;return it?I[v]!==void 0:qe.call(I,v)}function Ao(v,I){var z=this.__data__;return this.size+=this.has(v)?0:1,z[v]=it&&I===void 0?n:I,this}Qe.prototype.clear=At,Qe.prototype.delete=Tt,Qe.prototype.get=Oo,Qe.prototype.has=Ro,Qe.prototype.set=Ao;function yr(v){var I=-1,z=v==null?0:v.length;for(this.clear();++I<z;){var Q=v[I];this.set(Q[0],Q[1])}}function To(){this.__data__=[],this.size=0}function Co(v){var I=this.__data__,z=Pi(I,v);if(z<0)return!1;var Q=I.length-1;return z==Q?I.pop():Lr.call(I,z,1),--this.size,!0}function $o(v){var I=this.__data__,z=Pi(I,v);return z<0?void 0:I[z][1]}function No(v){return Pi(this.__data__,v)>-1}function Do(v,I){var z=this.__data__,Q=Pi(z,v);return Q<0?(++this.size,z.push([v,I])):z[Q][1]=I,this}yr.prototype.clear=To,yr.prototype.delete=Co,yr.prototype.get=$o,yr.prototype.has=No,yr.prototype.set=Do;function Vr(v){var I=-1,z=v==null?0:v.length;for(this.clear();++I<z;){var Q=v[I];this.set(Q[0],Q[1])}}function Bi(){this.size=0,this.__data__={hash:new Qe,map:new(rt||yr),string:new Qe}}function Fo(v){var I=hi(this,v).delete(v);return this.size-=I?1:0,I}function ki(v){return hi(this,v).get(v)}function jo(v){return hi(this,v).has(v)}function Lo(v,I){var z=hi(this,v),Q=z.size;return z.set(v,I),this.size+=z.size==Q?0:1,this}Vr.prototype.clear=Bi,Vr.prototype.delete=Fo,Vr.prototype.get=ki,Vr.prototype.has=jo,Vr.prototype.set=Lo;function Vi(v){var I=-1,z=v==null?0:v.length;for(this.__data__=new Vr;++I<z;)this.add(v[I])}function ss(v){return this.__data__.set(v,n),this}function os(v){return this.__data__.has(v)}Vi.prototype.add=Vi.prototype.push=ss,Vi.prototype.has=os;function Or(v){var I=this.__data__=new yr(v);this.size=I.size}function qo(){this.__data__=new yr,this.size=0}function Mo(v){var I=this.__data__,z=I.delete(v);return this.size=I.size,z}function zo(v){return this.__data__.get(v)}function Uo(v){return this.__data__.has(v)}function as(v,I){var z=this.__data__;if(z instanceof yr){var Q=z.__data__;if(!rt||Q.length<t-1)return Q.push([v,I]),this.size=++z.size,this;z=this.__data__=new Vr(Q)}return z.set(v,I),this.size=z.size,this}Or.prototype.clear=qo,Or.prototype.delete=Mo,Or.prototype.get=zo,Or.prototype.has=Uo,Or.prototype.set=as;function cs(v,I){var z=Wi(v),Q=!z&&ws(v),Ke=!z&&!Q&&mn(v),ve=!z&&!Q&&!Ke&&xs(v),et=z||Q||Ke||ve,Ct=et?It(v.length,String):[],Re=Ct.length;for(var Ge in v)(I||qe.call(v,Ge))&&!(et&&(Ge=="length"||Ke&&(Ge=="offset"||Ge=="parent")||ve&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||gs(Ge,Re)))&&Ct.push(Ge);return Ct}function Pi(v,I){for(var z=v.length;z--;)if(ms(v[z][0],I))return z;return-1}function vn(v,I,z){var Q=I(v);return Wi(v)?Q:De(Q,z(v))}function Oi(v){return v==null?v===void 0?ye:Ee:Wt&&Wt in Object(v)?ps(v):ko(v)}function _n(v){return Ai(v)&&Oi(v)==p}function Ri(v,I,z,Q,Ke){return v===I?!0:v==null||I==null||!Ai(v)&&!Ai(I)?v!==v&&I!==I:us(v,I,z,Q,Ri,Ke)}function us(v,I,z,Q,Ke,ve){var et=Wi(v),Ct=Wi(I),Re=et?m:qr(v),Ge=Ct?m:qr(I);Re=Re==p?ge:Re,Ge=Ge==p?ge:Ge;var wt=Re==ge,rr=Ge==ge,$t=Re==Ge;if($t&&mn(v)){if(!mn(I))return!1;et=!0,wt=!1}if($t&&!wt)return ve||(ve=new Or),et||xs(v)?Ki(v,I,z,Q,Ke,ve):Bo(v,I,Re,z,Q,Ke,ve);if(!(z&s)){var tt=wt&&qe.call(v,"__wrapped__"),Jt=rr&&qe.call(I,"__wrapped__");if(tt||Jt){var Rr=tt?v.value():v,vr=Jt?I.value():I;return ve||(ve=new Or),Ke(Rr,vr,z,Q,ve)}}return $t?(ve||(ve=new Or),fs(v,I,z,Q,Ke,ve)):!1}function Ho(v){if(!Es(v)||vs(v))return!1;var I=Ji(v)?zt:Be;return I.test(Kr(v))}function hs(v){return Ai(v)&&bs(v.length)&&!!xe[Oi(v)]}function ls(v){if(!_s(v))return Si(v);var I=[];for(var z in Object(v))qe.call(v,z)&&z!="constructor"&&I.push(z);return I}function Ki(v,I,z,Q,Ke,ve){var et=z&s,Ct=v.length,Re=I.length;if(Ct!=Re&&!(et&&Re>Ct))return!1;var Ge=ve.get(v);if(Ge&&ve.get(I))return Ge==I;var wt=-1,rr=!0,$t=z&c?new Vi:void 0;for(ve.set(v,I),ve.set(I,v);++wt<Ct;){var tt=v[wt],Jt=I[wt];if(Q)var Rr=et?Q(Jt,tt,wt,I,v,ve):Q(tt,Jt,wt,v,I,ve);if(Rr!==void 0){if(Rr)continue;rr=!1;break}if($t){if(!Pe(I,function(vr,Mr){if(!ot($t,Mr)&&(tt===vr||Ke(tt,vr,z,Q,ve)))return $t.push(Mr)})){rr=!1;break}}else if(!(tt===Jt||Ke(tt,Jt,z,Q,ve))){rr=!1;break}}return ve.delete(v),ve.delete(I),rr}function Bo(v,I,z,Q,Ke,ve,et){switch(z){case Ce:if(v.byteLength!=I.byteLength||v.byteOffset!=I.byteOffset)return!1;v=v.buffer,I=I.buffer;case ue:return!(v.byteLength!=I.byteLength||!ve(new Gt(v),new Gt(I)));case O:case j:case ie:return ms(+v,+I);case A:return v.name==I.name&&v.message==I.message;case le:case U:return v==I+"";case K:var Ct=Ye;case N:var Re=Q&s;if(Ct||(Ct=at),v.size!=I.size&&!Re)return!1;var Ge=et.get(v);if(Ge)return Ge==I;Q|=c,et.set(v,I);var wt=Ki(Ct(v),Ct(I),Q,Ke,ve,et);return et.delete(v),wt;case W:if(yt)return yt.call(v)==yt.call(I)}return!1}function fs(v,I,z,Q,Ke,ve){var et=z&s,Ct=Gi(v),Re=Ct.length,Ge=Gi(I),wt=Ge.length;if(Re!=wt&&!et)return!1;for(var rr=Re;rr--;){var $t=Ct[rr];if(!(et?$t in I:qe.call(I,$t)))return!1}var tt=ve.get(v);if(tt&&ve.get(I))return tt==I;var Jt=!0;ve.set(v,I),ve.set(I,v);for(var Rr=et;++rr<Re;){$t=Ct[rr];var vr=v[$t],Mr=I[$t];if(Q)var wn=et?Q(Mr,vr,$t,I,v,ve):Q(vr,Mr,$t,v,I,ve);if(!(wn===void 0?vr===Mr||Ke(vr,Mr,z,Q,ve):wn)){Jt=!1;break}Rr||(Rr=$t=="constructor")}if(Jt&&!Rr){var Ti=v.constructor,qt=I.constructor;Ti!=qt&&"constructor"in v&&"constructor"in I&&!(typeof Ti=="function"&&Ti instanceof Ti&&typeof qt=="function"&&qt instanceof qt)&&(Jt=!1)}return ve.delete(v),ve.delete(I),Jt}function Gi(v){return vn(v,Go,ds)}function hi(v,I){var z=v.__data__;return ys(I)?z[typeof I=="string"?"string":"hash"]:z.map}function hr(v,I){var z=je(v,I);return Ho(z)?z:void 0}function ps(v){var I=qe.call(v,Wt),z=v[Wt];try{v[Wt]=void 0;var Q=!0}catch{}var Ke=Dt.call(v);return Q&&(I?v[Wt]=z:delete v[Wt]),Ke}var ds=kr?function(v){return v==null?[]:(v=Object(v),$e(kr(v),function(I){return tr.call(v,I)}))}:Ve,qr=Oi;(lt&&qr(new lt(new ArrayBuffer(1)))!=Ce||rt&&qr(new rt)!=K||ft&&qr(ft.resolve())!=pe||pt&&qr(new pt)!=N||ct&&qr(new ct)!=re)&&(qr=function(v){var I=Oi(v),z=I==ge?v.constructor:void 0,Q=z?Kr(z):"";if(Q)switch(Q){case Pt:return Ce;case Ot:return K;case dt:return pe;case Rt:return N;case gt:return re}return I});function gs(v,I){return I=I??l,!!I&&(typeof v=="number"||jr.test(v))&&v>-1&&v%1==0&&v<I}function ys(v){var I=typeof v;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?v!=="__proto__":v===null}function vs(v){return!!St&&St in v}function _s(v){var I=v&&v.constructor,z=typeof I=="function"&&I.prototype||Ne;return v===z}function ko(v){return Dt.call(v)}function Kr(v){if(v!=null){try{return ht.call(v)}catch{}try{return v+""}catch{}}return""}function ms(v,I){return v===I||v!==v&&I!==I}var ws=_n(function(){return arguments}())?_n:function(v){return Ai(v)&&qe.call(v,"callee")&&!tr.call(v,"callee")},Wi=Array.isArray;function Vo(v){return v!=null&&bs(v.length)&&!Ji(v)}var mn=ui||He;function Ko(v,I){return Ri(v,I)}function Ji(v){if(!Es(v))return!1;var I=Oi(v);return I==M||I==F||I==y||I==he}function bs(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=l}function Es(v){var I=typeof v;return v!=null&&(I=="object"||I=="function")}function Ai(v){return v!=null&&typeof v=="object"}var xs=we?_t(we):hs;function Go(v){return Vo(v)?cs(v):ls(v)}function Ve(){return[]}function He(){return!1}a.exports=Ko})(_o,_o.exports);var eb=_o.exports;const tb=rf(eb);function rb(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<a.length;s++){var c=a.charAt(s),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=s}var p=a.length,m=a.charAt(0),y=Math.log(p)/Math.log(256),O=Math.log(256)/Math.log(p);function j(F){if(F instanceof Uint8Array||(ArrayBuffer.isView(F)?F=new Uint8Array(F.buffer,F.byteOffset,F.byteLength):Array.isArray(F)&&(F=Uint8Array.from(F))),!(F instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(F.length===0)return"";for(var K=0,ie=0,Ee=0,ge=F.length;Ee!==ge&&F[Ee]===0;)Ee++,K++;for(var pe=(ge-Ee)*O+1>>>0,he=new Uint8Array(pe);Ee!==ge;){for(var le=F[Ee],N=0,U=pe-1;(le!==0||N<ie)&&U!==-1;U--,N++)le+=256*he[U]>>>0,he[U]=le%p>>>0,le=le/p>>>0;if(le!==0)throw new Error("Non-zero carry");ie=N,Ee++}for(var W=pe-ie;W!==pe&&he[W]===0;)W++;for(var ye=m.repeat(K);W<pe;++W)ye+=a.charAt(he[W]);return ye}function A(F){if(typeof F!="string")throw new TypeError("Expected String");if(F.length===0)return new Uint8Array;var K=0;if(F[K]!==" "){for(var ie=0,Ee=0;F[K]===m;)ie++,K++;for(var ge=(F.length-K)*y+1>>>0,pe=new Uint8Array(ge);F[K];){var he=t[F.charCodeAt(K)];if(he===255)return;for(var le=0,N=ge-1;(he!==0||le<Ee)&&N!==-1;N--,le++)he+=p*pe[N]>>>0,pe[N]=he%256>>>0,he=he/256>>>0;if(he!==0)throw new Error("Non-zero carry");Ee=le,K++}if(F[K]!==" "){for(var U=ge-Ee;U!==ge&&pe[U]===0;)U++;for(var W=new Uint8Array(ie+(ge-U)),ye=ie;U!==ge;)W[ye++]=pe[U++];return W}}}function M(F){var K=A(F);if(K)return K;throw new Error(`Non-${r} character`)}return{encode:j,decodeUnsafe:A,decode:M}}var ib=rb,nb=ib;const Tf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},sb=a=>new TextEncoder().encode(a),ob=a=>new TextDecoder().decode(a);class ab{constructor(r,t,n){this.name=r,this.prefix=t,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class cb{constructor(r,t,n){if(this.name=r,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return Cf(this,r)}}class ub{constructor(r){this.decoders=r}or(r){return Cf(this,r)}decode(r){const t=r[0],n=this.decoders[t];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Cf=(a,r)=>new ub({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class hb{constructor(r,t,n,s){this.name=r,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new ab(r,t,n),this.decoder=new cb(r,t,s)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const So=({name:a,prefix:r,encode:t,decode:n})=>new hb(a,r,t,n),ns=({prefix:a,name:r,alphabet:t})=>{const{encode:n,decode:s}=nb(t,r);return So({prefix:a,name:r,encode:n,decode:c=>Tf(s(c))})},lb=(a,r,t,n)=>{const s={};for(let O=0;O<r.length;++O)s[r[O]]=O;let c=a.length;for(;a[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let p=0,m=0,y=0;for(let O=0;O<c;++O){const j=s[a[O]];if(j===void 0)throw new SyntaxError(`Non-${n} character`);m=m<<t|j,p+=t,p>=8&&(p-=8,l[y++]=255&m>>p)}if(p>=t||255&m<<8-p)throw new SyntaxError("Unexpected end of data");return l},fb=(a,r,t)=>{const n=r[r.length-1]==="=",s=(1<<t)-1;let c="",l=0,p=0;for(let m=0;m<a.length;++m)for(p=p<<8|a[m],l+=8;l>t;)l-=t,c+=r[s&p>>l];if(l&&(c+=r[s&p<<t-l]),n)for(;c.length*t&7;)c+="=";return c},Bt=({name:a,prefix:r,bitsPerChar:t,alphabet:n})=>So({prefix:r,name:a,encode(s){return fb(s,n,t)},decode(s){return lb(s,n,t,a)}}),pb=So({prefix:"\0",name:"identity",encode:a=>ob(a),decode:a=>sb(a)});var db=Object.freeze({__proto__:null,identity:pb});const gb=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var yb=Object.freeze({__proto__:null,base2:gb});const vb=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var _b=Object.freeze({__proto__:null,base8:vb});const mb=ns({prefix:"9",name:"base10",alphabet:"0123456789"});var wb=Object.freeze({__proto__:null,base10:mb});const bb=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Eb=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var xb=Object.freeze({__proto__:null,base16:bb,base16upper:Eb});const Ib=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Sb=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Pb=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ob=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Rb=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ab=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Tb=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Cb=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$b=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Nb=Object.freeze({__proto__:null,base32:Ib,base32upper:Sb,base32pad:Pb,base32padupper:Ob,base32hex:Rb,base32hexupper:Ab,base32hexpad:Tb,base32hexpadupper:Cb,base32z:$b});const Db=ns({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Fb=ns({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var jb=Object.freeze({__proto__:null,base36:Db,base36upper:Fb});const Lb=ns({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qb=ns({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Mb=Object.freeze({__proto__:null,base58btc:Lb,base58flickr:qb});const zb=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ub=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Hb=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bb=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var kb=Object.freeze({__proto__:null,base64:zb,base64pad:Ub,base64url:Hb,base64urlpad:Bb});const $f=Array.from(""),Vb=$f.reduce((a,r,t)=>(a[t]=r,a),[]),Kb=$f.reduce((a,r,t)=>(a[r.codePointAt(0)]=t,a),[]);function Gb(a){return a.reduce((r,t)=>(r+=Vb[t],r),"")}function Wb(a){const r=[];for(const t of a){const n=Kb[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);r.push(n)}return new Uint8Array(r)}const Jb=So({prefix:"",name:"base256emoji",encode:Gb,decode:Wb});var Qb=Object.freeze({__proto__:null,base256emoji:Jb}),Yb=Nf,ml=128,Xb=127,Zb=~Xb,eE=Math.pow(2,31);function Nf(a,r,t){r=r||[],t=t||0;for(var n=t;a>=eE;)r[t++]=a&255|ml,a/=128;for(;a&Zb;)r[t++]=a&255|ml,a>>>=7;return r[t]=a|0,Nf.bytes=t-n+1,r}var tE=Oc,rE=128,wl=127;function Oc(a,n){var t=0,n=n||0,s=0,c=n,l,p=a.length;do{if(c>=p)throw Oc.bytes=0,new RangeError("Could not decode varint");l=a[c++],t+=s<28?(l&wl)<<s:(l&wl)*Math.pow(2,s),s+=7}while(l>=rE);return Oc.bytes=c-n,t}var iE=Math.pow(2,7),nE=Math.pow(2,14),sE=Math.pow(2,21),oE=Math.pow(2,28),aE=Math.pow(2,35),cE=Math.pow(2,42),uE=Math.pow(2,49),hE=Math.pow(2,56),lE=Math.pow(2,63),fE=function(a){return a<iE?1:a<nE?2:a<sE?3:a<oE?4:a<aE?5:a<cE?6:a<uE?7:a<hE?8:a<lE?9:10},pE={encode:Yb,decode:tE,encodingLength:fE},Df=pE;const bl=(a,r,t=0)=>(Df.encode(a,r,t),r),El=a=>Df.encodingLength(a),Rc=(a,r)=>{const t=r.byteLength,n=El(a),s=n+El(t),c=new Uint8Array(s+t);return bl(a,c,0),bl(t,c,n),c.set(r,s),new dE(a,t,r,c)};class dE{constructor(r,t,n,s){this.code=r,this.size=t,this.digest=n,this.bytes=s}}const Ff=({name:a,code:r,encode:t})=>new gE(a,r,t);class gE{constructor(r,t,n){this.name=r,this.code=t,this.encode=n}digest(r){if(r instanceof Uint8Array){const t=this.encode(r);return t instanceof Uint8Array?Rc(this.code,t):t.then(n=>Rc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const jf=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),yE=Ff({name:"sha2-256",code:18,encode:jf("SHA-256")}),vE=Ff({name:"sha2-512",code:19,encode:jf("SHA-512")});var _E=Object.freeze({__proto__:null,sha256:yE,sha512:vE});const Lf=0,mE="identity",qf=Tf,wE=a=>Rc(Lf,qf(a)),bE={code:Lf,name:mE,encode:qf,digest:wE};var EE=Object.freeze({__proto__:null,identity:bE});new TextEncoder,new TextDecoder;const xl={...db,...yb,..._b,...wb,...xb,...Nb,...jb,...Mb,...kb,...Qb};({..._E,...EE});function Mf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function xE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Mf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function zf(a,r,t,n){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:t},decoder:{decode:n}}}const Il=zf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),nc=zf("ascii","a",a=>{let r="a";for(let t=0;t<a.length;t++)r+=String.fromCharCode(a[t]);return r},a=>{a=a.substring(1);const r=xE(a.length);for(let t=0;t<a.length;t++)r[t]=a.charCodeAt(t);return r}),IE={utf8:Il,"utf-8":Il,hex:xl.base16,latin1:nc,ascii:nc,binary:nc,...xl};function SE(a,r="utf8"){const t=IE[r];if(!t)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Mf(globalThis.Buffer.from(a,"utf-8")):t.decoder.decode(`${t.prefix}${a}`)}const Uf="wc",PE=2,Uc="core",Ei=`${Uf}@2:${Uc}:`,OE={name:Uc,logger:"error"},RE={database:":memory:"},AE="crypto",Sl="client_ed25519_seed",TE=ne.ONE_DAY,CE="keychain",$E="0.3",NE="messages",DE="0.3",FE=ne.SIX_HOURS,jE="publisher",Hf="irn",LE="error",Bf="wss://relay.walletconnect.com",Pl="wss://relay.walletconnect.org",qE="relayer",Kt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},ME="_subscription",ni={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},zE=ne.ONE_SECOND,UE="2.10.2",HE=1e4,BE="0.3",kE="WALLETCONNECT_CLIENT_ID",Nr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},VE="subscription",KE="0.3",GE=ne.FIVE_SECONDS*1e3,WE="pairing",JE="0.3",Un={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},Gn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Br={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},QE="history",YE="0.3",XE="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},ZE="0.3",sc="verify-api",yo="https://verify.walletconnect.com",Ol="https://verify.walletconnect.org";class ex{constructor(r,t){this.core=r,this.logger=t,this.keychain=new Map,this.name=CE,this.version=$E,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()},this.get=n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:c}=Z("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return s},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,af(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?cf(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class tx{constructor(r,t,n){this.core=r,this.logger=t,this.name=AE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),c=ll(s);return bf(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=$_();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const c=await this.getClientSeed(),l=ll(c),p=pc();return await lw(p,s,TE,l)},this.generateSharedKey=(s,c,l)=>{this.isInitialized();const p=this.getPrivateKey(s),m=N_(p,c);return this.setSymKey(m,l)},this.setSymKey=async(s,c)=>{this.isInitialized();const l=c||D_(s);return await this.keychain.set(l,s),l},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,c,l)=>{this.isInitialized();const p=F_(l),m=es(c);if(Vh(p)){const A=p.senderPublicKey,M=p.receiverPublicKey;s=await this.generateSharedKey(A,M)}const y=this.getSymKey(s),{type:O,senderPublicKey:j}=p;return j_({type:O,symKey:y,message:m,senderPublicKey:j})},this.decode=async(s,c,l)=>{this.isInitialized();const p=L_(c,l);if(Vh(p)){const m=p.receiverPublicKey,y=p.senderPublicKey;s=await this.generateSharedKey(m,y)}try{const m=this.getSymKey(s),y=q_({symKey:m,encoded:c});return Fc(y)}catch(m){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(m)}},this.getPayloadType=s=>{const c=Kh(s);return M_(c.type)},this.getPayloadSenderPublicKey=s=>{const c=Kh(s);return c.senderPublicKey?wo(c.senderPublicKey,z_):void 0},this.core=r,this.logger=Te.generateChildLogger(t,this.name),this.keychain=n||new ex(this.core,this.logger)}get context(){return Te.getLoggerContext(this.logger)}async setPrivateKey(r,t){return await this.keychain.set(r,t),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(Sl)}catch{r=pc(),await this.keychain.set(Sl,r)}return SE(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class rx extends U1{constructor(r,t){super(r,t),this.logger=r,this.core=t,this.messages=new Map,this.name=NE,this.version=DE,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,s)=>{this.isInitialized();const c=pn(s);let l=this.messages.get(n);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=s,this.messages.set(n,l),await this.persist()),c},this.get=n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s},this.has=(n,s)=>{this.isInitialized();const c=this.get(n),l=pn(s);return typeof c[l]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Te.generateChildLogger(r,this.name),this.core=t}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,af(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?cf(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class ix extends H1{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.events=new Pr.EventEmitter,this.name=jE,this.queue=new Map,this.publishTimeout=ne.toMiliseconds(ne.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,s,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}});try{const p=(c==null?void 0:c.ttl)||FE,m=dc(c),y=(c==null?void 0:c.prompt)||!1,O=(c==null?void 0:c.tag)||0,j=(c==null?void 0:c.id)||Of().toString(),A={topic:n,message:s,opts:{ttl:p,relay:m,prompt:y,tag:O,id:j}},M=setTimeout(()=>this.queue.set(j,A),this.publishTimeout);try{await await Qn(this.rpcPublish(n,s,p,m,y,O,j),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(j),this.relayer.events.emit(Kt.publish,A)}catch(F){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(j),F;return}finally{clearTimeout(M)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.relayer=r,this.logger=Te.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Te.getLoggerContext(this.logger)}rpcPublish(r,t,n,s,c,l,p){var m,y,O,j;const A={method:po(s.protocol).publish,params:{topic:r,message:t,ttl:n,prompt:c,tag:l},id:p};return bi((m=A.params)==null?void 0:m.prompt)&&((y=A.params)==null||delete y.prompt),bi((O=A.params)==null?void 0:O.tag)&&((j=A.params)==null||delete j.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:A}),this.relayer.request(A)}removeRequestFromQueue(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:t,message:n,opts:s}=r;await this.publish(t,n,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(yn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Kt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Kt.message_ack,r=>{this.removeRequestFromQueue(r.id.toString())})}}class nx{constructor(){this.map=new Map,this.set=(r,t)=>{const n=this.get(r);this.exists(r,t)||this.map.set(r,[...n,t])},this.get=r=>this.map.get(r)||[],this.exists=(r,t)=>this.get(r).includes(t),this.delete=(r,t)=>{if(typeof t>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,t))return;const s=n.filter(c=>c!==t);if(!s.length){this.map.delete(r);return}this.map.set(r,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var sx=Object.defineProperty,ox=Object.defineProperties,ax=Object.getOwnPropertyDescriptors,Rl=Object.getOwnPropertySymbols,cx=Object.prototype.hasOwnProperty,ux=Object.prototype.propertyIsEnumerable,Al=(a,r,t)=>r in a?sx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Hn=(a,r)=>{for(var t in r||(r={}))cx.call(r,t)&&Al(a,t,r[t]);if(Rl)for(var t of Rl(r))ux.call(r,t)&&Al(a,t,r[t]);return a},oc=(a,r)=>ox(a,ax(r));class hx extends V1{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.subscriptions=new Map,this.topicMap=new nx,this.events=new Pr.EventEmitter,this.name=VE,this.version=KE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ei,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const c=dc(s),l={topic:n,relay:c};this.pending.set(n,l);const p=await this.rpcSubscribe(n,c);return this.onSubscribe(p,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}}),p}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((s,c)=>{const l=new ne.Watch;l.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),s(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=GE&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=Te.generateChildLogger(t,this.name),this.clientId=""}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,t){let n=!1;try{n=this.getSubscription(r).topic===t}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,t){const n=this.topicMap.get(r);await Promise.all(n.map(async s=>await this.unsubscribeById(r,s,t)))}async unsubscribeById(r,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}});try{const s=dc(n);await this.rpcUnsubscribe(r,t,s);const c=er("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(r,t){const n={method:po(t.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Qn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}return pn(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const t=r[0].relay,n={method:po(t.protocol).batchSubscribe,params:{topics:r.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Qn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}}rpcUnsubscribe(r,t,n){const s={method:po(n.protocol).unsubscribe,params:{topic:r,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(r,t){this.setSubscription(r,oc(Hn({},t),{id:r})),this.pending.delete(t.topic)}onBatchSubscribe(r){r.length&&r.forEach(t=>{this.setSubscription(t.id,Hn({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(r,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,r)&&this.deleteSubscription(t,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,t){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:t}),this.addSubscription(r,t))}addSubscription(r,t){this.subscriptions.set(r,Hn({},t)),this.topicMap.set(t.topic,r),this.events.emit(Nr.created,t)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const t=this.subscriptions.get(r);if(!t){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}deleteSubscription(r,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:t});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(Nr.deleted,oc(Hn({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Nr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<r;t++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Nr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:t}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const t=await this.rpcBatchSubscribe(r);gn(t)&&this.onBatchSubscribe(t.map((n,s)=>oc(Hn({},r[s]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(t=>{r.push(t)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(yn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Kt.connect,async()=>{await this.onConnect()}),this.relayer.on(Kt.disconnect,()=>{this.onDisconnect()}),this.events.on(Nr.created,async r=>{const t=Nr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()}),this.events.on(Nr.deleted,async r=>{const t=Nr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),r())},this.pollingInterval)})}}var lx=Object.defineProperty,Tl=Object.getOwnPropertySymbols,fx=Object.prototype.hasOwnProperty,px=Object.prototype.propertyIsEnumerable,Cl=(a,r,t)=>r in a?lx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,dx=(a,r)=>{for(var t in r||(r={}))fx.call(r,t)&&Cl(a,t,r[t]);if(Tl)for(var t of Tl(r))px.call(r,t)&&Cl(a,t,r[t]);return a};class gx extends B1{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Pr.EventEmitter,this.name=qE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(Kt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Kt.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ni.payload,this.onPayloadHandler),this.provider.on(ni.connect,this.onConnectHandler),this.provider.on(ni.disconnect,this.onDisconnectHandler),this.provider.on(ni.error,this.onProviderErrorHandler)},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?Te.generateChildLogger(r.logger,this.name):Te.pino(Te.getDefaultLoggerOptions({level:r.logger||LE})),this.messages=new rx(this.logger,r.core),this.subscriber=new hx(this,this.logger),this.publisher=new ix(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||Bf,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Pl}...`),await this.restartTransport(Pl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},HE)}get context(){return Te.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,t,n){this.isInitialized(),await this.publisher.publish(r,t,n),await this.recordMessageEvent({topic:r,message:t,publishedAt:Date.now()})}async subscribe(r,t){var n;this.isInitialized();let s=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";if(s)return s;let c;const l=p=>{p.topic===r&&(this.subscriber.off(Nr.created,l),c())};return await Promise.all([new Promise(p=>{c=p,this.subscriber.on(Nr.created,l)}),new Promise(async p=>{s=await this.subscriber.subscribe(r,t),p()})]),s}async unsubscribe(r,t){this.isInitialized(),await this.subscriber.unsubscribe(r,t)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Qn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(r){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){r&&r!==this.relayUrl&&(this.relayUrl=r,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Nr.resubscribed,()=>{t()})}),new Promise(async(t,n)=>{try{await Qn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(s){n(s);return}t()})])}catch(t){this.logger.error(t);const n=t;if(!this.isConnectionStalled(n.message))throw t;this.provider.events.emit(ni.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(r){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=r||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Gh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(r){return this.staleConnectionErrors.some(t=>r.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ai(new Zw(U_({sdkVersion:UE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:t,message:n}=r;await this.messages.set(t,n)}async shouldIgnoreMessageEvent(r){const{topic:t,message:n}=r;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.debug(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),zc(r)){if(!r.method.endsWith(ME))return;const t=r.params,{topic:n,message:s,publishedAt:c}=t.data,l={topic:n,message:s,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(dx({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(r),await this.onMessageEvent(l)}else Io(r)&&this.events.emit(Kt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(Kt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const t=Mc(r.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(ni.payload,this.onPayloadHandler),this.provider.off(ni.connect,this.onConnectHandler),this.provider.off(ni.disconnect,this.onDisconnectHandler),this.provider.off(ni.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Kt.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let r=await Gh();H_(async t=>{this.initialized&&r!==t&&(r=t,t?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Kt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(r=>this.logger.error(r))},ne.toMiliseconds(zE)))}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(r=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var yx=Object.defineProperty,$l=Object.getOwnPropertySymbols,vx=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,Nl=(a,r,t)=>r in a?yx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Dl=(a,r)=>{for(var t in r||(r={}))vx.call(r,t)&&Nl(a,t,r[t]);if($l)for(var t of $l(r))_x.call(r,t)&&Nl(a,t,r[t]);return a};class Po extends k1{constructor(r,t,n,s=Ei,c=void 0){super(r,t,n,s),this.core=r,this.logger=t,this.name=n,this.map=new Map,this.version=BE,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!bi(l)?this.map.set(this.getKey(l),l):T_(l)?this.map.set(l.id,l):C_(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,p)=>{this.isInitialized(),this.map.has(l)?await this.update(l,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:p}),this.map.set(l,p),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(p=>Object.keys(l).every(m=>tb(p[m],l[m]))):this.values),this.update=async(l,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:p});const m=Dl(Dl({},this.getData(l)),p);this.map.set(l,m),await this.persist()},this.delete=async(l,p)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:p}),this.map.delete(l),await this.persist())},this.logger=Te.generateChildLogger(t,this.name),this.storagePrefix=s,this.getKey=c}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const t=this.map.get(r);if(!t){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:t}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class mx{constructor(r,t){this.core=r,this.logger=t,this.name=WE,this.version=JE,this.events=new Dc,this.initialized=!1,this.storagePrefix=Ei,this.ignoredPayloadTypes=[nf],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=pc(),s=await this.core.crypto.setSymKey(n),c=Dr(ne.FIVE_MINUTES),l={protocol:Hf},p={topic:s,expiry:c,relay:l,active:!1},m=B_({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:l});return await this.pairings.set(s,p),await this.core.relayer.subscribe(s),this.core.expirer.set(s,c),{topic:s,uri:m}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:s,symKey:c,relay:l}=k_(n.uri);let p;if(this.pairings.keys.includes(s)&&(p=this.pairings.get(s),p.active))throw new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(s)||(await this.core.crypto.setSymKey(c,s),await this.core.relayer.subscribe(s,{relay:l}));const m=Dr(ne.FIVE_MINUTES),y={topic:s,relay:l,expiry:m,active:!1};return await this.pairings.set(s,y),this.core.expirer.set(s,m),n.activatePairing&&await this.activate({topic:s}),this.events.emit(Gn.create,y),y},this.activate=async({topic:n})=>{this.isInitialized();const s=Dr(ne.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:s}),this.core.expirer.set(n,s)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:s}=n;if(this.pairings.keys.includes(s)){const c=await this.sendRequest(s,"wc_pairingPing",{}),{done:l,resolve:p,reject:m}=hn();this.events.once(Nt("pairing_ping",c),({error:y})=>{y?m(y):p()}),await l()}},this.updateExpiry=async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})},this.updateMetadata=async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",er("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(n,s,c)=>{const l=dn(s,c),p=await this.core.crypto.encode(n,l),m=Un[s].req;return this.core.history.set(n,l),this.core.relayer.publish(n,p,m),l.id},this.sendResult=async(n,s,c)=>{const l=Mc(n,c),p=await this.core.crypto.encode(s,l),m=await this.core.history.get(s,n),y=Un[m.request.method].res;await this.core.relayer.publish(s,p,y),await this.core.history.resolve(l)},this.sendError=async(n,s,c)=>{const l=xo(n,c),p=await this.core.crypto.encode(s,l),m=await this.core.history.get(s,n),y=Un[m.request.method]?Un[m.request.method].res:Un.unregistered_method.res;await this.core.relayer.publish(s,p,y),await this.core.history.resolve(l)},this.deletePairing=async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,er("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(s=>wi(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=n=>{const{topic:s,payload:c}=n;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(s,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,c);default:return this.onUnknownRpcMethodRequest(s,c)}},this.onRelayEventResponse=async n=>{const{topic:s,payload:c}=n,l=(await this.core.history.get(s,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(s,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(n,s)=>{const{id:c}=s;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit(Gn.ping,{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onPairingPingResponse=(n,s)=>{const{id:c}=s;setTimeout(()=>{oi(s)?this.events.emit(Nt("pairing_ping",c),{}):Fr(s)&&this.events.emit(Nt("pairing_ping",c),{error:s.error})},500)},this.onPairingDeleteRequest=async(n,s)=>{const{id:c}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Gn.delete,{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(n,s)=>{const{id:c,method:l}=s;try{if(this.registeredMethods.includes(l))return;const p=er("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,n,p),this.logger.error(p)}catch(p){await this.sendError(c,n,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(er("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!cr(n)){const{message:s}=Z("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(s)}if(!V_(n.uri)){const{message:s}=Z("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(s)}},this.isValidPing=async n=>{if(!cr(n)){const{message:c}=Z("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidDisconnect=async n=>{if(!cr(n)){const{message:c}=Z("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async n=>{if(!ln(n,!1)){const{message:s}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(wi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=Z("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}},this.core=r,this.logger=Te.generateChildLogger(t,this.name),this.pairings=new Po(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Te.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(Kt.message,async r=>{const{topic:t,message:n}=r;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const s=await this.core.crypto.decode(t,n);try{zc(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):Io(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async r=>{const{topic:t}=sf(r.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Gn.expire,{topic:t}))})}}class wx extends z1{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.records=new Map,this.events=new Pr.EventEmitter,this.name=QE,this.version=YE,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,s,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:c}),this.records.has(s.id))return;const l={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:c,expiry:Dr(ne.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(Br.created,l)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=Fr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.events.emit(Br.updated,s))},this.get=async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s)),this.delete=(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(c=>{if(c.topic===n){if(typeof s<"u"&&c.id!==s)return;this.records.delete(c.id),this.events.emit(Br.deleted,c)}})},this.exists=async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:dn(t.request.method,t.request.params,t.id),chainId:t.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const t=this.records.get(r);if(!t){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Br.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:t}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Br.created,r=>{const t=Br.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(Br.updated,r=>{const t=Br.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(Br.deleted,r=>{const t=Br.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.core.heartbeat.on(yn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{ne.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class bx extends K1{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.expirations=new Map,this.events=new Pr.EventEmitter,this.name=XE,this.version=ZE,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(n,s)=>{this.isInitialized();const c=this.formatTarget(n),l={target:c,expiry:s};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Sr.created,{target:c,expiration:l})},this.get=n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)},this.del=n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),c=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Sr.deleted,{target:s,expiration:c})}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return K_(r);if(typeof r=="number")return G_(r);const{message:t}=Z("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(t)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:t}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const t=this.expirations.get(r);if(!t){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}checkExpiry(r,t){const{expiry:n}=t;ne.toMiliseconds(n)-Date.now()<=0&&this.expire(r,t)}expire(r,t){this.expirations.delete(r),this.events.emit(Sr.expired,{target:r,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,t)=>this.checkExpiry(t,r))}registerEventListeners(){this.core.heartbeat.on(yn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,r=>{const t=Sr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Sr.expired,r=>{const t=Sr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Sr.deleted,r=>{const t=Sr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Ex extends G1{constructor(r,t){super(r,t),this.projectId=r,this.logger=t,this.name=sc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async()=>{if(this.verifyDisabled||W_()||!of())return;const n=yo;this.verifyUrl!==n&&this.removeIframe(),this.verifyUrl=n;try{await this.createIframe()}catch(s){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(s)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Ol;try{await this.createIframe()}catch(s){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(s),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const s=(n==null?void 0:n.verifyUrl)||yo;let c;try{c=await this.fetchAttestation(n.attestationId,s)}catch(l){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${s}`),this.logger.info(l),c=await this.fetchAttestation(n.attestationId,Ol)}return c},this.fetchAttestation=async(n,s)=>{this.logger.info(`resolving attestation: ${n} from url: ${s}`);const c=this.startAbortTimer(ne.ONE_SECOND*2),l=await fetch(`${s}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var s;try{if(!this.iframe)return;(s=this.iframe.contentWindow)==null||s.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const s=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",s),n())};await Promise.race([new Promise(c=>{if(document.getElementById(sc))return c();window.addEventListener("message",s);const l=document.createElement("iframe");l.id=sc,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,n=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",s),l("verify iframe load timeout")},ne.toMiliseconds(ne.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Te.generateChildLogger(t,this.name),this.verifyUrl=yo,this.abortController=new AbortController,this.isDevEnv=J_()&&{}.IS_VITEST}get context(){return Te.getLoggerContext(this.logger)}startAbortTimer(r){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(r))}}var xx=Object.defineProperty,Fl=Object.getOwnPropertySymbols,Ix=Object.prototype.hasOwnProperty,Sx=Object.prototype.propertyIsEnumerable,jl=(a,r,t)=>r in a?xx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Ll=(a,r)=>{for(var t in r||(r={}))Ix.call(r,t)&&jl(a,t,r[t]);if(Fl)for(var t of Fl(r))Sx.call(r,t)&&jl(a,t,r[t]);return a};class Hc extends M1{constructor(r){super(r),this.protocol=Uf,this.version=PE,this.name=Uc,this.events=new Pr.EventEmitter,this.initialized=!1,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||Bf,this.customStoragePrefix=r!=null&&r.customStoragePrefix?`:${r.customStoragePrefix}`:"";const t=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||OE.logger}));this.logger=Te.generateChildLogger(t,this.name),this.heartbeat=new yn.HeartBeat,this.crypto=new tx(this,this.logger,r==null?void 0:r.keychain),this.history=new wx(this,this.logger),this.expirer=new bx(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new Bm(Ll(Ll({},RE),r==null?void 0:r.storageOptions)),this.relayer=new gx({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new mx(this,this.logger),this.verify=new Ex(this.projectId||"",this.logger)}static async init(r){const t=new Hc(r);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(kE,n),t}get context(){return Te.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const Px=Hc,kf="wc",Vf=2,Kf="client",Bc=`${kf}@${Vf}:${Kf}:`,ac={name:Kf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},ql="WALLETCONNECT_DEEPLINK_CHOICE",Ox="proposal",Gf="Proposal expired",Rx="session",ho=ne.SEVEN_DAYS,Ax="engine",Bn={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1115}}},cc={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},si={idle:"IDLE",active:"ACTIVE"},Tx="request",Cx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var $x=Object.defineProperty,Nx=Object.defineProperties,Dx=Object.getOwnPropertyDescriptors,Ml=Object.getOwnPropertySymbols,Fx=Object.prototype.hasOwnProperty,jx=Object.prototype.propertyIsEnumerable,zl=(a,r,t)=>r in a?$x(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,ar=(a,r)=>{for(var t in r||(r={}))Fx.call(r,t)&&zl(a,t,r[t]);if(Ml)for(var t of Ml(r))jx.call(r,t)&&zl(a,t,r[t]);return a},kn=(a,r)=>Nx(a,Dx(r));class Lx extends J1{constructor(r){super(r),this.name=Ax,this.events=new Dc,this.initialized=!1,this.ignoredPayloadTypes=[nf],this.requestQueue={state:si.idle,queue:[]},this.sessionRequestQueue={state:si.idle,queue:[]},this.requestQueueDelay=ne.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Bn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const n=kn(ar({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:p,relays:m}=n;let y=s,O,j=!1;if(y&&(j=this.client.core.pairing.pairings.get(y).active),!y||!j){const{topic:pe,uri:he}=await this.client.core.pairing.create();y=pe,O=he}const A=await this.client.core.crypto.generateKeyPair(),M=ar({requiredNamespaces:c,optionalNamespaces:l,relays:m??[{protocol:Hf}],proposer:{publicKey:A,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:F,resolve:K,done:ie}=hn(ne.FIVE_MINUTES,Gf);if(this.events.once(Nt("session_connect"),async({error:pe,session:he})=>{if(pe)F(pe);else if(he){he.self.publicKey=A;const le=kn(ar({},he),{requiredNamespaces:he.requiredNamespaces,optionalNamespaces:he.optionalNamespaces});await this.client.session.set(he.topic,le),await this.setExpiry(he.topic,he.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:he.peer.metadata}),K(le)}}),!y){const{message:pe}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(pe)}const Ee=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:M}),ge=Dr(ne.FIVE_MINUTES);return await this.setProposal(Ee,ar({id:Ee,expiry:ge},M)),{uri:O,approval:ie}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:n,relayProtocol:s,namespaces:c,sessionProperties:l}=t,p=this.client.proposal.get(n);let{pairingTopic:m,proposer:y,requiredNamespaces:O,optionalNamespaces:j}=p;m=m||"",go(O)||(O=Y_(c,"approve()"));const A=await this.client.core.crypto.generateKeyPair(),M=y.publicKey,F=await this.client.core.crypto.generateSharedKey(A,M);m&&n&&(await this.client.core.pairing.updateMetadata({topic:m,metadata:y.metadata}),await this.sendResult({id:n,topic:m,result:{relay:{protocol:s??"irn"},responderPublicKey:A}}),await this.client.proposal.delete(n,er("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:m}));const K=ar({relay:{protocol:s??"irn"},namespaces:c,requiredNamespaces:O,optionalNamespaces:j,pairingTopic:m,controller:{publicKey:A,metadata:this.client.metadata},expiry:Dr(ho)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(F),await this.sendRequest({topic:F,method:"wc_sessionSettle",params:K,throwOnFailedPublish:!0});const ie=kn(ar({},K),{topic:F,pairingTopic:m,acknowledged:!1,self:K.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:A});return await this.client.session.set(F,ie),await this.setExpiry(F,Dr(ho)),{topic:F,acknowledged:()=>new Promise(Ee=>setTimeout(()=>Ee(this.client.session.get(F)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:n,reason:s}=t,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,s),await this.client.proposal.delete(n,er("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:n,namespaces:s}=t,c=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s}}),{done:l,resolve:p,reject:m}=hn();return this.events.once(Nt("session_update",c),({error:y})=>{y?m(y):p()}),await this.client.session.update(n,{namespaces:s}),{acknowledged:l}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:n}=t,s=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:p}=hn();return this.events.once(Nt("session_extend",s),({error:m})=>{m?p(m):l()}),await this.setExpiry(n,Dr(ho)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:n,request:s,topic:c,expiry:l}=t,p=qc(),{done:m,resolve:y,reject:O}=hn(l,"Request expired. Please try again.");return this.events.once(Nt("session_request",p),({error:j,result:A})=>{j?O(j):y(A)}),await Promise.all([new Promise(async j=>{await this.sendRequest({clientRpcId:p,topic:c,method:"wc_sessionRequest",params:{request:s,chainId:n},expiry:l,throwOnFailedPublish:!0}).catch(A=>O(A)),this.client.events.emit("session_request_sent",{topic:c,request:s,chainId:n,id:p}),j()}),new Promise(async j=>{const A=await this.client.core.storage.getItem(ql);X_({id:p,topic:c,wcDeepLink:A}),j()}),m()]).then(j=>j[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:c}=s;oi(s)?await this.sendResult({id:c,topic:n,result:s.result,throwOnFailedPublish:!0}):Fr(s)&&await this.sendError(c,n,s.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:p}=hn();this.events.once(Nt("session_ping",s),({error:m})=>{m?p(m):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:n,event:s,chainId:c}=t;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:n}=t;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:er("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(n=>Z_(n,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(c=>{var l,p;return((l=c.peerMetadata)==null?void 0:l.url)&&((p=c.peerMetadata)==null?void 0:p.url)===t.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(t,n)=>{const{self:s}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,er("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),n||this.client.core.expirer.del(t),this.client.core.storage.removeItem(ql).catch(c=>this.client.logger.warn(c))},this.deleteProposal=async(t,n)=>{await Promise.all([this.client.proposal.delete(t,er("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),s&&(this.sessionRequestQueue.state=si.idle)},this.setExpiry=async(t,n)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:n}),this.client.core.expirer.set(t,n)},this.setProposal=async(t,n)=>{await this.client.proposal.set(t,n),this.client.core.expirer.set(t,n.expiry)},this.setPendingSessionRequest=async t=>{const n=Bn.wc_sessionRequest.req.ttl,{id:s,topic:c,params:l,verifyContext:p}=t;await this.client.pendingRequest.set(s,{id:s,topic:c,params:l,verifyContext:p}),n&&this.client.core.expirer.set(s,Dr(n))},this.sendRequest=async t=>{const{topic:n,method:s,params:c,expiry:l,relayRpcId:p,clientRpcId:m,throwOnFailedPublish:y}=t,O=dn(s,c,m);if(of()&&Cx.includes(s)){const M=pn(JSON.stringify(O));this.client.core.verify.register({attestationId:M})}const j=await this.client.core.crypto.encode(n,O),A=Bn[s].req;return l&&(A.ttl=l),p&&(A.id=p),this.client.core.history.set(n,O),y?(A.internal=kn(ar({},A.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,j,A)):this.client.core.relayer.publish(n,j,A).catch(M=>this.client.logger.error(M)),O.id},this.sendResult=async t=>{const{id:n,topic:s,result:c,throwOnFailedPublish:l}=t,p=Mc(n,c),m=await this.client.core.crypto.encode(s,p),y=await this.client.core.history.get(s,n),O=Bn[y.request.method].res;l?(O.internal=kn(ar({},O.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,m,O)):this.client.core.relayer.publish(s,m,O).catch(j=>this.client.logger.error(j)),await this.client.core.history.resolve(p)},this.sendError=async(t,n,s)=>{const c=xo(t,s),l=await this.client.core.crypto.encode(n,c),p=await this.client.core.history.get(n,t),m=Bn[p.request.method].res;this.client.core.relayer.publish(n,l,m),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{wi(s.expiry)&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{wi(s.expiry)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession(s)),...n.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===si.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=si.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=si.idle},this.processRequest=t=>{const{topic:n,payload:s}=t,c=s.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,s);case"wc_sessionSettle":return this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return this.onSessionExtendRequest(n,s);case"wc_sessionPing":return this.onSessionPingRequest(n,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return this.onSessionRequest(n,s);case"wc_sessionEvent":return this.onSessionEventRequest(n,s);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:s}=t,c=(await this.client.core.history.get(n,s.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:n}=t,{message:s}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.onSessionProposeRequest=async(t,n)=>{const{params:s,id:c}=n;try{this.isValidConnect(ar({},n.params));const l=Dr(ne.FIVE_MINUTES),p=ar({id:c,pairingTopic:t,expiry:l},s);await this.setProposal(c,p);const m=pn(JSON.stringify(n)),y=await this.getVerifyContext(m,p.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:p,verifyContext:y})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,n)=>{const{id:s}=n;if(oi(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const p=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const m=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:m});const y=await this.client.core.crypto.generateSharedKey(p,m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const O=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:O}),await this.client.core.pairing.activate({topic:t})}else Fr(n)&&(await this.client.proposal.delete(s,er("USER_DISCONNECTED")),this.events.emit(Nt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(t,n)=>{const{id:s,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:p,expiry:m,namespaces:y,requiredNamespaces:O,optionalNamespaces:j,sessionProperties:A,pairingTopic:M}=n.params,F=ar({topic:t,relay:l,expiry:m,namespaces:y,acknowledged:!0,pairingTopic:M,requiredNamespaces:O,optionalNamespaces:j,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},A&&{sessionProperties:A});await this.sendResult({id:n.id,topic:t,result:!0}),this.events.emit(Nt("session_connect"),{session:F}),this.cleanupDuplicatePairings(F)}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,n)=>{const{id:s}=n;oi(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Nt("session_approve",s),{})):Fr(n)&&(await this.client.session.delete(t,er("USER_DISCONNECTED")),this.events.emit(Nt("session_approve",s),{error:n.error}))},this.onSessionUpdateRequest=async(t,n)=>{const{params:s,id:c}=n;try{const l=`${t}_session_update`,p=uo.get(l);if(p&&this.isRequestOutOfSync(p,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(ar({topic:t},s)),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:s}),uo.set(l,c)}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(t,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Nt("session_update",s),{}):Fr(n)&&this.events.emit(Nt("session_update",s),{error:n.error})},this.onSessionExtendRequest=async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Dr(ho)),await this.sendResult({id:s,topic:t,result:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(c){await this.sendError(s,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Nt("session_extend",s),{}):Fr(n)&&this.events.emit(Nt("session_extend",s),{error:n.error})},this.onSessionPingRequest=async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(c){await this.sendError(s,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,n)=>{const{id:s}=n;setTimeout(()=>{oi(n)?this.events.emit(Nt("session_ping",s),{}):Fr(n)&&this.events.emit(Nt("session_ping",s),{error:n.error})},500)},this.onSessionDeleteRequest=async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Kt.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult({id:s,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:s,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,n)=>{const{id:s,params:c}=n;try{this.isValidRequest(ar({topic:t},c));const l=pn(JSON.stringify(dn("wc_sessionRequest",c,s))),p=this.client.session.get(t),m=await this.getVerifyContext(l,p.peer.metadata),y={id:s,topic:t,params:c,verifyContext:m};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Nt("session_request",s),{result:n.result}):Fr(n)&&this.events.emit(Nt("session_request",s),{error:n.error})},this.onSessionEventRequest=async(t,n)=>{const{id:s,params:c}=n;try{const l=`${t}_session_event_${c.event.name}`,p=uo.get(l);if(p&&this.isRequestOutOfSync(p,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(ar({topic:t},c)),this.client.events.emit("session_event",{id:s,topic:t,params:c}),uo.set(l,s)}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=si.idle,this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===si.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=si.active,this.client.events.emit("session_request",t)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=t=>{if(t.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);n&&this.onSessionProposeRequest(t.topic,dn("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer},n.id))},this.isValidConnect=async t=>{if(!cr(t)){const{message:m}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(m)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:c,sessionProperties:l,relays:p}=t;if(bi(n)||await this.isValidPairingTopic(n),!em(p,!0)){const{message:m}=Z("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(m)}!bi(s)&&go(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!bi(c)&&go(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),bi(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,n)=>{const s=tm(t,"connect()",n);if(s)throw new Error(s.message)},this.isValidApprove=async t=>{if(!cr(t))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(n);const p=this.client.proposal.get(n),m=Ya(s,"approve()");if(m)throw new Error(m.message);const y=Wh(p.requiredNamespaces,s,"approve()");if(y)throw new Error(y.message);if(!ln(c,!0)){const{message:O}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(O)}bi(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!cr(t)){const{message:c}=Z("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:n,reason:s}=t;if(await this.isValidProposalId(n),!rm(s)){const{message:c}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!cr(t)){const{message:y}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(y)}const{relay:n,controller:s,namespaces:c,expiry:l}=t;if(!im(n)){const{message:y}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const p=nm(s,"onSessionSettleRequest()");if(p)throw new Error(p.message);const m=Ya(c,"onSessionSettleRequest()");if(m)throw new Error(m.message);if(wi(l)){const{message:y}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async t=>{if(!cr(t)){const{message:m}=Z("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(m)}const{topic:n,namespaces:s}=t;await this.isValidSessionTopic(n);const c=this.client.session.get(n),l=Ya(s,"update()");if(l)throw new Error(l.message);const p=Wh(c.requiredNamespaces,s,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async t=>{if(!cr(t)){const{message:s}=Z("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionTopic(n)},this.isValidRequest=async t=>{if(!cr(t)){const{message:m}=Z("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(m)}const{topic:n,request:s,chainId:c,expiry:l}=t;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!Jh(p,c)){const{message:m}=Z("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(m)}if(!sm(s)){const{message:m}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(m)}if(!om(p,c,s.method)){const{message:m}=Z("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(m)}if(l&&!am(l,cc)){const{message:m}=Z("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${cc.min} and ${cc.max}`);throw new Error(m)}},this.isValidRespond=async t=>{if(!cr(t)){const{message:c}=Z("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:n,response:s}=t;if(await this.isValidSessionTopic(n),!cm(s)){const{message:c}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!cr(t)){const{message:s}=Z("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async t=>{if(!cr(t)){const{message:p}=Z("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(p)}const{topic:n,event:s,chainId:c}=t;await this.isValidSessionTopic(n);const{namespaces:l}=this.client.session.get(n);if(!Jh(l,c)){const{message:p}=Z("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(p)}if(!um(s)){const{message:p}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(p)}if(!hm(l,c,s.name)){const{message:p}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(p)}},this.isValidDisconnect=async t=>{if(!cr(t)){const{message:s}=Z("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(t,n)=>{const s={verified:{verifyUrl:n.verifyUrl||yo,validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:n.verifyUrl});c&&(s.verified.origin=c.origin,s.verified.isScam=c.isScam,s.verified.validation=c.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(s)}`),s},this.validateSessionProps=(t,n)=>{Object.values(t).forEach(s=>{if(!ln(s,!1)){const{message:c}=Z("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Kt.message,async r=>{const{topic:t,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const s=await this.client.core.crypto.decode(t,n);try{zc(s)?(this.client.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):Io(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.client.core.history.delete(t,s.id)):this.onRelayEventUnknownPayload({topic:t,payload:s})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async r=>{const{topic:t,id:n}=sf(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Z("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Gn.create,r=>this.onPairingCreated(r))}isValidPairingTopic(r){if(!ln(r,!1)){const{message:t}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:t}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(t)}if(wi(this.client.core.pairing.pairings.get(r).expiry)){const{message:t}=Z("EXPIRED",`pairing topic: ${r}`);throw new Error(t)}}async isValidSessionTopic(r){if(!ln(r,!1)){const{message:t}=Z("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(t)}if(!this.client.session.keys.includes(r)){const{message:t}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(t)}if(wi(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:t}=Z("EXPIRED",`session topic: ${r}`);throw new Error(t)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(ln(r,!1)){const{message:t}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(t)}else{const{message:t}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(t)}}async isValidProposalId(r){if(!lm(r)){const{message:t}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(t)}if(!this.client.proposal.keys.includes(r)){const{message:t}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(t)}if(wi(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:t}=Z("EXPIRED",`proposal id: ${r}`);throw new Error(t)}}}class qx extends Po{constructor(r,t){super(r,t,Ox,Bc),this.core=r,this.logger=t}}class Mx extends Po{constructor(r,t){super(r,t,Rx,Bc),this.core=r,this.logger=t}}class zx extends Po{constructor(r,t){super(r,t,Tx,Bc,n=>n.id),this.core=r,this.logger=t}}let Ux=class Wf extends W1{constructor(r){super(r),this.protocol=kf,this.version=Vf,this.name=ac.name,this.events=new Pr.EventEmitter,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}},this.update=async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}},this.request=async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}},this.find=n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||ac.name,this.metadata=(r==null?void 0:r.metadata)||Q_();const t=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||ac.logger}));this.core=(r==null?void 0:r.core)||new Px(r),this.logger=Te.generateChildLogger(t,this.name),this.session=new Mx(this.core,this.logger),this.proposal=new qx(this.core,this.logger),this.pendingRequest=new zx(this.core,this.logger),this.engine=new Lx(this)}static async init(r){const t=new Wf(r);return await t.initialize(),t}get context(){return Te.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var Ac={exports:{}};(function(a,r){var t=typeof self<"u"?self:ur,n=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(l){var p={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function m(_){return _&&DataView.prototype.isPrototypeOf(_)}if(p.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],O=ArrayBuffer.isView||function(_){return _&&y.indexOf(Object.prototype.toString.call(_))>-1};function j(_){if(typeof _!="string"&&(_=String(_)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(_))throw new TypeError("Invalid character in header field name");return _.toLowerCase()}function A(_){return typeof _!="string"&&(_=String(_)),_}function M(_){var x={next:function(){var Y=_.shift();return{done:Y===void 0,value:Y}}};return p.iterable&&(x[Symbol.iterator]=function(){return x}),x}function F(_){this.map={},_ instanceof F?_.forEach(function(x,Y){this.append(Y,x)},this):Array.isArray(_)?_.forEach(function(x){this.append(x[0],x[1])},this):_&&Object.getOwnPropertyNames(_).forEach(function(x){this.append(x,_[x])},this)}F.prototype.append=function(_,x){_=j(_),x=A(x);var Y=this.map[_];this.map[_]=Y?Y+", "+x:x},F.prototype.delete=function(_){delete this.map[j(_)]},F.prototype.get=function(_){return _=j(_),this.has(_)?this.map[_]:null},F.prototype.has=function(_){return this.map.hasOwnProperty(j(_))},F.prototype.set=function(_,x){this.map[j(_)]=A(x)},F.prototype.forEach=function(_,x){for(var Y in this.map)this.map.hasOwnProperty(Y)&&_.call(x,this.map[Y],Y,this)},F.prototype.keys=function(){var _=[];return this.forEach(function(x,Y){_.push(Y)}),M(_)},F.prototype.values=function(){var _=[];return this.forEach(function(x){_.push(x)}),M(_)},F.prototype.entries=function(){var _=[];return this.forEach(function(x,Y){_.push([Y,x])}),M(_)},p.iterable&&(F.prototype[Symbol.iterator]=F.prototype.entries);function K(_){if(_.bodyUsed)return Promise.reject(new TypeError("Already read"));_.bodyUsed=!0}function ie(_){return new Promise(function(x,Y){_.onload=function(){x(_.result)},_.onerror=function(){Y(_.error)}})}function Ee(_){var x=new FileReader,Y=ie(x);return x.readAsArrayBuffer(_),Y}function ge(_){var x=new FileReader,Y=ie(x);return x.readAsText(_),Y}function pe(_){for(var x=new Uint8Array(_),Y=new Array(x.length),ce=0;ce<x.length;ce++)Y[ce]=String.fromCharCode(x[ce]);return Y.join("")}function he(_){if(_.slice)return _.slice(0);var x=new Uint8Array(_.byteLength);return x.set(new Uint8Array(_)),x.buffer}function le(){return this.bodyUsed=!1,this._initBody=function(_){this._bodyInit=_,_?typeof _=="string"?this._bodyText=_:p.blob&&Blob.prototype.isPrototypeOf(_)?this._bodyBlob=_:p.formData&&FormData.prototype.isPrototypeOf(_)?this._bodyFormData=_:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)?this._bodyText=_.toString():p.arrayBuffer&&p.blob&&m(_)?(this._bodyArrayBuffer=he(_.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(_)||O(_))?this._bodyArrayBuffer=he(_):this._bodyText=_=Object.prototype.toString.call(_):this._bodyText="",this.headers.get("content-type")||(typeof _=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var _=K(this);if(_)return _;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ee)}),this.text=function(){var _=K(this);if(_)return _;if(this._bodyBlob)return ge(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(pe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(ye)}),this.json=function(){return this.text().then(JSON.parse)},this}var N=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function U(_){var x=_.toUpperCase();return N.indexOf(x)>-1?x:_}function W(_,x){x=x||{};var Y=x.body;if(_ instanceof W){if(_.bodyUsed)throw new TypeError("Already read");this.url=_.url,this.credentials=_.credentials,x.headers||(this.headers=new F(_.headers)),this.method=_.method,this.mode=_.mode,this.signal=_.signal,!Y&&_._bodyInit!=null&&(Y=_._bodyInit,_.bodyUsed=!0)}else this.url=String(_);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new F(x.headers)),this.method=U(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Y)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Y)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ye(_){var x=new FormData;return _.trim().split("&").forEach(function(Y){if(Y){var ce=Y.split("="),V=ce.shift().replace(/\+/g," "),H=ce.join("=").replace(/\+/g," ");x.append(decodeURIComponent(V),decodeURIComponent(H))}}),x}function re(_){var x=new F,Y=_.replace(/\r?\n[\t ]+/g," ");return Y.split(/\r?\n/).forEach(function(ce){var V=ce.split(":"),H=V.shift().trim();if(H){var k=V.join(":").trim();x.append(H,k)}}),x}le.call(W.prototype);function ue(_,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new F(x.headers),this.url=x.url||"",this._initBody(_)}le.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new F(this.headers),url:this.url})},ue.error=function(){var _=new ue(null,{status:0,statusText:""});return _.type="error",_};var Ce=[301,302,303,307,308];ue.redirect=function(_,x){if(Ce.indexOf(x)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:x,headers:{location:_}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(x,Y){this.message=x,this.name=Y;var ce=Error(x);this.stack=ce.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function ze(_,x){return new Promise(function(Y,ce){var V=new W(_,x);if(V.signal&&V.signal.aborted)return ce(new l.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function k(){H.abort()}H.onload=function(){var G={status:H.status,statusText:H.statusText,headers:re(H.getAllResponseHeaders()||"")};G.url="responseURL"in H?H.responseURL:G.headers.get("X-Request-URL");var Je="response"in H?H.response:H.responseText;Y(new ue(Je,G))},H.onerror=function(){ce(new TypeError("Network request failed"))},H.ontimeout=function(){ce(new TypeError("Network request failed"))},H.onabort=function(){ce(new l.DOMException("Aborted","AbortError"))},H.open(V.method,V.url,!0),V.credentials==="include"?H.withCredentials=!0:V.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&p.blob&&(H.responseType="blob"),V.headers.forEach(function(G,Je){H.setRequestHeader(Je,G)}),V.signal&&(V.signal.addEventListener("abort",k),H.onreadystatechange=function(){H.readyState===4&&V.signal.removeEventListener("abort",k)}),H.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return ze.polyfill=!0,c.fetch||(c.fetch=ze,c.Headers=F,c.Request=W,c.Response=ue),l.Headers=F,l.Request=W,l.Response=ue,l.fetch=ze,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=n;r=s.fetch,r.default=s.fetch,r.fetch=s.fetch,r.Headers=s.Headers,r.Request=s.Request,r.Response=s.Response,a.exports=r})(Ac,Ac.exports);var Hx=Ac.exports;const Ul=rf(Hx),Bx={Accept:"application/json","Content-Type":"application/json"},kx="POST",Hl={headers:Bx,method:kx},Bl=10;class Ii{constructor(r,t=!1){if(this.url=r,this.disableProviderPing=t,this.events=new Pr.EventEmitter,this.isAvailable=!1,this.registering=!1,!gl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,t){this.isAvailable||await this.register();try{const n=es(r),c=await(await Ul(this.url,Object.assign(Object.assign({},Hl),{body:n}))).json();this.onPayload({data:c})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!gl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const t=es({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ul(r,Object.assign(Object.assign({},Hl),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?Fc(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),s=n.message||n.toString(),c=xo(r,s);this.events.emit("payload",c)}parseError(r,t=this.url){return If(r,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Bl&&this.events.setMaxListeners(Bl)}}const kl="error",Vx="wss://relay.walletconnect.com",Kx="wc",Gx="universal_provider",Vl=`${Kx}@2:${Gx}:`,Wx="https://rpc.walletconnect.com/v1/",ci={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Tc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var t,n="4.17.21",s=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",p="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",y=500,O="__lodash_placeholder__",j=1,A=2,M=4,F=1,K=2,ie=1,Ee=2,ge=4,pe=8,he=16,le=32,N=64,U=128,W=256,ye=512,re=30,ue="...",Ce=800,ze=16,_=1,x=2,Y=3,ce=1/0,V=9007199254740991,H=17976931348623157e292,k=0/0,G=4294967295,Je=G-1,Be=G>>>1,jr=[["ary",U],["bind",ie],["bindKey",Ee],["curry",pe],["curryRight",he],["flip",ye],["partial",le],["partialRight",N],["rearg",W]],xe="[object Arguments]",xt="[object Array]",$="[object AsyncFunction]",C="[object Boolean]",R="[object Date]",h="[object DOMException]",E="[object Error]",ee="[object Function]",fe="[object GeneratorFunction]",we="[object Map]",$e="[object Number]",De="[object Null]",Pe="[object Object]",It="[object Promise]",_t="[object Proxy]",ot="[object RegExp]",je="[object Set]",Ye="[object String]",Xe="[object Symbol]",at="[object Undefined]",Ue="[object WeakMap]",Ze="[object WeakSet]",Ne="[object ArrayBuffer]",ke="[object DataView]",ht="[object Float32Array]",qe="[object Float64Array]",St="[object Int8Array]",Dt="[object Int16Array]",zt="[object Int32Array]",Ut="[object Uint8Array]",Lt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",tr="[object Uint32Array]",Lr=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,kr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ui=/&(?:amp|lt|gt|quot|#39);/g,Si=/[&<>"']/g,lt=RegExp(ui.source),rt=RegExp(Si.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pt=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,mt=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,At=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Oo=/[()=,{}\[\]\/\s]/,Ro=/\\(\\)?/g,Ao=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,To=/^[-+]0x[0-9a-f]+$/i,Co=/^0b[01]+$/i,$o=/^\[object .+?Constructor\]$/,No=/^0o[0-7]+$/i,Do=/^(?:0|[1-9]\d*)$/,Vr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Bi=/($^)/,Fo=/['\n\r\u2028\u2029\\]/g,ki="\\ud800-\\udfff",jo="\\u0300-\\u036f",Lo="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",ss=jo+Lo+Vi,os="\\u2700-\\u27bf",Or="a-z\\xdf-\\xf6\\xf8-\\xff",qo="\\xac\\xb1\\xd7\\xf7",Mo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",zo="\\u2000-\\u206f",Uo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",as="A-Z\\xc0-\\xd6\\xd8-\\xde",cs="\\ufe0e\\ufe0f",Pi=qo+Mo+zo+Uo,vn="[']",Oi="["+ki+"]",_n="["+Pi+"]",Ri="["+ss+"]",us="\\d+",Ho="["+os+"]",hs="["+Or+"]",ls="[^"+ki+Pi+us+os+Or+as+"]",Ki="\\ud83c[\\udffb-\\udfff]",Bo="(?:"+Ri+"|"+Ki+")",fs="[^"+ki+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",hi="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+as+"]",ps="\\u200d",ds="(?:"+hs+"|"+ls+")",qr="(?:"+hr+"|"+ls+")",gs="(?:"+vn+"(?:d|ll|m|re|s|t|ve))?",ys="(?:"+vn+"(?:D|LL|M|RE|S|T|VE))?",vs=Bo+"?",_s="["+cs+"]?",ko="(?:"+ps+"(?:"+[fs,Gi,hi].join("|")+")"+_s+vs+")*",Kr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ms="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ws=_s+vs+ko,Wi="(?:"+[Ho,Gi,hi].join("|")+")"+ws,Vo="(?:"+[fs+Ri+"?",Ri,Gi,hi,Oi].join("|")+")",mn=RegExp(vn,"g"),Ko=RegExp(Ri,"g"),Ji=RegExp(Ki+"(?="+Ki+")|"+Vo+ws,"g"),bs=RegExp([hr+"?"+hs+"+"+gs+"(?="+[_n,hr,"$"].join("|")+")",qr+"+"+ys+"(?="+[_n,hr+ds,"$"].join("|")+")",hr+"?"+ds+"+"+gs,hr+"+"+ys,ms,Kr,us,Wi].join("|"),"g"),Es=RegExp("["+ps+ki+ss+cs+"]"),Ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,xs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Go=-1,Ve={};Ve[ht]=Ve[qe]=Ve[St]=Ve[Dt]=Ve[zt]=Ve[Ut]=Ve[Lt]=Ve[Gt]=Ve[tr]=!0,Ve[xe]=Ve[xt]=Ve[Ne]=Ve[C]=Ve[ke]=Ve[R]=Ve[E]=Ve[ee]=Ve[we]=Ve[$e]=Ve[Pe]=Ve[ot]=Ve[je]=Ve[Ye]=Ve[Ue]=!1;var He={};He[xe]=He[xt]=He[Ne]=He[ke]=He[C]=He[R]=He[ht]=He[qe]=He[St]=He[Dt]=He[zt]=He[we]=He[$e]=He[Pe]=He[ot]=He[je]=He[Ye]=He[Xe]=He[Ut]=He[Lt]=He[Gt]=He[tr]=!0,He[E]=He[ee]=He[Ue]=!1;var v={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ke=parseFloat,ve=parseInt,et=typeof Vn=="object"&&Vn&&Vn.Object===Object&&Vn,Ct=typeof self=="object"&&self&&self.Object===Object&&self,Re=et||Ct||Function("return this")(),Ge=r&&!r.nodeType&&r,wt=Ge&&!0&&a&&!a.nodeType&&a,rr=wt&&wt.exports===Ge,$t=rr&&et.process,tt=function(){try{var S=wt&&wt.require&&wt.require("util").types;return S||$t&&$t.binding&&$t.binding("util")}catch{}}(),Jt=tt&&tt.isArrayBuffer,Rr=tt&&tt.isDate,vr=tt&&tt.isMap,Mr=tt&&tt.isRegExp,wn=tt&&tt.isSet,Ti=tt&&tt.isTypedArray;function qt(S,D,T){switch(T.length){case 0:return S.call(D);case 1:return S.call(D,T[0]);case 2:return S.call(D,T[0],T[1]);case 3:return S.call(D,T[0],T[1],T[2])}return S.apply(D,T)}function Yf(S,D,T,X){for(var de=-1,Fe=S==null?0:S.length;++de<Fe;){var Ft=S[de];D(X,Ft,T(Ft),S)}return X}function _r(S,D){for(var T=-1,X=S==null?0:S.length;++T<X&&D(S[T],T,S)!==!1;);return S}function Xf(S,D){for(var T=S==null?0:S.length;T--&&D(S[T],T,S)!==!1;);return S}function Kc(S,D){for(var T=-1,X=S==null?0:S.length;++T<X;)if(!D(S[T],T,S))return!1;return!0}function li(S,D){for(var T=-1,X=S==null?0:S.length,de=0,Fe=[];++T<X;){var Ft=S[T];D(Ft,T,S)&&(Fe[de++]=Ft)}return Fe}function Is(S,D){var T=S==null?0:S.length;return!!T&&Qi(S,D,0)>-1}function Wo(S,D,T){for(var X=-1,de=S==null?0:S.length;++X<de;)if(T(D,S[X]))return!0;return!1}function nt(S,D){for(var T=-1,X=S==null?0:S.length,de=Array(X);++T<X;)de[T]=D(S[T],T,S);return de}function fi(S,D){for(var T=-1,X=D.length,de=S.length;++T<X;)S[de+T]=D[T];return S}function Jo(S,D,T,X){var de=-1,Fe=S==null?0:S.length;for(X&&Fe&&(T=S[++de]);++de<Fe;)T=D(T,S[de],de,S);return T}function Zf(S,D,T,X){var de=S==null?0:S.length;for(X&&de&&(T=S[--de]);de--;)T=D(T,S[de],de,S);return T}function Qo(S,D){for(var T=-1,X=S==null?0:S.length;++T<X;)if(D(S[T],T,S))return!0;return!1}var ep=Yo("length");function tp(S){return S.split("")}function rp(S){return S.match(Tt)||[]}function Gc(S,D,T){var X;return T(S,function(de,Fe,Ft){if(D(de,Fe,Ft))return X=Fe,!1}),X}function Ss(S,D,T,X){for(var de=S.length,Fe=T+(X?1:-1);X?Fe--:++Fe<de;)if(D(S[Fe],Fe,S))return Fe;return-1}function Qi(S,D,T){return D===D?dp(S,D,T):Ss(S,Wc,T)}function ip(S,D,T,X){for(var de=T-1,Fe=S.length;++de<Fe;)if(X(S[de],D))return de;return-1}function Wc(S){return S!==S}function Jc(S,D){var T=S==null?0:S.length;return T?Zo(S,D)/T:k}function Yo(S){return function(D){return D==null?t:D[S]}}function Xo(S){return function(D){return S==null?t:S[D]}}function Qc(S,D,T,X,de){return de(S,function(Fe,Ft,We){T=X?(X=!1,Fe):D(T,Fe,Ft,We)}),T}function np(S,D){var T=S.length;for(S.sort(D);T--;)S[T]=S[T].value;return S}function Zo(S,D){for(var T,X=-1,de=S.length;++X<de;){var Fe=D(S[X]);Fe!==t&&(T=T===t?Fe:T+Fe)}return T}function ea(S,D){for(var T=-1,X=Array(S);++T<S;)X[T]=D(T);return X}function sp(S,D){return nt(D,function(T){return[T,S[T]]})}function Yc(S){return S&&S.slice(0,tu(S)+1).replace(gt,"")}function lr(S){return function(D){return S(D)}}function ta(S,D){return nt(D,function(T){return S[T]})}function bn(S,D){return S.has(D)}function Xc(S,D){for(var T=-1,X=S.length;++T<X&&Qi(D,S[T],0)>-1;);return T}function Zc(S,D){for(var T=S.length;T--&&Qi(D,S[T],0)>-1;);return T}function op(S,D){for(var T=S.length,X=0;T--;)S[T]===D&&++X;return X}var ap=Xo(v),cp=Xo(I);function up(S){return"\\"+Q[S]}function hp(S,D){return S==null?t:S[D]}function Yi(S){return Es.test(S)}function lp(S){return Ai.test(S)}function fp(S){for(var D,T=[];!(D=S.next()).done;)T.push(D.value);return T}function ra(S){var D=-1,T=Array(S.size);return S.forEach(function(X,de){T[++D]=[de,X]}),T}function eu(S,D){return function(T){return S(D(T))}}function pi(S,D){for(var T=-1,X=S.length,de=0,Fe=[];++T<X;){var Ft=S[T];(Ft===D||Ft===O)&&(S[T]=O,Fe[de++]=T)}return Fe}function Ps(S){var D=-1,T=Array(S.size);return S.forEach(function(X){T[++D]=X}),T}function pp(S){var D=-1,T=Array(S.size);return S.forEach(function(X){T[++D]=[X,X]}),T}function dp(S,D,T){for(var X=T-1,de=S.length;++X<de;)if(S[X]===D)return X;return-1}function gp(S,D,T){for(var X=T+1;X--;)if(S[X]===D)return X;return X}function Xi(S){return Yi(S)?vp(S):ep(S)}function Ar(S){return Yi(S)?_p(S):tp(S)}function tu(S){for(var D=S.length;D--&&mt.test(S.charAt(D)););return D}var yp=Xo(z);function vp(S){for(var D=Ji.lastIndex=0;Ji.test(S);)++D;return D}function _p(S){return S.match(Ji)||[]}function mp(S){return S.match(bs)||[]}var wp=function S(D){D=D==null?Re:Zi.defaults(Re.Object(),D,Zi.pick(Re,xs));var T=D.Array,X=D.Date,de=D.Error,Fe=D.Function,Ft=D.Math,We=D.Object,ia=D.RegExp,bp=D.String,mr=D.TypeError,Os=T.prototype,Ep=Fe.prototype,en=We.prototype,Rs=D["__core-js_shared__"],As=Ep.toString,Me=en.hasOwnProperty,xp=0,ru=function(){var e=/[^.]+$/.exec(Rs&&Rs.keys&&Rs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ts=en.toString,Ip=As.call(We),Sp=Re._,Pp=ia("^"+As.call(Me).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Cs=rr?D.Buffer:t,di=D.Symbol,$s=D.Uint8Array,iu=Cs?Cs.allocUnsafe:t,Ns=eu(We.getPrototypeOf,We),nu=We.create,su=en.propertyIsEnumerable,Ds=Os.splice,ou=di?di.isConcatSpreadable:t,En=di?di.iterator:t,Ci=di?di.toStringTag:t,Fs=function(){try{var e=ji(We,"defineProperty");return e({},"",{}),e}catch{}}(),Op=D.clearTimeout!==Re.clearTimeout&&D.clearTimeout,Rp=X&&X.now!==Re.Date.now&&X.now,Ap=D.setTimeout!==Re.setTimeout&&D.setTimeout,js=Ft.ceil,Ls=Ft.floor,na=We.getOwnPropertySymbols,Tp=Cs?Cs.isBuffer:t,au=D.isFinite,Cp=Os.join,$p=eu(We.keys,We),jt=Ft.max,kt=Ft.min,Np=X.now,Dp=D.parseInt,cu=Ft.random,Fp=Os.reverse,sa=ji(D,"DataView"),xn=ji(D,"Map"),oa=ji(D,"Promise"),tn=ji(D,"Set"),In=ji(D,"WeakMap"),Sn=ji(We,"create"),qs=In&&new In,rn={},jp=Li(sa),Lp=Li(xn),qp=Li(oa),Mp=Li(tn),zp=Li(In),Ms=di?di.prototype:t,Pn=Ms?Ms.valueOf:t,uu=Ms?Ms.toString:t;function d(e){if(vt(e)&&!_e(e)&&!(e instanceof Oe)){if(e instanceof wr)return e;if(Me.call(e,"__wrapped__"))return hh(e)}return new wr(e)}var nn=function(){function e(){}return function(i){if(!ut(i))return{};if(nu)return nu(i);e.prototype=i;var o=new e;return e.prototype=t,o}}();function zs(){}function wr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}d.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:d}},d.prototype=zs.prototype,d.prototype.constructor=d,wr.prototype=nn(zs.prototype),wr.prototype.constructor=wr;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function Up(){var e=new Oe(this.__wrapped__);return e.__actions__=ir(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ir(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ir(this.__views__),e}function Hp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Bp(){var e=this.__wrapped__.value(),i=this.__dir__,o=_e(e),u=i<0,f=o?e.length:0,g=tg(0,f,this.__views__),w=g.start,b=g.end,P=b-w,L=u?b:w-1,q=this.__iteratees__,B=q.length,J=0,te=kt(P,this.__takeCount__);if(!o||!u&&f==P&&te==P)return Nu(e,this.__actions__);var oe=[];e:for(;P--&&J<te;){L+=i;for(var be=-1,ae=e[L];++be<B;){var Se=q[be],Ae=Se.iteratee,dr=Se.type,Xt=Ae(ae);if(dr==x)ae=Xt;else if(!Xt){if(dr==_)continue e;break e}}oe[J++]=ae}return oe}Oe.prototype=nn(zs.prototype),Oe.prototype.constructor=Oe;function $i(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function kp(){this.__data__=Sn?Sn(null):{},this.size=0}function Vp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Kp(e){var i=this.__data__;if(Sn){var o=i[e];return o===m?t:o}return Me.call(i,e)?i[e]:t}function Gp(e){var i=this.__data__;return Sn?i[e]!==t:Me.call(i,e)}function Wp(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Sn&&i===t?m:i,this}$i.prototype.clear=kp,$i.prototype.delete=Vp,$i.prototype.get=Kp,$i.prototype.has=Gp,$i.prototype.set=Wp;function Gr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Jp(){this.__data__=[],this.size=0}function Qp(e){var i=this.__data__,o=Us(i,e);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():Ds.call(i,o,1),--this.size,!0}function Yp(e){var i=this.__data__,o=Us(i,e);return o<0?t:i[o][1]}function Xp(e){return Us(this.__data__,e)>-1}function Zp(e,i){var o=this.__data__,u=Us(o,e);return u<0?(++this.size,o.push([e,i])):o[u][1]=i,this}Gr.prototype.clear=Jp,Gr.prototype.delete=Qp,Gr.prototype.get=Yp,Gr.prototype.has=Xp,Gr.prototype.set=Zp;function Wr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function ed(){this.size=0,this.__data__={hash:new $i,map:new(xn||Gr),string:new $i}}function td(e){var i=Zs(this,e).delete(e);return this.size-=i?1:0,i}function rd(e){return Zs(this,e).get(e)}function id(e){return Zs(this,e).has(e)}function nd(e,i){var o=Zs(this,e),u=o.size;return o.set(e,i),this.size+=o.size==u?0:1,this}Wr.prototype.clear=ed,Wr.prototype.delete=td,Wr.prototype.get=rd,Wr.prototype.has=id,Wr.prototype.set=nd;function Ni(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new Wr;++i<o;)this.add(e[i])}function sd(e){return this.__data__.set(e,m),this}function od(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=sd,Ni.prototype.has=od;function Tr(e){var i=this.__data__=new Gr(e);this.size=i.size}function ad(){this.__data__=new Gr,this.size=0}function cd(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function ud(e){return this.__data__.get(e)}function hd(e){return this.__data__.has(e)}function ld(e,i){var o=this.__data__;if(o instanceof Gr){var u=o.__data__;if(!xn||u.length<s-1)return u.push([e,i]),this.size=++o.size,this;o=this.__data__=new Wr(u)}return o.set(e,i),this.size=o.size,this}Tr.prototype.clear=ad,Tr.prototype.delete=cd,Tr.prototype.get=ud,Tr.prototype.has=hd,Tr.prototype.set=ld;function hu(e,i){var o=_e(e),u=!o&&qi(e),f=!o&&!u&&mi(e),g=!o&&!u&&!f&&cn(e),w=o||u||f||g,b=w?ea(e.length,bp):[],P=b.length;for(var L in e)(i||Me.call(e,L))&&!(w&&(L=="length"||f&&(L=="offset"||L=="parent")||g&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||Xr(L,P)))&&b.push(L);return b}function lu(e){var i=e.length;return i?e[va(0,i-1)]:t}function fd(e,i){return eo(ir(e),Di(i,0,e.length))}function pd(e){return eo(ir(e))}function aa(e,i,o){(o!==t&&!Cr(e[i],o)||o===t&&!(i in e))&&Jr(e,i,o)}function On(e,i,o){var u=e[i];(!(Me.call(e,i)&&Cr(u,o))||o===t&&!(i in e))&&Jr(e,i,o)}function Us(e,i){for(var o=e.length;o--;)if(Cr(e[o][0],i))return o;return-1}function dd(e,i,o,u){return gi(e,function(f,g,w){i(u,f,o(f),w)}),u}function fu(e,i){return e&&Ur(i,Mt(i),e)}function gd(e,i){return e&&Ur(i,sr(i),e)}function Jr(e,i,o){i=="__proto__"&&Fs?Fs(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function ca(e,i){for(var o=-1,u=i.length,f=T(u),g=e==null;++o<u;)f[o]=g?t:Ha(e,i[o]);return f}function Di(e,i,o){return e===e&&(o!==t&&(e=e<=o?e:o),i!==t&&(e=e>=i?e:i)),e}function br(e,i,o,u,f,g){var w,b=i&j,P=i&A,L=i&M;if(o&&(w=f?o(e,u,f,g):o(e)),w!==t)return w;if(!ut(e))return e;var q=_e(e);if(q){if(w=ig(e),!b)return ir(e,w)}else{var B=Vt(e),J=B==ee||B==fe;if(mi(e))return ju(e,b);if(B==Pe||B==xe||J&&!f){if(w=P||J?{}:th(e),!b)return P?Kd(e,gd(w,e)):Vd(e,fu(w,e))}else{if(!He[B])return f?e:{};w=ng(e,B,b)}}g||(g=new Tr);var te=g.get(e);if(te)return te;g.set(e,w),Th(e)?e.forEach(function(ae){w.add(br(ae,i,o,ae,e,g))}):Rh(e)&&e.forEach(function(ae,Se){w.set(Se,br(ae,i,o,Se,e,g))});var oe=L?P?Ra:Oa:P?sr:Mt,be=q?t:oe(e);return _r(be||e,function(ae,Se){be&&(Se=ae,ae=e[Se]),On(w,Se,br(ae,i,o,Se,e,g))}),w}function yd(e){var i=Mt(e);return function(o){return pu(o,e,i)}}function pu(e,i,o){var u=o.length;if(e==null)return!u;for(e=We(e);u--;){var f=o[u],g=i[f],w=e[f];if(w===t&&!(f in e)||!g(w))return!1}return!0}function du(e,i,o){if(typeof e!="function")throw new mr(l);return Dn(function(){e.apply(t,o)},i)}function Rn(e,i,o,u){var f=-1,g=Is,w=!0,b=e.length,P=[],L=i.length;if(!b)return P;o&&(i=nt(i,lr(o))),u?(g=Wo,w=!1):i.length>=s&&(g=bn,w=!1,i=new Ni(i));e:for(;++f<b;){var q=e[f],B=o==null?q:o(q);if(q=u||q!==0?q:0,w&&B===B){for(var J=L;J--;)if(i[J]===B)continue e;P.push(q)}else g(i,B,u)||P.push(q)}return P}var gi=Uu(zr),gu=Uu(ha,!0);function vd(e,i){var o=!0;return gi(e,function(u,f,g){return o=!!i(u,f,g),o}),o}function Hs(e,i,o){for(var u=-1,f=e.length;++u<f;){var g=e[u],w=i(g);if(w!=null&&(b===t?w===w&&!pr(w):o(w,b)))var b=w,P=g}return P}function _d(e,i,o,u){var f=e.length;for(o=me(o),o<0&&(o=-o>f?0:f+o),u=u===t||u>f?f:me(u),u<0&&(u+=f),u=o>u?0:$h(u);o<u;)e[o++]=i;return e}function yu(e,i){var o=[];return gi(e,function(u,f,g){i(u,f,g)&&o.push(u)}),o}function Ht(e,i,o,u,f){var g=-1,w=e.length;for(o||(o=og),f||(f=[]);++g<w;){var b=e[g];i>0&&o(b)?i>1?Ht(b,i-1,o,u,f):fi(f,b):u||(f[f.length]=b)}return f}var ua=Hu(),vu=Hu(!0);function zr(e,i){return e&&ua(e,i,Mt)}function ha(e,i){return e&&vu(e,i,Mt)}function Bs(e,i){return li(i,function(o){return Zr(e[o])})}function Fi(e,i){i=vi(i,e);for(var o=0,u=i.length;e!=null&&o<u;)e=e[Hr(i[o++])];return o&&o==u?e:t}function _u(e,i,o){var u=i(e);return _e(e)?u:fi(u,o(e))}function Qt(e){return e==null?e===t?at:De:Ci&&Ci in We(e)?eg(e):pg(e)}function la(e,i){return e>i}function md(e,i){return e!=null&&Me.call(e,i)}function wd(e,i){return e!=null&&i in We(e)}function bd(e,i,o){return e>=kt(i,o)&&e<jt(i,o)}function fa(e,i,o){for(var u=o?Wo:Is,f=e[0].length,g=e.length,w=g,b=T(g),P=1/0,L=[];w--;){var q=e[w];w&&i&&(q=nt(q,lr(i))),P=kt(q.length,P),b[w]=!o&&(i||f>=120&&q.length>=120)?new Ni(w&&q):t}q=e[0];var B=-1,J=b[0];e:for(;++B<f&&L.length<P;){var te=q[B],oe=i?i(te):te;if(te=o||te!==0?te:0,!(J?bn(J,oe):u(L,oe,o))){for(w=g;--w;){var be=b[w];if(!(be?bn(be,oe):u(e[w],oe,o)))continue e}J&&J.push(oe),L.push(te)}}return L}function Ed(e,i,o,u){return zr(e,function(f,g,w){i(u,o(f),g,w)}),u}function An(e,i,o){i=vi(i,e),e=sh(e,i);var u=e==null?e:e[Hr(xr(i))];return u==null?t:qt(u,e,o)}function mu(e){return vt(e)&&Qt(e)==xe}function xd(e){return vt(e)&&Qt(e)==Ne}function Id(e){return vt(e)&&Qt(e)==R}function Tn(e,i,o,u,f){return e===i?!0:e==null||i==null||!vt(e)&&!vt(i)?e!==e&&i!==i:Sd(e,i,o,u,Tn,f)}function Sd(e,i,o,u,f,g){var w=_e(e),b=_e(i),P=w?xt:Vt(e),L=b?xt:Vt(i);P=P==xe?Pe:P,L=L==xe?Pe:L;var q=P==Pe,B=L==Pe,J=P==L;if(J&&mi(e)){if(!mi(i))return!1;w=!0,q=!1}if(J&&!q)return g||(g=new Tr),w||cn(e)?Xu(e,i,o,u,f,g):Xd(e,i,P,o,u,f,g);if(!(o&F)){var te=q&&Me.call(e,"__wrapped__"),oe=B&&Me.call(i,"__wrapped__");if(te||oe){var be=te?e.value():e,ae=oe?i.value():i;return g||(g=new Tr),f(be,ae,o,u,g)}}return J?(g||(g=new Tr),Zd(e,i,o,u,f,g)):!1}function Pd(e){return vt(e)&&Vt(e)==we}function pa(e,i,o,u){var f=o.length,g=f,w=!u;if(e==null)return!g;for(e=We(e);f--;){var b=o[f];if(w&&b[2]?b[1]!==e[b[0]]:!(b[0]in e))return!1}for(;++f<g;){b=o[f];var P=b[0],L=e[P],q=b[1];if(w&&b[2]){if(L===t&&!(P in e))return!1}else{var B=new Tr;if(u)var J=u(L,q,P,e,i,B);if(!(J===t?Tn(q,L,F|K,u,B):J))return!1}}return!0}function wu(e){if(!ut(e)||cg(e))return!1;var i=Zr(e)?Pp:$o;return i.test(Li(e))}function Od(e){return vt(e)&&Qt(e)==ot}function Rd(e){return vt(e)&&Vt(e)==je}function Ad(e){return vt(e)&&oo(e.length)&&!!Ve[Qt(e)]}function bu(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?_e(e)?Iu(e[0],e[1]):xu(e):Bh(e)}function da(e){if(!Nn(e))return $p(e);var i=[];for(var o in We(e))Me.call(e,o)&&o!="constructor"&&i.push(o);return i}function Td(e){if(!ut(e))return fg(e);var i=Nn(e),o=[];for(var u in e)u=="constructor"&&(i||!Me.call(e,u))||o.push(u);return o}function ga(e,i){return e<i}function Eu(e,i){var o=-1,u=nr(e)?T(e.length):[];return gi(e,function(f,g,w){u[++o]=i(f,g,w)}),u}function xu(e){var i=Ta(e);return i.length==1&&i[0][2]?ih(i[0][0],i[0][1]):function(o){return o===e||pa(o,e,i)}}function Iu(e,i){return $a(e)&&rh(i)?ih(Hr(e),i):function(o){var u=Ha(o,e);return u===t&&u===i?Ba(o,e):Tn(i,u,F|K)}}function ks(e,i,o,u,f){e!==i&&ua(i,function(g,w){if(f||(f=new Tr),ut(g))Cd(e,i,w,o,ks,u,f);else{var b=u?u(Da(e,w),g,w+"",e,i,f):t;b===t&&(b=g),aa(e,w,b)}},sr)}function Cd(e,i,o,u,f,g,w){var b=Da(e,o),P=Da(i,o),L=w.get(P);if(L){aa(e,o,L);return}var q=g?g(b,P,o+"",e,i,w):t,B=q===t;if(B){var J=_e(P),te=!J&&mi(P),oe=!J&&!te&&cn(P);q=P,J||te||oe?_e(b)?q=b:bt(b)?q=ir(b):te?(B=!1,q=ju(P,!0)):oe?(B=!1,q=Lu(P,!0)):q=[]:Fn(P)||qi(P)?(q=b,qi(b)?q=Nh(b):(!ut(b)||Zr(b))&&(q=th(P))):B=!1}B&&(w.set(P,q),f(q,P,u,g,w),w.delete(P)),aa(e,o,q)}function Su(e,i){var o=e.length;if(o)return i+=i<0?o:0,Xr(i,o)?e[i]:t}function Pu(e,i,o){i.length?i=nt(i,function(g){return _e(g)?function(w){return Fi(w,g.length===1?g[0]:g)}:g}):i=[or];var u=-1;i=nt(i,lr(se()));var f=Eu(e,function(g,w,b){var P=nt(i,function(L){return L(g)});return{criteria:P,index:++u,value:g}});return np(f,function(g,w){return kd(g,w,o)})}function $d(e,i){return Ou(e,i,function(o,u){return Ba(e,u)})}function Ou(e,i,o){for(var u=-1,f=i.length,g={};++u<f;){var w=i[u],b=Fi(e,w);o(b,w)&&Cn(g,vi(w,e),b)}return g}function Nd(e){return function(i){return Fi(i,e)}}function ya(e,i,o,u){var f=u?ip:Qi,g=-1,w=i.length,b=e;for(e===i&&(i=ir(i)),o&&(b=nt(e,lr(o)));++g<w;)for(var P=0,L=i[g],q=o?o(L):L;(P=f(b,q,P,u))>-1;)b!==e&&Ds.call(b,P,1),Ds.call(e,P,1);return e}function Ru(e,i){for(var o=e?i.length:0,u=o-1;o--;){var f=i[o];if(o==u||f!==g){var g=f;Xr(f)?Ds.call(e,f,1):wa(e,f)}}return e}function va(e,i){return e+Ls(cu()*(i-e+1))}function Dd(e,i,o,u){for(var f=-1,g=jt(js((i-e)/(o||1)),0),w=T(g);g--;)w[u?g:++f]=e,e+=o;return w}function _a(e,i){var o="";if(!e||i<1||i>V)return o;do i%2&&(o+=e),i=Ls(i/2),i&&(e+=e);while(i);return o}function Ie(e,i){return Fa(nh(e,i,or),e+"")}function Fd(e){return lu(un(e))}function jd(e,i){var o=un(e);return eo(o,Di(i,0,o.length))}function Cn(e,i,o,u){if(!ut(e))return e;i=vi(i,e);for(var f=-1,g=i.length,w=g-1,b=e;b!=null&&++f<g;){var P=Hr(i[f]),L=o;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(f!=w){var q=b[P];L=u?u(q,P,b):t,L===t&&(L=ut(q)?q:Xr(i[f+1])?[]:{})}On(b,P,L),b=b[P]}return e}var Au=qs?function(e,i){return qs.set(e,i),e}:or,Ld=Fs?function(e,i){return Fs(e,"toString",{configurable:!0,enumerable:!1,value:Va(i),writable:!0})}:or;function qd(e){return eo(un(e))}function Er(e,i,o){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),o=o>f?f:o,o<0&&(o+=f),f=i>o?0:o-i>>>0,i>>>=0;for(var g=T(f);++u<f;)g[u]=e[u+i];return g}function Md(e,i){var o;return gi(e,function(u,f,g){return o=i(u,f,g),!o}),!!o}function Vs(e,i,o){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=Be){for(;u<f;){var g=u+f>>>1,w=e[g];w!==null&&!pr(w)&&(o?w<=i:w<i)?u=g+1:f=g}return f}return ma(e,i,or,o)}function ma(e,i,o,u){var f=0,g=e==null?0:e.length;if(g===0)return 0;i=o(i);for(var w=i!==i,b=i===null,P=pr(i),L=i===t;f<g;){var q=Ls((f+g)/2),B=o(e[q]),J=B!==t,te=B===null,oe=B===B,be=pr(B);if(w)var ae=u||oe;else L?ae=oe&&(u||J):b?ae=oe&&J&&(u||!te):P?ae=oe&&J&&!te&&(u||!be):te||be?ae=!1:ae=u?B<=i:B<i;ae?f=q+1:g=q}return kt(g,Je)}function Tu(e,i){for(var o=-1,u=e.length,f=0,g=[];++o<u;){var w=e[o],b=i?i(w):w;if(!o||!Cr(b,P)){var P=b;g[f++]=w===0?0:w}}return g}function Cu(e){return typeof e=="number"?e:pr(e)?k:+e}function fr(e){if(typeof e=="string")return e;if(_e(e))return nt(e,fr)+"";if(pr(e))return uu?uu.call(e):"";var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function yi(e,i,o){var u=-1,f=Is,g=e.length,w=!0,b=[],P=b;if(o)w=!1,f=Wo;else if(g>=s){var L=i?null:Qd(e);if(L)return Ps(L);w=!1,f=bn,P=new Ni}else P=i?[]:b;e:for(;++u<g;){var q=e[u],B=i?i(q):q;if(q=o||q!==0?q:0,w&&B===B){for(var J=P.length;J--;)if(P[J]===B)continue e;i&&P.push(B),b.push(q)}else f(P,B,o)||(P!==b&&P.push(B),b.push(q))}return b}function wa(e,i){return i=vi(i,e),e=sh(e,i),e==null||delete e[Hr(xr(i))]}function $u(e,i,o,u){return Cn(e,i,o(Fi(e,i)),u)}function Ks(e,i,o,u){for(var f=e.length,g=u?f:-1;(u?g--:++g<f)&&i(e[g],g,e););return o?Er(e,u?0:g,u?g+1:f):Er(e,u?g+1:0,u?f:g)}function Nu(e,i){var o=e;return o instanceof Oe&&(o=o.value()),Jo(i,function(u,f){return f.func.apply(f.thisArg,fi([u],f.args))},o)}function ba(e,i,o){var u=e.length;if(u<2)return u?yi(e[0]):[];for(var f=-1,g=T(u);++f<u;)for(var w=e[f],b=-1;++b<u;)b!=f&&(g[f]=Rn(g[f]||w,e[b],i,o));return yi(Ht(g,1),i,o)}function Du(e,i,o){for(var u=-1,f=e.length,g=i.length,w={};++u<f;){var b=u<g?i[u]:t;o(w,e[u],b)}return w}function Ea(e){return bt(e)?e:[]}function xa(e){return typeof e=="function"?e:or}function vi(e,i){return _e(e)?e:$a(e,i)?[e]:uh(Le(e))}var zd=Ie;function _i(e,i,o){var u=e.length;return o=o===t?u:o,!i&&o>=u?e:Er(e,i,o)}var Fu=Op||function(e){return Re.clearTimeout(e)};function ju(e,i){if(i)return e.slice();var o=e.length,u=iu?iu(o):new e.constructor(o);return e.copy(u),u}function Ia(e){var i=new e.constructor(e.byteLength);return new $s(i).set(new $s(e)),i}function Ud(e,i){var o=i?Ia(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Hd(e){var i=new e.constructor(e.source,yr.exec(e));return i.lastIndex=e.lastIndex,i}function Bd(e){return Pn?We(Pn.call(e)):{}}function Lu(e,i){var o=i?Ia(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function qu(e,i){if(e!==i){var o=e!==t,u=e===null,f=e===e,g=pr(e),w=i!==t,b=i===null,P=i===i,L=pr(i);if(!b&&!L&&!g&&e>i||g&&w&&P&&!b&&!L||u&&w&&P||!o&&P||!f)return 1;if(!u&&!g&&!L&&e<i||L&&o&&f&&!u&&!g||b&&o&&f||!w&&f||!P)return-1}return 0}function kd(e,i,o){for(var u=-1,f=e.criteria,g=i.criteria,w=f.length,b=o.length;++u<w;){var P=qu(f[u],g[u]);if(P){if(u>=b)return P;var L=o[u];return P*(L=="desc"?-1:1)}}return e.index-i.index}function Mu(e,i,o,u){for(var f=-1,g=e.length,w=o.length,b=-1,P=i.length,L=jt(g-w,0),q=T(P+L),B=!u;++b<P;)q[b]=i[b];for(;++f<w;)(B||f<g)&&(q[o[f]]=e[f]);for(;L--;)q[b++]=e[f++];return q}function zu(e,i,o,u){for(var f=-1,g=e.length,w=-1,b=o.length,P=-1,L=i.length,q=jt(g-b,0),B=T(q+L),J=!u;++f<q;)B[f]=e[f];for(var te=f;++P<L;)B[te+P]=i[P];for(;++w<b;)(J||f<g)&&(B[te+o[w]]=e[f++]);return B}function ir(e,i){var o=-1,u=e.length;for(i||(i=T(u));++o<u;)i[o]=e[o];return i}function Ur(e,i,o,u){var f=!o;o||(o={});for(var g=-1,w=i.length;++g<w;){var b=i[g],P=u?u(o[b],e[b],b,o,e):t;P===t&&(P=e[b]),f?Jr(o,b,P):On(o,b,P)}return o}function Vd(e,i){return Ur(e,Ca(e),i)}function Kd(e,i){return Ur(e,Zu(e),i)}function Gs(e,i){return function(o,u){var f=_e(o)?Yf:dd,g=i?i():{};return f(o,e,se(u,2),g)}}function sn(e){return Ie(function(i,o){var u=-1,f=o.length,g=f>1?o[f-1]:t,w=f>2?o[2]:t;for(g=e.length>3&&typeof g=="function"?(f--,g):t,w&&Yt(o[0],o[1],w)&&(g=f<3?t:g,f=1),i=We(i);++u<f;){var b=o[u];b&&e(i,b,u,g)}return i})}function Uu(e,i){return function(o,u){if(o==null)return o;if(!nr(o))return e(o,u);for(var f=o.length,g=i?f:-1,w=We(o);(i?g--:++g<f)&&u(w[g],g,w)!==!1;);return o}}function Hu(e){return function(i,o,u){for(var f=-1,g=We(i),w=u(i),b=w.length;b--;){var P=w[e?b:++f];if(o(g[P],P,g)===!1)break}return i}}function Gd(e,i,o){var u=i&ie,f=$n(e);function g(){var w=this&&this!==Re&&this instanceof g?f:e;return w.apply(u?o:this,arguments)}return g}function Bu(e){return function(i){i=Le(i);var o=Yi(i)?Ar(i):t,u=o?o[0]:i.charAt(0),f=o?_i(o,1).join(""):i.slice(1);return u[e]()+f}}function on(e){return function(i){return Jo(Uh(zh(i).replace(mn,"")),e,"")}}function $n(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=nn(e.prototype),u=e.apply(o,i);return ut(u)?u:o}}function Wd(e,i,o){var u=$n(e);function f(){for(var g=arguments.length,w=T(g),b=g,P=an(f);b--;)w[b]=arguments[b];var L=g<3&&w[0]!==P&&w[g-1]!==P?[]:pi(w,P);if(g-=L.length,g<o)return Wu(e,i,Ws,f.placeholder,t,w,L,t,t,o-g);var q=this&&this!==Re&&this instanceof f?u:e;return qt(q,this,w)}return f}function ku(e){return function(i,o,u){var f=We(i);if(!nr(i)){var g=se(o,3);i=Mt(i),o=function(b){return g(f[b],b,f)}}var w=e(i,o,u);return w>-1?f[g?i[w]:w]:t}}function Vu(e){return Yr(function(i){var o=i.length,u=o,f=wr.prototype.thru;for(e&&i.reverse();u--;){var g=i[u];if(typeof g!="function")throw new mr(l);if(f&&!w&&Xs(g)=="wrapper")var w=new wr([],!0)}for(u=w?u:o;++u<o;){g=i[u];var b=Xs(g),P=b=="wrapper"?Aa(g):t;P&&Na(P[0])&&P[1]==(U|pe|le|W)&&!P[4].length&&P[9]==1?w=w[Xs(P[0])].apply(w,P[3]):w=g.length==1&&Na(g)?w[b]():w.thru(g)}return function(){var L=arguments,q=L[0];if(w&&L.length==1&&_e(q))return w.plant(q).value();for(var B=0,J=o?i[B].apply(this,L):q;++B<o;)J=i[B].call(this,J);return J}})}function Ws(e,i,o,u,f,g,w,b,P,L){var q=i&U,B=i&ie,J=i&Ee,te=i&(pe|he),oe=i&ye,be=J?t:$n(e);function ae(){for(var Se=arguments.length,Ae=T(Se),dr=Se;dr--;)Ae[dr]=arguments[dr];if(te)var Xt=an(ae),gr=op(Ae,Xt);if(u&&(Ae=Mu(Ae,u,f,te)),g&&(Ae=zu(Ae,g,w,te)),Se-=gr,te&&Se<L){var Et=pi(Ae,Xt);return Wu(e,i,Ws,ae.placeholder,o,Ae,Et,b,P,L-Se)}var $r=B?o:this,ti=J?$r[e]:e;return Se=Ae.length,b?Ae=dg(Ae,b):oe&&Se>1&&Ae.reverse(),q&&P<Se&&(Ae.length=P),this&&this!==Re&&this instanceof ae&&(ti=be||$n(ti)),ti.apply($r,Ae)}return ae}function Ku(e,i){return function(o,u){return Ed(o,e,i(u),{})}}function Js(e,i){return function(o,u){var f;if(o===t&&u===t)return i;if(o!==t&&(f=o),u!==t){if(f===t)return u;typeof o=="string"||typeof u=="string"?(o=fr(o),u=fr(u)):(o=Cu(o),u=Cu(u)),f=e(o,u)}return f}}function Sa(e){return Yr(function(i){return i=nt(i,lr(se())),Ie(function(o){var u=this;return e(i,function(f){return qt(f,u,o)})})})}function Qs(e,i){i=i===t?" ":fr(i);var o=i.length;if(o<2)return o?_a(i,e):i;var u=_a(i,js(e/Xi(i)));return Yi(i)?_i(Ar(u),0,e).join(""):u.slice(0,e)}function Jd(e,i,o,u){var f=i&ie,g=$n(e);function w(){for(var b=-1,P=arguments.length,L=-1,q=u.length,B=T(q+P),J=this&&this!==Re&&this instanceof w?g:e;++L<q;)B[L]=u[L];for(;P--;)B[L++]=arguments[++b];return qt(J,f?o:this,B)}return w}function Gu(e){return function(i,o,u){return u&&typeof u!="number"&&Yt(i,o,u)&&(o=u=t),i=ei(i),o===t?(o=i,i=0):o=ei(o),u=u===t?i<o?1:-1:ei(u),Dd(i,o,u,e)}}function Ys(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Ir(i),o=Ir(o)),e(i,o)}}function Wu(e,i,o,u,f,g,w,b,P,L){var q=i&pe,B=q?w:t,J=q?t:w,te=q?g:t,oe=q?t:g;i|=q?le:N,i&=~(q?N:le),i&ge||(i&=~(ie|Ee));var be=[e,i,f,te,B,oe,J,b,P,L],ae=o.apply(t,be);return Na(e)&&oh(ae,be),ae.placeholder=u,ah(ae,e,i)}function Pa(e){var i=Ft[e];return function(o,u){if(o=Ir(o),u=u==null?0:kt(me(u),292),u&&au(o)){var f=(Le(o)+"e").split("e"),g=i(f[0]+"e"+(+f[1]+u));return f=(Le(g)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(o)}}var Qd=tn&&1/Ps(new tn([,-0]))[1]==ce?function(e){return new tn(e)}:Wa;function Ju(e){return function(i){var o=Vt(i);return o==we?ra(i):o==je?pp(i):sp(i,e(i))}}function Qr(e,i,o,u,f,g,w,b){var P=i&Ee;if(!P&&typeof e!="function")throw new mr(l);var L=u?u.length:0;if(L||(i&=~(le|N),u=f=t),w=w===t?w:jt(me(w),0),b=b===t?b:me(b),L-=f?f.length:0,i&N){var q=u,B=f;u=f=t}var J=P?t:Aa(e),te=[e,i,o,u,f,q,B,g,w,b];if(J&&lg(te,J),e=te[0],i=te[1],o=te[2],u=te[3],f=te[4],b=te[9]=te[9]===t?P?0:e.length:jt(te[9]-L,0),!b&&i&(pe|he)&&(i&=~(pe|he)),!i||i==ie)var oe=Gd(e,i,o);else i==pe||i==he?oe=Wd(e,i,b):(i==le||i==(ie|le))&&!f.length?oe=Jd(e,i,o,u):oe=Ws.apply(t,te);var be=J?Au:oh;return ah(be(oe,te),e,i)}function Qu(e,i,o,u){return e===t||Cr(e,en[o])&&!Me.call(u,o)?i:e}function Yu(e,i,o,u,f,g){return ut(e)&&ut(i)&&(g.set(i,e),ks(e,i,t,Yu,g),g.delete(i)),e}function Yd(e){return Fn(e)?t:e}function Xu(e,i,o,u,f,g){var w=o&F,b=e.length,P=i.length;if(b!=P&&!(w&&P>b))return!1;var L=g.get(e),q=g.get(i);if(L&&q)return L==i&&q==e;var B=-1,J=!0,te=o&K?new Ni:t;for(g.set(e,i),g.set(i,e);++B<b;){var oe=e[B],be=i[B];if(u)var ae=w?u(be,oe,B,i,e,g):u(oe,be,B,e,i,g);if(ae!==t){if(ae)continue;J=!1;break}if(te){if(!Qo(i,function(Se,Ae){if(!bn(te,Ae)&&(oe===Se||f(oe,Se,o,u,g)))return te.push(Ae)})){J=!1;break}}else if(!(oe===be||f(oe,be,o,u,g))){J=!1;break}}return g.delete(e),g.delete(i),J}function Xd(e,i,o,u,f,g,w){switch(o){case ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ne:return!(e.byteLength!=i.byteLength||!g(new $s(e),new $s(i)));case C:case R:case $e:return Cr(+e,+i);case E:return e.name==i.name&&e.message==i.message;case ot:case Ye:return e==i+"";case we:var b=ra;case je:var P=u&F;if(b||(b=Ps),e.size!=i.size&&!P)return!1;var L=w.get(e);if(L)return L==i;u|=K,w.set(e,i);var q=Xu(b(e),b(i),u,f,g,w);return w.delete(e),q;case Xe:if(Pn)return Pn.call(e)==Pn.call(i)}return!1}function Zd(e,i,o,u,f,g){var w=o&F,b=Oa(e),P=b.length,L=Oa(i),q=L.length;if(P!=q&&!w)return!1;for(var B=P;B--;){var J=b[B];if(!(w?J in i:Me.call(i,J)))return!1}var te=g.get(e),oe=g.get(i);if(te&&oe)return te==i&&oe==e;var be=!0;g.set(e,i),g.set(i,e);for(var ae=w;++B<P;){J=b[B];var Se=e[J],Ae=i[J];if(u)var dr=w?u(Ae,Se,J,i,e,g):u(Se,Ae,J,e,i,g);if(!(dr===t?Se===Ae||f(Se,Ae,o,u,g):dr)){be=!1;break}ae||(ae=J=="constructor")}if(be&&!ae){var Xt=e.constructor,gr=i.constructor;Xt!=gr&&"constructor"in e&&"constructor"in i&&!(typeof Xt=="function"&&Xt instanceof Xt&&typeof gr=="function"&&gr instanceof gr)&&(be=!1)}return g.delete(e),g.delete(i),be}function Yr(e){return Fa(nh(e,t,ph),e+"")}function Oa(e){return _u(e,Mt,Ca)}function Ra(e){return _u(e,sr,Zu)}var Aa=qs?function(e){return qs.get(e)}:Wa;function Xs(e){for(var i=e.name+"",o=rn[i],u=Me.call(rn,i)?o.length:0;u--;){var f=o[u],g=f.func;if(g==null||g==e)return f.name}return i}function an(e){var i=Me.call(d,"placeholder")?d:e;return i.placeholder}function se(){var e=d.iteratee||Ka;return e=e===Ka?bu:e,arguments.length?e(arguments[0],arguments[1]):e}function Zs(e,i){var o=e.__data__;return ag(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Ta(e){for(var i=Mt(e),o=i.length;o--;){var u=i[o],f=e[u];i[o]=[u,f,rh(f)]}return i}function ji(e,i){var o=hp(e,i);return wu(o)?o:t}function eg(e){var i=Me.call(e,Ci),o=e[Ci];try{e[Ci]=t;var u=!0}catch{}var f=Ts.call(e);return u&&(i?e[Ci]=o:delete e[Ci]),f}var Ca=na?function(e){return e==null?[]:(e=We(e),li(na(e),function(i){return su.call(e,i)}))}:Ja,Zu=na?function(e){for(var i=[];e;)fi(i,Ca(e)),e=Ns(e);return i}:Ja,Vt=Qt;(sa&&Vt(new sa(new ArrayBuffer(1)))!=ke||xn&&Vt(new xn)!=we||oa&&Vt(oa.resolve())!=It||tn&&Vt(new tn)!=je||In&&Vt(new In)!=Ue)&&(Vt=function(e){var i=Qt(e),o=i==Pe?e.constructor:t,u=o?Li(o):"";if(u)switch(u){case jp:return ke;case Lp:return we;case qp:return It;case Mp:return je;case zp:return Ue}return i});function tg(e,i,o){for(var u=-1,f=o.length;++u<f;){var g=o[u],w=g.size;switch(g.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=kt(i,e+w);break;case"takeRight":e=jt(e,i-w);break}}return{start:e,end:i}}function rg(e){var i=e.match(Qe);return i?i[1].split(At):[]}function eh(e,i,o){i=vi(i,e);for(var u=-1,f=i.length,g=!1;++u<f;){var w=Hr(i[u]);if(!(g=e!=null&&o(e,w)))break;e=e[w]}return g||++u!=f?g:(f=e==null?0:e.length,!!f&&oo(f)&&Xr(w,f)&&(_e(e)||qi(e)))}function ig(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&Me.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function th(e){return typeof e.constructor=="function"&&!Nn(e)?nn(Ns(e)):{}}function ng(e,i,o){var u=e.constructor;switch(i){case Ne:return Ia(e);case C:case R:return new u(+e);case ke:return Ud(e,o);case ht:case qe:case St:case Dt:case zt:case Ut:case Lt:case Gt:case tr:return Lu(e,o);case we:return new u;case $e:case Ye:return new u(e);case ot:return Hd(e);case je:return new u;case Xe:return Bd(e)}}function sg(e,i){var o=i.length;if(!o)return e;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function og(e){return _e(e)||qi(e)||!!(ou&&e&&e[ou])}function Xr(e,i){var o=typeof e;return i=i??V,!!i&&(o=="number"||o!="symbol"&&Do.test(e))&&e>-1&&e%1==0&&e<i}function Yt(e,i,o){if(!ut(o))return!1;var u=typeof i;return(u=="number"?nr(o)&&Xr(i,o.length):u=="string"&&i in o)?Cr(o[i],e):!1}function $a(e,i){if(_e(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||pr(e)?!0:Pt.test(e)||!it.test(e)||i!=null&&e in We(i)}function ag(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Na(e){var i=Xs(e),o=d[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var u=Aa(o);return!!u&&e===u[0]}function cg(e){return!!ru&&ru in e}var ug=Rs?Zr:Qa;function Nn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||en;return e===o}function rh(e){return e===e&&!ut(e)}function ih(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==t||e in We(o))}}function hg(e){var i=no(e,function(u){return o.size===y&&o.clear(),u}),o=i.cache;return i}function lg(e,i){var o=e[1],u=i[1],f=o|u,g=f<(ie|Ee|U),w=u==U&&o==pe||u==U&&o==W&&e[7].length<=i[8]||u==(U|W)&&i[7].length<=i[8]&&o==pe;if(!(g||w))return e;u&ie&&(e[2]=i[2],f|=o&ie?0:ge);var b=i[3];if(b){var P=e[3];e[3]=P?Mu(P,b,i[4]):b,e[4]=P?pi(e[3],O):i[4]}return b=i[5],b&&(P=e[5],e[5]=P?zu(P,b,i[6]):b,e[6]=P?pi(e[5],O):i[6]),b=i[7],b&&(e[7]=b),u&U&&(e[8]=e[8]==null?i[8]:kt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function fg(e){var i=[];if(e!=null)for(var o in We(e))i.push(o);return i}function pg(e){return Ts.call(e)}function nh(e,i,o){return i=jt(i===t?e.length-1:i,0),function(){for(var u=arguments,f=-1,g=jt(u.length-i,0),w=T(g);++f<g;)w[f]=u[i+f];f=-1;for(var b=T(i+1);++f<i;)b[f]=u[f];return b[i]=o(w),qt(e,this,b)}}function sh(e,i){return i.length<2?e:Fi(e,Er(i,0,-1))}function dg(e,i){for(var o=e.length,u=kt(i.length,o),f=ir(e);u--;){var g=i[u];e[u]=Xr(g,o)?f[g]:t}return e}function Da(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var oh=ch(Au),Dn=Ap||function(e,i){return Re.setTimeout(e,i)},Fa=ch(Ld);function ah(e,i,o){var u=i+"";return Fa(e,sg(u,gg(rg(u),o)))}function ch(e){var i=0,o=0;return function(){var u=Np(),f=ze-(u-o);if(o=u,f>0){if(++i>=Ce)return arguments[0]}else i=0;return e.apply(t,arguments)}}function eo(e,i){var o=-1,u=e.length,f=u-1;for(i=i===t?u:i;++o<i;){var g=va(o,f),w=e[g];e[g]=e[o],e[o]=w}return e.length=i,e}var uh=hg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ot,function(o,u,f,g){i.push(f?g.replace(Ro,"$1"):u||o)}),i});function Hr(e){if(typeof e=="string"||pr(e))return e;var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function Li(e){if(e!=null){try{return As.call(e)}catch{}try{return e+""}catch{}}return""}function gg(e,i){return _r(jr,function(o){var u="_."+o[0];i&o[1]&&!Is(e,u)&&e.push(u)}),e.sort()}function hh(e){if(e instanceof Oe)return e.clone();var i=new wr(e.__wrapped__,e.__chain__);return i.__actions__=ir(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function yg(e,i,o){(o?Yt(e,i,o):i===t)?i=1:i=jt(me(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,g=0,w=T(js(u/i));f<u;)w[g++]=Er(e,f,f+=i);return w}function vg(e){for(var i=-1,o=e==null?0:e.length,u=0,f=[];++i<o;){var g=e[i];g&&(f[u++]=g)}return f}function _g(){var e=arguments.length;if(!e)return[];for(var i=T(e-1),o=arguments[0],u=e;u--;)i[u-1]=arguments[u];return fi(_e(o)?ir(o):[o],Ht(i,1))}var mg=Ie(function(e,i){return bt(e)?Rn(e,Ht(i,1,bt,!0)):[]}),wg=Ie(function(e,i){var o=xr(i);return bt(o)&&(o=t),bt(e)?Rn(e,Ht(i,1,bt,!0),se(o,2)):[]}),bg=Ie(function(e,i){var o=xr(i);return bt(o)&&(o=t),bt(e)?Rn(e,Ht(i,1,bt,!0),t,o):[]});function Eg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),Er(e,i<0?0:i,u)):[]}function xg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),i=u-i,Er(e,0,i<0?0:i)):[]}function Ig(e,i){return e&&e.length?Ks(e,se(i,3),!0,!0):[]}function Sg(e,i){return e&&e.length?Ks(e,se(i,3),!0):[]}function Pg(e,i,o,u){var f=e==null?0:e.length;return f?(o&&typeof o!="number"&&Yt(e,i,o)&&(o=0,u=f),_d(e,i,o,u)):[]}function lh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:me(o);return f<0&&(f=jt(u+f,0)),Ss(e,se(i,3),f)}function fh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return o!==t&&(f=me(o),f=o<0?jt(u+f,0):kt(f,u-1)),Ss(e,se(i,3),f,!0)}function ph(e){var i=e==null?0:e.length;return i?Ht(e,1):[]}function Og(e){var i=e==null?0:e.length;return i?Ht(e,ce):[]}function Rg(e,i){var o=e==null?0:e.length;return o?(i=i===t?1:me(i),Ht(e,i)):[]}function Ag(e){for(var i=-1,o=e==null?0:e.length,u={};++i<o;){var f=e[i];u[f[0]]=f[1]}return u}function dh(e){return e&&e.length?e[0]:t}function Tg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:me(o);return f<0&&(f=jt(u+f,0)),Qi(e,i,f)}function Cg(e){var i=e==null?0:e.length;return i?Er(e,0,-1):[]}var $g=Ie(function(e){var i=nt(e,Ea);return i.length&&i[0]===e[0]?fa(i):[]}),Ng=Ie(function(e){var i=xr(e),o=nt(e,Ea);return i===xr(o)?i=t:o.pop(),o.length&&o[0]===e[0]?fa(o,se(i,2)):[]}),Dg=Ie(function(e){var i=xr(e),o=nt(e,Ea);return i=typeof i=="function"?i:t,i&&o.pop(),o.length&&o[0]===e[0]?fa(o,t,i):[]});function Fg(e,i){return e==null?"":Cp.call(e,i)}function xr(e){var i=e==null?0:e.length;return i?e[i-1]:t}function jg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u;return o!==t&&(f=me(o),f=f<0?jt(u+f,0):kt(f,u-1)),i===i?gp(e,i,f):Ss(e,Wc,f,!0)}function Lg(e,i){return e&&e.length?Su(e,me(i)):t}var qg=Ie(gh);function gh(e,i){return e&&e.length&&i&&i.length?ya(e,i):e}function Mg(e,i,o){return e&&e.length&&i&&i.length?ya(e,i,se(o,2)):e}function zg(e,i,o){return e&&e.length&&i&&i.length?ya(e,i,t,o):e}var Ug=Yr(function(e,i){var o=e==null?0:e.length,u=ca(e,i);return Ru(e,nt(i,function(f){return Xr(f,o)?+f:f}).sort(qu)),u});function Hg(e,i){var o=[];if(!(e&&e.length))return o;var u=-1,f=[],g=e.length;for(i=se(i,3);++u<g;){var w=e[u];i(w,u,e)&&(o.push(w),f.push(u))}return Ru(e,f),o}function ja(e){return e==null?e:Fp.call(e)}function Bg(e,i,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&Yt(e,i,o)?(i=0,o=u):(i=i==null?0:me(i),o=o===t?u:me(o)),Er(e,i,o)):[]}function kg(e,i){return Vs(e,i)}function Vg(e,i,o){return ma(e,i,se(o,2))}function Kg(e,i){var o=e==null?0:e.length;if(o){var u=Vs(e,i);if(u<o&&Cr(e[u],i))return u}return-1}function Gg(e,i){return Vs(e,i,!0)}function Wg(e,i,o){return ma(e,i,se(o,2),!0)}function Jg(e,i){var o=e==null?0:e.length;if(o){var u=Vs(e,i,!0)-1;if(Cr(e[u],i))return u}return-1}function Qg(e){return e&&e.length?Tu(e):[]}function Yg(e,i){return e&&e.length?Tu(e,se(i,2)):[]}function Xg(e){var i=e==null?0:e.length;return i?Er(e,1,i):[]}function Zg(e,i,o){return e&&e.length?(i=o||i===t?1:me(i),Er(e,0,i<0?0:i)):[]}function ey(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),i=u-i,Er(e,i<0?0:i,u)):[]}function ty(e,i){return e&&e.length?Ks(e,se(i,3),!1,!0):[]}function ry(e,i){return e&&e.length?Ks(e,se(i,3)):[]}var iy=Ie(function(e){return yi(Ht(e,1,bt,!0))}),ny=Ie(function(e){var i=xr(e);return bt(i)&&(i=t),yi(Ht(e,1,bt,!0),se(i,2))}),sy=Ie(function(e){var i=xr(e);return i=typeof i=="function"?i:t,yi(Ht(e,1,bt,!0),t,i)});function oy(e){return e&&e.length?yi(e):[]}function ay(e,i){return e&&e.length?yi(e,se(i,2)):[]}function cy(e,i){return i=typeof i=="function"?i:t,e&&e.length?yi(e,t,i):[]}function La(e){if(!(e&&e.length))return[];var i=0;return e=li(e,function(o){if(bt(o))return i=jt(o.length,i),!0}),ea(i,function(o){return nt(e,Yo(o))})}function yh(e,i){if(!(e&&e.length))return[];var o=La(e);return i==null?o:nt(o,function(u){return qt(i,t,u)})}var uy=Ie(function(e,i){return bt(e)?Rn(e,i):[]}),hy=Ie(function(e){return ba(li(e,bt))}),ly=Ie(function(e){var i=xr(e);return bt(i)&&(i=t),ba(li(e,bt),se(i,2))}),fy=Ie(function(e){var i=xr(e);return i=typeof i=="function"?i:t,ba(li(e,bt),t,i)}),py=Ie(La);function dy(e,i){return Du(e||[],i||[],On)}function gy(e,i){return Du(e||[],i||[],Cn)}var yy=Ie(function(e){var i=e.length,o=i>1?e[i-1]:t;return o=typeof o=="function"?(e.pop(),o):t,yh(e,o)});function vh(e){var i=d(e);return i.__chain__=!0,i}function vy(e,i){return i(e),e}function to(e,i){return i(e)}var _y=Yr(function(e){var i=e.length,o=i?e[0]:0,u=this.__wrapped__,f=function(g){return ca(g,e)};return i>1||this.__actions__.length||!(u instanceof Oe)||!Xr(o)?this.thru(f):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:to,args:[f],thisArg:t}),new wr(u,this.__chain__).thru(function(g){return i&&!g.length&&g.push(t),g}))});function my(){return vh(this)}function wy(){return new wr(this.value(),this.__chain__)}function by(){this.__values__===t&&(this.__values__=Ch(this.value()));var e=this.__index__>=this.__values__.length,i=e?t:this.__values__[this.__index__++];return{done:e,value:i}}function Ey(){return this}function xy(e){for(var i,o=this;o instanceof zs;){var u=hh(o);u.__index__=0,u.__values__=t,i?f.__wrapped__=u:i=u;var f=u;o=o.__wrapped__}return f.__wrapped__=e,i}function Iy(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:to,args:[ja],thisArg:t}),new wr(i,this.__chain__)}return this.thru(ja)}function Sy(){return Nu(this.__wrapped__,this.__actions__)}var Py=Gs(function(e,i,o){Me.call(e,o)?++e[o]:Jr(e,o,1)});function Oy(e,i,o){var u=_e(e)?Kc:vd;return o&&Yt(e,i,o)&&(i=t),u(e,se(i,3))}function Ry(e,i){var o=_e(e)?li:yu;return o(e,se(i,3))}var Ay=ku(lh),Ty=ku(fh);function Cy(e,i){return Ht(ro(e,i),1)}function $y(e,i){return Ht(ro(e,i),ce)}function Ny(e,i,o){return o=o===t?1:me(o),Ht(ro(e,i),o)}function _h(e,i){var o=_e(e)?_r:gi;return o(e,se(i,3))}function mh(e,i){var o=_e(e)?Xf:gu;return o(e,se(i,3))}var Dy=Gs(function(e,i,o){Me.call(e,o)?e[o].push(i):Jr(e,o,[i])});function Fy(e,i,o,u){e=nr(e)?e:un(e),o=o&&!u?me(o):0;var f=e.length;return o<0&&(o=jt(f+o,0)),ao(e)?o<=f&&e.indexOf(i,o)>-1:!!f&&Qi(e,i,o)>-1}var jy=Ie(function(e,i,o){var u=-1,f=typeof i=="function",g=nr(e)?T(e.length):[];return gi(e,function(w){g[++u]=f?qt(i,w,o):An(w,i,o)}),g}),Ly=Gs(function(e,i,o){Jr(e,o,i)});function ro(e,i){var o=_e(e)?nt:Eu;return o(e,se(i,3))}function qy(e,i,o,u){return e==null?[]:(_e(i)||(i=i==null?[]:[i]),o=u?t:o,_e(o)||(o=o==null?[]:[o]),Pu(e,i,o))}var My=Gs(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function zy(e,i,o){var u=_e(e)?Jo:Qc,f=arguments.length<3;return u(e,se(i,4),o,f,gi)}function Uy(e,i,o){var u=_e(e)?Zf:Qc,f=arguments.length<3;return u(e,se(i,4),o,f,gu)}function Hy(e,i){var o=_e(e)?li:yu;return o(e,so(se(i,3)))}function By(e){var i=_e(e)?lu:Fd;return i(e)}function ky(e,i,o){(o?Yt(e,i,o):i===t)?i=1:i=me(i);var u=_e(e)?fd:jd;return u(e,i)}function Vy(e){var i=_e(e)?pd:qd;return i(e)}function Ky(e){if(e==null)return 0;if(nr(e))return ao(e)?Xi(e):e.length;var i=Vt(e);return i==we||i==je?e.size:da(e).length}function Gy(e,i,o){var u=_e(e)?Qo:Md;return o&&Yt(e,i,o)&&(i=t),u(e,se(i,3))}var Wy=Ie(function(e,i){if(e==null)return[];var o=i.length;return o>1&&Yt(e,i[0],i[1])?i=[]:o>2&&Yt(i[0],i[1],i[2])&&(i=[i[0]]),Pu(e,Ht(i,1),[])}),io=Rp||function(){return Re.Date.now()};function Jy(e,i){if(typeof i!="function")throw new mr(l);return e=me(e),function(){if(--e<1)return i.apply(this,arguments)}}function wh(e,i,o){return i=o?t:i,i=e&&i==null?e.length:i,Qr(e,U,t,t,t,t,i)}function bh(e,i){var o;if(typeof i!="function")throw new mr(l);return e=me(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=t),o}}var qa=Ie(function(e,i,o){var u=ie;if(o.length){var f=pi(o,an(qa));u|=le}return Qr(e,u,i,o,f)}),Eh=Ie(function(e,i,o){var u=ie|Ee;if(o.length){var f=pi(o,an(Eh));u|=le}return Qr(i,u,e,o,f)});function xh(e,i,o){i=o?t:i;var u=Qr(e,pe,t,t,t,t,t,i);return u.placeholder=xh.placeholder,u}function Ih(e,i,o){i=o?t:i;var u=Qr(e,he,t,t,t,t,t,i);return u.placeholder=Ih.placeholder,u}function Sh(e,i,o){var u,f,g,w,b,P,L=0,q=!1,B=!1,J=!0;if(typeof e!="function")throw new mr(l);i=Ir(i)||0,ut(o)&&(q=!!o.leading,B="maxWait"in o,g=B?jt(Ir(o.maxWait)||0,i):g,J="trailing"in o?!!o.trailing:J);function te(Et){var $r=u,ti=f;return u=f=t,L=Et,w=e.apply(ti,$r),w}function oe(Et){return L=Et,b=Dn(Se,i),q?te(Et):w}function be(Et){var $r=Et-P,ti=Et-L,kh=i-$r;return B?kt(kh,g-ti):kh}function ae(Et){var $r=Et-P,ti=Et-L;return P===t||$r>=i||$r<0||B&&ti>=g}function Se(){var Et=io();if(ae(Et))return Ae(Et);b=Dn(Se,be(Et))}function Ae(Et){return b=t,J&&u?te(Et):(u=f=t,w)}function dr(){b!==t&&Fu(b),L=0,u=P=f=b=t}function Xt(){return b===t?w:Ae(io())}function gr(){var Et=io(),$r=ae(Et);if(u=arguments,f=this,P=Et,$r){if(b===t)return oe(P);if(B)return Fu(b),b=Dn(Se,i),te(P)}return b===t&&(b=Dn(Se,i)),w}return gr.cancel=dr,gr.flush=Xt,gr}var Qy=Ie(function(e,i){return du(e,1,i)}),Yy=Ie(function(e,i,o){return du(e,Ir(i)||0,o)});function Xy(e){return Qr(e,ye)}function no(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new mr(l);var o=function(){var u=arguments,f=i?i.apply(this,u):u[0],g=o.cache;if(g.has(f))return g.get(f);var w=e.apply(this,u);return o.cache=g.set(f,w)||g,w};return o.cache=new(no.Cache||Wr),o}no.Cache=Wr;function so(e){if(typeof e!="function")throw new mr(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Zy(e){return bh(2,e)}var ev=zd(function(e,i){i=i.length==1&&_e(i[0])?nt(i[0],lr(se())):nt(Ht(i,1),lr(se()));var o=i.length;return Ie(function(u){for(var f=-1,g=kt(u.length,o);++f<g;)u[f]=i[f].call(this,u[f]);return qt(e,this,u)})}),Ma=Ie(function(e,i){var o=pi(i,an(Ma));return Qr(e,le,t,i,o)}),Ph=Ie(function(e,i){var o=pi(i,an(Ph));return Qr(e,N,t,i,o)}),tv=Yr(function(e,i){return Qr(e,W,t,t,t,i)});function rv(e,i){if(typeof e!="function")throw new mr(l);return i=i===t?i:me(i),Ie(e,i)}function iv(e,i){if(typeof e!="function")throw new mr(l);return i=i==null?0:jt(me(i),0),Ie(function(o){var u=o[i],f=_i(o,0,i);return u&&fi(f,u),qt(e,this,f)})}function nv(e,i,o){var u=!0,f=!0;if(typeof e!="function")throw new mr(l);return ut(o)&&(u="leading"in o?!!o.leading:u,f="trailing"in o?!!o.trailing:f),Sh(e,i,{leading:u,maxWait:i,trailing:f})}function sv(e){return wh(e,1)}function ov(e,i){return Ma(xa(i),e)}function av(){if(!arguments.length)return[];var e=arguments[0];return _e(e)?e:[e]}function cv(e){return br(e,M)}function uv(e,i){return i=typeof i=="function"?i:t,br(e,M,i)}function hv(e){return br(e,j|M)}function lv(e,i){return i=typeof i=="function"?i:t,br(e,j|M,i)}function fv(e,i){return i==null||pu(e,i,Mt(i))}function Cr(e,i){return e===i||e!==e&&i!==i}var pv=Ys(la),dv=Ys(function(e,i){return e>=i}),qi=mu(function(){return arguments}())?mu:function(e){return vt(e)&&Me.call(e,"callee")&&!su.call(e,"callee")},_e=T.isArray,gv=Jt?lr(Jt):xd;function nr(e){return e!=null&&oo(e.length)&&!Zr(e)}function bt(e){return vt(e)&&nr(e)}function yv(e){return e===!0||e===!1||vt(e)&&Qt(e)==C}var mi=Tp||Qa,vv=Rr?lr(Rr):Id;function _v(e){return vt(e)&&e.nodeType===1&&!Fn(e)}function mv(e){if(e==null)return!0;if(nr(e)&&(_e(e)||typeof e=="string"||typeof e.splice=="function"||mi(e)||cn(e)||qi(e)))return!e.length;var i=Vt(e);if(i==we||i==je)return!e.size;if(Nn(e))return!da(e).length;for(var o in e)if(Me.call(e,o))return!1;return!0}function wv(e,i){return Tn(e,i)}function bv(e,i,o){o=typeof o=="function"?o:t;var u=o?o(e,i):t;return u===t?Tn(e,i,t,o):!!u}function za(e){if(!vt(e))return!1;var i=Qt(e);return i==E||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Fn(e)}function Ev(e){return typeof e=="number"&&au(e)}function Zr(e){if(!ut(e))return!1;var i=Qt(e);return i==ee||i==fe||i==$||i==_t}function Oh(e){return typeof e=="number"&&e==me(e)}function oo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function ut(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function vt(e){return e!=null&&typeof e=="object"}var Rh=vr?lr(vr):Pd;function xv(e,i){return e===i||pa(e,i,Ta(i))}function Iv(e,i,o){return o=typeof o=="function"?o:t,pa(e,i,Ta(i),o)}function Sv(e){return Ah(e)&&e!=+e}function Pv(e){if(ug(e))throw new de(c);return wu(e)}function Ov(e){return e===null}function Rv(e){return e==null}function Ah(e){return typeof e=="number"||vt(e)&&Qt(e)==$e}function Fn(e){if(!vt(e)||Qt(e)!=Pe)return!1;var i=Ns(e);if(i===null)return!0;var o=Me.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&As.call(o)==Ip}var Ua=Mr?lr(Mr):Od;function Av(e){return Oh(e)&&e>=-V&&e<=V}var Th=wn?lr(wn):Rd;function ao(e){return typeof e=="string"||!_e(e)&&vt(e)&&Qt(e)==Ye}function pr(e){return typeof e=="symbol"||vt(e)&&Qt(e)==Xe}var cn=Ti?lr(Ti):Ad;function Tv(e){return e===t}function Cv(e){return vt(e)&&Vt(e)==Ue}function $v(e){return vt(e)&&Qt(e)==Ze}var Nv=Ys(ga),Dv=Ys(function(e,i){return e<=i});function Ch(e){if(!e)return[];if(nr(e))return ao(e)?Ar(e):ir(e);if(En&&e[En])return fp(e[En]());var i=Vt(e),o=i==we?ra:i==je?Ps:un;return o(e)}function ei(e){if(!e)return e===0?e:0;if(e=Ir(e),e===ce||e===-ce){var i=e<0?-1:1;return i*H}return e===e?e:0}function me(e){var i=ei(e),o=i%1;return i===i?o?i-o:i:0}function $h(e){return e?Di(me(e),0,G):0}function Ir(e){if(typeof e=="number")return e;if(pr(e))return k;if(ut(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ut(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Yc(e);var o=Co.test(e);return o||No.test(e)?ve(e.slice(2),o?2:8):To.test(e)?k:+e}function Nh(e){return Ur(e,sr(e))}function Fv(e){return e?Di(me(e),-V,V):e===0?e:0}function Le(e){return e==null?"":fr(e)}var jv=sn(function(e,i){if(Nn(i)||nr(i)){Ur(i,Mt(i),e);return}for(var o in i)Me.call(i,o)&&On(e,o,i[o])}),Dh=sn(function(e,i){Ur(i,sr(i),e)}),co=sn(function(e,i,o,u){Ur(i,sr(i),e,u)}),Lv=sn(function(e,i,o,u){Ur(i,Mt(i),e,u)}),qv=Yr(ca);function Mv(e,i){var o=nn(e);return i==null?o:fu(o,i)}var zv=Ie(function(e,i){e=We(e);var o=-1,u=i.length,f=u>2?i[2]:t;for(f&&Yt(i[0],i[1],f)&&(u=1);++o<u;)for(var g=i[o],w=sr(g),b=-1,P=w.length;++b<P;){var L=w[b],q=e[L];(q===t||Cr(q,en[L])&&!Me.call(e,L))&&(e[L]=g[L])}return e}),Uv=Ie(function(e){return e.push(t,Yu),qt(Fh,t,e)});function Hv(e,i){return Gc(e,se(i,3),zr)}function Bv(e,i){return Gc(e,se(i,3),ha)}function kv(e,i){return e==null?e:ua(e,se(i,3),sr)}function Vv(e,i){return e==null?e:vu(e,se(i,3),sr)}function Kv(e,i){return e&&zr(e,se(i,3))}function Gv(e,i){return e&&ha(e,se(i,3))}function Wv(e){return e==null?[]:Bs(e,Mt(e))}function Jv(e){return e==null?[]:Bs(e,sr(e))}function Ha(e,i,o){var u=e==null?t:Fi(e,i);return u===t?o:u}function Qv(e,i){return e!=null&&eh(e,i,md)}function Ba(e,i){return e!=null&&eh(e,i,wd)}var Yv=Ku(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Ts.call(i)),e[i]=o},Va(or)),Xv=Ku(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Ts.call(i)),Me.call(e,i)?e[i].push(o):e[i]=[o]},se),Zv=Ie(An);function Mt(e){return nr(e)?hu(e):da(e)}function sr(e){return nr(e)?hu(e,!0):Td(e)}function e0(e,i){var o={};return i=se(i,3),zr(e,function(u,f,g){Jr(o,i(u,f,g),u)}),o}function t0(e,i){var o={};return i=se(i,3),zr(e,function(u,f,g){Jr(o,f,i(u,f,g))}),o}var r0=sn(function(e,i,o){ks(e,i,o)}),Fh=sn(function(e,i,o,u){ks(e,i,o,u)}),i0=Yr(function(e,i){var o={};if(e==null)return o;var u=!1;i=nt(i,function(g){return g=vi(g,e),u||(u=g.length>1),g}),Ur(e,Ra(e),o),u&&(o=br(o,j|A|M,Yd));for(var f=i.length;f--;)wa(o,i[f]);return o});function n0(e,i){return jh(e,so(se(i)))}var s0=Yr(function(e,i){return e==null?{}:$d(e,i)});function jh(e,i){if(e==null)return{};var o=nt(Ra(e),function(u){return[u]});return i=se(i),Ou(e,o,function(u,f){return i(u,f[0])})}function o0(e,i,o){i=vi(i,e);var u=-1,f=i.length;for(f||(f=1,e=t);++u<f;){var g=e==null?t:e[Hr(i[u])];g===t&&(u=f,g=o),e=Zr(g)?g.call(e):g}return e}function a0(e,i,o){return e==null?e:Cn(e,i,o)}function c0(e,i,o,u){return u=typeof u=="function"?u:t,e==null?e:Cn(e,i,o,u)}var Lh=Ju(Mt),qh=Ju(sr);function u0(e,i,o){var u=_e(e),f=u||mi(e)||cn(e);if(i=se(i,4),o==null){var g=e&&e.constructor;f?o=u?new g:[]:ut(e)?o=Zr(g)?nn(Ns(e)):{}:o={}}return(f?_r:zr)(e,function(w,b,P){return i(o,w,b,P)}),o}function h0(e,i){return e==null?!0:wa(e,i)}function l0(e,i,o){return e==null?e:$u(e,i,xa(o))}function f0(e,i,o,u){return u=typeof u=="function"?u:t,e==null?e:$u(e,i,xa(o),u)}function un(e){return e==null?[]:ta(e,Mt(e))}function p0(e){return e==null?[]:ta(e,sr(e))}function d0(e,i,o){return o===t&&(o=i,i=t),o!==t&&(o=Ir(o),o=o===o?o:0),i!==t&&(i=Ir(i),i=i===i?i:0),Di(Ir(e),i,o)}function g0(e,i,o){return i=ei(i),o===t?(o=i,i=0):o=ei(o),e=Ir(e),bd(e,i,o)}function y0(e,i,o){if(o&&typeof o!="boolean"&&Yt(e,i,o)&&(i=o=t),o===t&&(typeof i=="boolean"?(o=i,i=t):typeof e=="boolean"&&(o=e,e=t)),e===t&&i===t?(e=0,i=1):(e=ei(e),i===t?(i=e,e=0):i=ei(i)),e>i){var u=e;e=i,i=u}if(o||e%1||i%1){var f=cu();return kt(e+f*(i-e+Ke("1e-"+((f+"").length-1))),i)}return va(e,i)}var v0=on(function(e,i,o){return i=i.toLowerCase(),e+(o?Mh(i):i)});function Mh(e){return ka(Le(e).toLowerCase())}function zh(e){return e=Le(e),e&&e.replace(Vr,ap).replace(Ko,"")}function _0(e,i,o){e=Le(e),i=fr(i);var u=e.length;o=o===t?u:Di(me(o),0,u);var f=o;return o-=i.length,o>=0&&e.slice(o,f)==i}function m0(e){return e=Le(e),e&&rt.test(e)?e.replace(Si,cp):e}function w0(e){return e=Le(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var b0=on(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),E0=on(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),x0=Bu("toLowerCase");function I0(e,i,o){e=Le(e),i=me(i);var u=i?Xi(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return Qs(Ls(f),o)+e+Qs(js(f),o)}function S0(e,i,o){e=Le(e),i=me(i);var u=i?Xi(e):0;return i&&u<i?e+Qs(i-u,o):e}function P0(e,i,o){e=Le(e),i=me(i);var u=i?Xi(e):0;return i&&u<i?Qs(i-u,o)+e:e}function O0(e,i,o){return o||i==null?i=0:i&&(i=+i),Dp(Le(e).replace(gt,""),i||0)}function R0(e,i,o){return(o?Yt(e,i,o):i===t)?i=1:i=me(i),_a(Le(e),i)}function A0(){var e=arguments,i=Le(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var T0=on(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function C0(e,i,o){return o&&typeof o!="number"&&Yt(e,i,o)&&(i=o=t),o=o===t?G:o>>>0,o?(e=Le(e),e&&(typeof i=="string"||i!=null&&!Ua(i))&&(i=fr(i),!i&&Yi(e))?_i(Ar(e),0,o):e.split(i,o)):[]}var $0=on(function(e,i,o){return e+(o?" ":"")+ka(i)});function N0(e,i,o){return e=Le(e),o=o==null?0:Di(me(o),0,e.length),i=fr(i),e.slice(o,o+i.length)==i}function D0(e,i,o){var u=d.templateSettings;o&&Yt(e,i,o)&&(i=t),e=Le(e),i=co({},i,u,Qu);var f=co({},i.imports,u.imports,Qu),g=Mt(f),w=ta(f,g),b,P,L=0,q=i.interpolate||Bi,B="__p += '",J=ia((i.escape||Bi).source+"|"+q.source+"|"+(q===ct?Ao:Bi).source+"|"+(i.evaluate||Bi).source+"|$","g"),te="//# sourceURL="+(Me.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Go+"]")+`
`;e.replace(J,function(ae,Se,Ae,dr,Xt,gr){return Ae||(Ae=dr),B+=e.slice(L,gr).replace(Fo,up),Se&&(b=!0,B+=`' +
__e(`+Se+`) +
'`),Xt&&(P=!0,B+=`';
`+Xt+`;
__p += '`),Ae&&(B+=`' +
((__t = (`+Ae+`)) == null ? '' : __t) +
'`),L=gr+ae.length,ae}),B+=`';
`;var oe=Me.call(i,"variable")&&i.variable;if(!oe)B=`with (obj) {
`+B+`
}
`;else if(Oo.test(oe))throw new de(p);B=(P?B.replace(Lr,""):B).replace(Wt,"$1").replace(kr,"$1;"),B="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+B+`return __p
}`;var be=Hh(function(){return Fe(g,te+"return "+B).apply(t,w)});if(be.source=B,za(be))throw be;return be}function F0(e){return Le(e).toLowerCase()}function j0(e){return Le(e).toUpperCase()}function L0(e,i,o){if(e=Le(e),e&&(o||i===t))return Yc(e);if(!e||!(i=fr(i)))return e;var u=Ar(e),f=Ar(i),g=Xc(u,f),w=Zc(u,f)+1;return _i(u,g,w).join("")}function q0(e,i,o){if(e=Le(e),e&&(o||i===t))return e.slice(0,tu(e)+1);if(!e||!(i=fr(i)))return e;var u=Ar(e),f=Zc(u,Ar(i))+1;return _i(u,0,f).join("")}function M0(e,i,o){if(e=Le(e),e&&(o||i===t))return e.replace(gt,"");if(!e||!(i=fr(i)))return e;var u=Ar(e),f=Xc(u,Ar(i));return _i(u,f).join("")}function z0(e,i){var o=re,u=ue;if(ut(i)){var f="separator"in i?i.separator:f;o="length"in i?me(i.length):o,u="omission"in i?fr(i.omission):u}e=Le(e);var g=e.length;if(Yi(e)){var w=Ar(e);g=w.length}if(o>=g)return e;var b=o-Xi(u);if(b<1)return u;var P=w?_i(w,0,b).join(""):e.slice(0,b);if(f===t)return P+u;if(w&&(b+=P.length-b),Ua(f)){if(e.slice(b).search(f)){var L,q=P;for(f.global||(f=ia(f.source,Le(yr.exec(f))+"g")),f.lastIndex=0;L=f.exec(q);)var B=L.index;P=P.slice(0,B===t?b:B)}}else if(e.indexOf(fr(f),b)!=b){var J=P.lastIndexOf(f);J>-1&&(P=P.slice(0,J))}return P+u}function U0(e){return e=Le(e),e&&lt.test(e)?e.replace(ui,yp):e}var H0=on(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),ka=Bu("toUpperCase");function Uh(e,i,o){return e=Le(e),i=o?t:i,i===t?lp(e)?mp(e):rp(e):e.match(i)||[]}var Hh=Ie(function(e,i){try{return qt(e,t,i)}catch(o){return za(o)?o:new de(o)}}),B0=Yr(function(e,i){return _r(i,function(o){o=Hr(o),Jr(e,o,qa(e[o],e))}),e});function k0(e){var i=e==null?0:e.length,o=se();return e=i?nt(e,function(u){if(typeof u[1]!="function")throw new mr(l);return[o(u[0]),u[1]]}):[],Ie(function(u){for(var f=-1;++f<i;){var g=e[f];if(qt(g[0],this,u))return qt(g[1],this,u)}})}function V0(e){return yd(br(e,j))}function Va(e){return function(){return e}}function K0(e,i){return e==null||e!==e?i:e}var G0=Vu(),W0=Vu(!0);function or(e){return e}function Ka(e){return bu(typeof e=="function"?e:br(e,j))}function J0(e){return xu(br(e,j))}function Q0(e,i){return Iu(e,br(i,j))}var Y0=Ie(function(e,i){return function(o){return An(o,e,i)}}),X0=Ie(function(e,i){return function(o){return An(e,o,i)}});function Ga(e,i,o){var u=Mt(i),f=Bs(i,u);o==null&&!(ut(i)&&(f.length||!u.length))&&(o=i,i=e,e=this,f=Bs(i,Mt(i)));var g=!(ut(o)&&"chain"in o)||!!o.chain,w=Zr(e);return _r(f,function(b){var P=i[b];e[b]=P,w&&(e.prototype[b]=function(){var L=this.__chain__;if(g||L){var q=e(this.__wrapped__),B=q.__actions__=ir(this.__actions__);return B.push({func:P,args:arguments,thisArg:e}),q.__chain__=L,q}return P.apply(e,fi([this.value()],arguments))})}),e}function Z0(){return Re._===this&&(Re._=Sp),this}function Wa(){}function e_(e){return e=me(e),Ie(function(i){return Su(i,e)})}var t_=Sa(nt),r_=Sa(Kc),i_=Sa(Qo);function Bh(e){return $a(e)?Yo(Hr(e)):Nd(e)}function n_(e){return function(i){return e==null?t:Fi(e,i)}}var s_=Gu(),o_=Gu(!0);function Ja(){return[]}function Qa(){return!1}function a_(){return{}}function c_(){return""}function u_(){return!0}function h_(e,i){if(e=me(e),e<1||e>V)return[];var o=G,u=kt(e,G);i=se(i),e-=G;for(var f=ea(u,i);++o<e;)i(o);return f}function l_(e){return _e(e)?nt(e,Hr):pr(e)?[e]:ir(uh(Le(e)))}function f_(e){var i=++xp;return Le(e)+i}var p_=Js(function(e,i){return e+i},0),d_=Pa("ceil"),g_=Js(function(e,i){return e/i},1),y_=Pa("floor");function v_(e){return e&&e.length?Hs(e,or,la):t}function __(e,i){return e&&e.length?Hs(e,se(i,2),la):t}function m_(e){return Jc(e,or)}function w_(e,i){return Jc(e,se(i,2))}function b_(e){return e&&e.length?Hs(e,or,ga):t}function E_(e,i){return e&&e.length?Hs(e,se(i,2),ga):t}var x_=Js(function(e,i){return e*i},1),I_=Pa("round"),S_=Js(function(e,i){return e-i},0);function P_(e){return e&&e.length?Zo(e,or):0}function O_(e,i){return e&&e.length?Zo(e,se(i,2)):0}return d.after=Jy,d.ary=wh,d.assign=jv,d.assignIn=Dh,d.assignInWith=co,d.assignWith=Lv,d.at=qv,d.before=bh,d.bind=qa,d.bindAll=B0,d.bindKey=Eh,d.castArray=av,d.chain=vh,d.chunk=yg,d.compact=vg,d.concat=_g,d.cond=k0,d.conforms=V0,d.constant=Va,d.countBy=Py,d.create=Mv,d.curry=xh,d.curryRight=Ih,d.debounce=Sh,d.defaults=zv,d.defaultsDeep=Uv,d.defer=Qy,d.delay=Yy,d.difference=mg,d.differenceBy=wg,d.differenceWith=bg,d.drop=Eg,d.dropRight=xg,d.dropRightWhile=Ig,d.dropWhile=Sg,d.fill=Pg,d.filter=Ry,d.flatMap=Cy,d.flatMapDeep=$y,d.flatMapDepth=Ny,d.flatten=ph,d.flattenDeep=Og,d.flattenDepth=Rg,d.flip=Xy,d.flow=G0,d.flowRight=W0,d.fromPairs=Ag,d.functions=Wv,d.functionsIn=Jv,d.groupBy=Dy,d.initial=Cg,d.intersection=$g,d.intersectionBy=Ng,d.intersectionWith=Dg,d.invert=Yv,d.invertBy=Xv,d.invokeMap=jy,d.iteratee=Ka,d.keyBy=Ly,d.keys=Mt,d.keysIn=sr,d.map=ro,d.mapKeys=e0,d.mapValues=t0,d.matches=J0,d.matchesProperty=Q0,d.memoize=no,d.merge=r0,d.mergeWith=Fh,d.method=Y0,d.methodOf=X0,d.mixin=Ga,d.negate=so,d.nthArg=e_,d.omit=i0,d.omitBy=n0,d.once=Zy,d.orderBy=qy,d.over=t_,d.overArgs=ev,d.overEvery=r_,d.overSome=i_,d.partial=Ma,d.partialRight=Ph,d.partition=My,d.pick=s0,d.pickBy=jh,d.property=Bh,d.propertyOf=n_,d.pull=qg,d.pullAll=gh,d.pullAllBy=Mg,d.pullAllWith=zg,d.pullAt=Ug,d.range=s_,d.rangeRight=o_,d.rearg=tv,d.reject=Hy,d.remove=Hg,d.rest=rv,d.reverse=ja,d.sampleSize=ky,d.set=a0,d.setWith=c0,d.shuffle=Vy,d.slice=Bg,d.sortBy=Wy,d.sortedUniq=Qg,d.sortedUniqBy=Yg,d.split=C0,d.spread=iv,d.tail=Xg,d.take=Zg,d.takeRight=ey,d.takeRightWhile=ty,d.takeWhile=ry,d.tap=vy,d.throttle=nv,d.thru=to,d.toArray=Ch,d.toPairs=Lh,d.toPairsIn=qh,d.toPath=l_,d.toPlainObject=Nh,d.transform=u0,d.unary=sv,d.union=iy,d.unionBy=ny,d.unionWith=sy,d.uniq=oy,d.uniqBy=ay,d.uniqWith=cy,d.unset=h0,d.unzip=La,d.unzipWith=yh,d.update=l0,d.updateWith=f0,d.values=un,d.valuesIn=p0,d.without=uy,d.words=Uh,d.wrap=ov,d.xor=hy,d.xorBy=ly,d.xorWith=fy,d.zip=py,d.zipObject=dy,d.zipObjectDeep=gy,d.zipWith=yy,d.entries=Lh,d.entriesIn=qh,d.extend=Dh,d.extendWith=co,Ga(d,d),d.add=p_,d.attempt=Hh,d.camelCase=v0,d.capitalize=Mh,d.ceil=d_,d.clamp=d0,d.clone=cv,d.cloneDeep=hv,d.cloneDeepWith=lv,d.cloneWith=uv,d.conformsTo=fv,d.deburr=zh,d.defaultTo=K0,d.divide=g_,d.endsWith=_0,d.eq=Cr,d.escape=m0,d.escapeRegExp=w0,d.every=Oy,d.find=Ay,d.findIndex=lh,d.findKey=Hv,d.findLast=Ty,d.findLastIndex=fh,d.findLastKey=Bv,d.floor=y_,d.forEach=_h,d.forEachRight=mh,d.forIn=kv,d.forInRight=Vv,d.forOwn=Kv,d.forOwnRight=Gv,d.get=Ha,d.gt=pv,d.gte=dv,d.has=Qv,d.hasIn=Ba,d.head=dh,d.identity=or,d.includes=Fy,d.indexOf=Tg,d.inRange=g0,d.invoke=Zv,d.isArguments=qi,d.isArray=_e,d.isArrayBuffer=gv,d.isArrayLike=nr,d.isArrayLikeObject=bt,d.isBoolean=yv,d.isBuffer=mi,d.isDate=vv,d.isElement=_v,d.isEmpty=mv,d.isEqual=wv,d.isEqualWith=bv,d.isError=za,d.isFinite=Ev,d.isFunction=Zr,d.isInteger=Oh,d.isLength=oo,d.isMap=Rh,d.isMatch=xv,d.isMatchWith=Iv,d.isNaN=Sv,d.isNative=Pv,d.isNil=Rv,d.isNull=Ov,d.isNumber=Ah,d.isObject=ut,d.isObjectLike=vt,d.isPlainObject=Fn,d.isRegExp=Ua,d.isSafeInteger=Av,d.isSet=Th,d.isString=ao,d.isSymbol=pr,d.isTypedArray=cn,d.isUndefined=Tv,d.isWeakMap=Cv,d.isWeakSet=$v,d.join=Fg,d.kebabCase=b0,d.last=xr,d.lastIndexOf=jg,d.lowerCase=E0,d.lowerFirst=x0,d.lt=Nv,d.lte=Dv,d.max=v_,d.maxBy=__,d.mean=m_,d.meanBy=w_,d.min=b_,d.minBy=E_,d.stubArray=Ja,d.stubFalse=Qa,d.stubObject=a_,d.stubString=c_,d.stubTrue=u_,d.multiply=x_,d.nth=Lg,d.noConflict=Z0,d.noop=Wa,d.now=io,d.pad=I0,d.padEnd=S0,d.padStart=P0,d.parseInt=O0,d.random=y0,d.reduce=zy,d.reduceRight=Uy,d.repeat=R0,d.replace=A0,d.result=o0,d.round=I_,d.runInContext=S,d.sample=By,d.size=Ky,d.snakeCase=T0,d.some=Gy,d.sortedIndex=kg,d.sortedIndexBy=Vg,d.sortedIndexOf=Kg,d.sortedLastIndex=Gg,d.sortedLastIndexBy=Wg,d.sortedLastIndexOf=Jg,d.startCase=$0,d.startsWith=N0,d.subtract=S_,d.sum=P_,d.sumBy=O_,d.template=D0,d.times=h_,d.toFinite=ei,d.toInteger=me,d.toLength=$h,d.toLower=F0,d.toNumber=Ir,d.toSafeInteger=Fv,d.toString=Le,d.toUpper=j0,d.trim=L0,d.trimEnd=q0,d.trimStart=M0,d.truncate=z0,d.unescape=U0,d.uniqueId=f_,d.upperCase=H0,d.upperFirst=ka,d.each=_h,d.eachRight=mh,d.first=dh,Ga(d,function(){var e={};return zr(d,function(i,o){Me.call(d.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),d.VERSION=n,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),_r(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===t?1:jt(me(o),0);var u=this.__filtered__&&!i?new Oe(this):this.clone();return u.__filtered__?u.__takeCount__=kt(o,u.__takeCount__):u.__views__.push({size:kt(o,G),type:e+(u.__dir__<0?"Right":"")}),u},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),_r(["filter","map","takeWhile"],function(e,i){var o=i+1,u=o==_||o==Y;Oe.prototype[e]=function(f){var g=this.clone();return g.__iteratees__.push({iteratee:se(f,3),type:o}),g.__filtered__=g.__filtered__||u,g}}),_r(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),_r(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(or)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=Ie(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return An(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(so(se(e)))},Oe.prototype.slice=function(e,i){e=me(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==t&&(i=me(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(G)},zr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=d[u?"take"+(i=="last"?"Right":""):i],g=u||/^find/.test(i);f&&(d.prototype[i]=function(){var w=this.__wrapped__,b=u?[1]:arguments,P=w instanceof Oe,L=b[0],q=P||_e(w),B=function(Se){var Ae=f.apply(d,fi([Se],b));return u&&J?Ae[0]:Ae};q&&o&&typeof L=="function"&&L.length!=1&&(P=q=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=g&&!J,be=P&&!te;if(!g&&q){w=be?w:new Oe(this);var ae=e.apply(w,b);return ae.__actions__.push({func:to,args:[B],thisArg:t}),new wr(ae,J)}return oe&&be?e.apply(this,b):(ae=this.thru(B),oe?u?ae.value()[0]:ae.value():ae)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var i=Os[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var g=this.value();return i.apply(_e(g)?g:[],f)}return this[o](function(w){return i.apply(_e(w)?w:[],f)})}}),zr(Oe.prototype,function(e,i){var o=d[i];if(o){var u=o.name+"";Me.call(rn,u)||(rn[u]=[]),rn[u].push({name:i,func:o})}}),rn[Ws(t,Ee).name]=[{name:"wrapper",func:t}],Oe.prototype.clone=Up,Oe.prototype.reverse=Hp,Oe.prototype.value=Bp,d.prototype.at=_y,d.prototype.chain=my,d.prototype.commit=wy,d.prototype.next=by,d.prototype.plant=xy,d.prototype.reverse=Iy,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=Sy,d.prototype.first=d.prototype.head,En&&(d.prototype[En]=Ey),d},Zi=wp();wt?((wt.exports=Zi)._=Zi,Ge._=Zi):Re._=Zi}).call(Vn)})(Tc,Tc.exports);var Jx=Object.defineProperty,Qx=Object.defineProperties,Yx=Object.getOwnPropertyDescriptors,Kl=Object.getOwnPropertySymbols,Xx=Object.prototype.hasOwnProperty,Zx=Object.prototype.propertyIsEnumerable,Gl=(a,r,t)=>r in a?Jx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,lo=(a,r)=>{for(var t in r||(r={}))Xx.call(r,t)&&Gl(a,t,r[t]);if(Kl)for(var t of Kl(r))Zx.call(r,t)&&Gl(a,t,r[t]);return a},eI=(a,r)=>Qx(a,Yx(r));function xi(a,r,t){var n;const s=fm(a);return((n=r.rpcMap)==null?void 0:n[s.reference])||`${Wx}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function Hi(a){return a.includes(":")?a.split(":")[1]:a}function Jf(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function tI(a,r){const t=Object.keys(r.namespaces).filter(s=>s.includes(a));if(!t.length)return[];const n=[];return t.forEach(s=>{const c=r.namespaces[s].accounts;n.push(...c)}),n}function rI(a={},r={}){const t=Wl(a),n=Wl(r);return Tc.exports.merge(t,n)}function Wl(a){var r,t,n,s;const c={};if(!go(a))return c;for(const[l,p]of Object.entries(a)){const m=uf(l)?[l]:p.chains,y=p.methods||[],O=p.events||[],j=p.rpcMap||{},A=Kn(l);c[A]=eI(lo(lo({},c[A]),p),{chains:Xa(m,(r=c[A])==null?void 0:r.chains),methods:Xa(y,(t=c[A])==null?void 0:t.methods),events:Xa(O,(n=c[A])==null?void 0:n.events),rpcMap:lo(lo({},j),(s=c[A])==null?void 0:s.rpcMap)})}return c}function iI(a){return a.includes(":")?a.split(":")[2]:a}function nI(a){const r={};for(const[t,n]of Object.entries(a)){const s=n.methods||[],c=n.events||[],l=n.accounts||[],p=uf(t)?[t]:n.chains?n.chains:Jf(n.accounts);r[t]={chains:p,methods:s,events:c,accounts:l}}return r}function uc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Qf={},st=a=>Qf[a],hc=(a,r)=>{Qf[a]=r};class sI{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const s=Hi(t);r[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||xi(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new ai(new Ii(n,st("disableProviderPing")))}}class oI{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(parseInt(r),t),this.chainId=parseInt(r),this.events.emit(ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,t){const n=t||xi(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new ai(new Ii(n,st("disableProviderPing")))}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const s=parseInt(Hi(t));r[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}async handleSwitchChain(r){var t,n;let s=r.request.params?(t=r.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const c=parseInt(s,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class aI{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const s=Hi(t);r[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||xi(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new ai(new Ii(n,st("disableProviderPing")))}}class cI{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const s=Hi(t);r[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||xi(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new ai(new Ii(n,st("disableProviderPing")))}}class uI{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),s=Hi(t);r[s]=this.createHttpProvider(s,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}getCardanoRPCUrl(r){const t=this.namespace.rpcMap;if(t)return t[r]}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new ai(new Ii(n,st("disableProviderPing")))}}class hI{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const s=Hi(t);r[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||xi(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new ai(new Ii(n,st("disableProviderPing")))}}class lI{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const s=Hi(t);r[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||xi(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new ai(new Ii(n,st("disableProviderPing")))}}class fI{constructor(r){this.name="near",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||xi(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||xi(r,this.namespace);return typeof n>"u"?void 0:new ai(new Ii(n,st("disableProviderPing")))}}var pI=Object.defineProperty,dI=Object.defineProperties,gI=Object.getOwnPropertyDescriptors,Jl=Object.getOwnPropertySymbols,yI=Object.prototype.hasOwnProperty,vI=Object.prototype.propertyIsEnumerable,Ql=(a,r,t)=>r in a?pI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,fo=(a,r)=>{for(var t in r||(r={}))yI.call(r,t)&&Ql(a,t,r[t]);if(Jl)for(var t of Jl(r))vI.call(r,t)&&Ql(a,t,r[t]);return a},lc=(a,r)=>dI(a,gI(r));class kc{constructor(r){this.events=new Dc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||kl})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const t=new kc(r);return await t.initialize(),t}async request(r,t){const[n,s]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:fo({},r),chainId:`${n}:${s}`,topic:this.session.topic})}sendAsync(r,t,n){this.request(r,n).then(s=>t(null,s)).catch(s=>t(s,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:er("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}removeListener(r,t){this.events.removeListener(r,t)}off(r,t){this.events.off(r,t)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:s}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await s().then(c=>{this.session=c,this.namespaces||(this.namespaces=nI(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==Gf)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,t){try{if(!this.session)return;const[n,s]=this.validateChain(r);this.getProvider(n).setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(gn(t)){for(const n of t)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Ux.init({logger:this.providerOpts.logger||kl,relayUrl:this.providerOpts.relayUrl||Vx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(t=>Kn(t)))];hc("client",this.client),hc("events",this.events),hc("disableProviderPing",this.disableProviderPing),r.forEach(t=>{if(!this.session)return;const n=tI(t,this.session),s=Jf(n),c=rI(this.namespaces,this.optionalNamespaces),l=lc(fo({},c[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new oI({namespace:l});break;case"solana":this.rpcProviders[t]=new aI({namespace:l});break;case"cosmos":this.rpcProviders[t]=new cI({namespace:l});break;case"polkadot":this.rpcProviders[t]=new sI({namespace:l});break;case"cip34":this.rpcProviders[t]=new uI({namespace:l});break;case"elrond":this.rpcProviders[t]=new hI({namespace:l});break;case"multiversx":this.rpcProviders[t]=new lI({namespace:l});break;case"near":this.rpcProviders[t]=new fI({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:t}=r,{event:n}=t;if(n.name==="accountsChanged"){const s=n.data;s&&gn(s)&&this.events.emit("accountsChanged",s.map(iI))}else if(n.name==="chainChanged"){const s=t.chainId,c=t.event.data,l=Kn(s),p=uc(s)!==uc(c)?`${l}:${uc(c)}`:s;this.onChainChanged(p)}else this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:t})=>{var n;const{namespaces:s}=t,c=(n=this.client)==null?void 0:n.session.get(r);this.session=lc(fo({},c),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:t})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",lc(fo({},er("USER_DISCONNECTED")),{data:r.topic}))}),this.on(ci.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var t;this.getProvider(r).updateNamespace((t=this.session)==null?void 0:t.namespaces[r])})}setNamespaces(r){const{namespaces:t,optionalNamespaces:n,sessionProperties:s}=r;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.persist("namespaces",t),this.persist("optionalNamespaces",n)}validateChain(r){const[t,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(l=>Kn(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=Kn(Object.keys(this.namespaces)[0]),c=this.rpcProviders[s].getDefaultChain();return[s,c]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,t=!1){var n;if(!this.namespaces)return;const[s,c]=this.validateChain(r);t||this.getProvider(s).setDefaultChain(c),((n=this.namespaces[s])!=null?n:this.namespaces[`${s}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,t){this.client.core.storage.setItem(`${Vl}/${r}`,t)}async getFromStore(r){return await this.client.core.storage.getItem(`${Vl}/${r}`)}}const _I=kc,mI="wc",wI="ethereum_provider",bI=`${mI}@2:${wI}:`,EI="https://rpc.walletconnect.com/v1/",Cc=["eth_sendTransaction","personal_sign"],xI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],$c=["chainChanged","accountsChanged"],II=["chainChanged","accountsChanged","message","disconnect","connect"];var SI=Object.defineProperty,PI=Object.defineProperties,OI=Object.getOwnPropertyDescriptors,Yl=Object.getOwnPropertySymbols,RI=Object.prototype.hasOwnProperty,AI=Object.prototype.propertyIsEnumerable,Xl=(a,r,t)=>r in a?SI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Wn=(a,r)=>{for(var t in r||(r={}))RI.call(r,t)&&Xl(a,t,r[t]);if(Yl)for(var t of Yl(r))AI.call(r,t)&&Xl(a,t,r[t]);return a},Zl=(a,r)=>PI(a,OI(r));function mo(a){return Number(a[0].split(":")[1])}function fc(a){return`0x${a.toString(16)}`}function TI(a){const{chains:r,optionalChains:t,methods:n,optionalMethods:s,events:c,optionalEvents:l,rpcMap:p}=a;if(!gn(r))throw new Error("Invalid chains");const m={chains:r,methods:n||Cc,events:c||$c,rpcMap:Wn({},r.length?{[mo(r)]:p[mo(r)]}:{})},y=c==null?void 0:c.filter(M=>!$c.includes(M)),O=n==null?void 0:n.filter(M=>!Cc.includes(M));if(!t&&!l&&!s&&!(y!=null&&y.length)&&!(O!=null&&O.length))return{required:r.length?m:void 0};const j=(y==null?void 0:y.length)&&(O==null?void 0:O.length)||!t,A={chains:[...new Set(j?m.chains.concat(t||[]):t)],methods:[...new Set(m.methods.concat(s!=null&&s.length?s:xI))],events:[...new Set(m.events.concat(l!=null&&l.length?l:II))],rpcMap:p};return{required:r.length?m:void 0,optional:t.length?A:void 0}}class Vc{constructor(){this.events=new Pr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=bI,this.on=(r,t)=>(this.events.on(r,t),this),this.once=(r,t)=>(this.events.once(r,t),this),this.removeListener=(r,t)=>(this.events.removeListener(r,t),this),this.off=(r,t)=>(this.events.off(r,t),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const t=new Vc;return await t.initialize(r),t}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,t){this.signer.sendAsync(r,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:t,optional:n}=TI(this.rpc);try{const s=await new Promise(async(l,p)=>{var m;this.rpc.showQrModal&&((m=this.modal)==null||m.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Zl(Wn({namespaces:Wn({},t&&{[this.namespace]:t})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(y=>{l(y)}).catch(y=>{p(new Error(y.message))})});if(!s)return;const c=pm(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:fc(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:t}=r,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const t=parseInt(r);this.chainId=t,this.events.emit("chainChanged",fc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",Zl(Wn({},er("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var t,n;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const t=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",fc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const t=this.parseChainId(r);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(r){const[t,n,s]=r.split(":");return{chainId:`${t}:${n}`,address:s}}setAccounts(r){this.accounts=r.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var t,n;const s=(t=r==null?void 0:r.chains)!=null?t:[],c=(n=r==null?void 0:r.optionalChains)!=null?n:[],l=s.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=s.length?(r==null?void 0:r.methods)||Cc:[],m=s.length?(r==null?void 0:r.events)||$c:[],y=(r==null?void 0:r.optionalMethods)||[],O=(r==null?void 0:r.optionalEvents)||[],j=(r==null?void 0:r.rpcMap)||this.buildRpcMap(l,r.projectId),A=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(M=>this.formatChainId(M)),optionalChains:c.map(M=>this.formatChainId(M)),methods:p,events:m,optionalMethods:y,optionalEvents:O,rpcMap:j,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:A,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,t){const n={};return r.forEach(s=>{n[s]=this.getRpcUrl(s,t)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?mo(this.rpc.chains):mo(this.rpc.optionalChains),this.signer=await _I.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await dm(()=>import("./index-113e1b92.js").then(s=>s.i),["assets/index-113e1b92.js","assets/index-c2e11835.js","assets/index-de63768b.css"]);t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Wn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:t,optionalChains:n,rpcMap:s}=r;t&&gn(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)})),n&&gn(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)}))}getRpcUrl(r,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${EI}?chainId=eip155:${r}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(t=>this.parseAccount(t))}}const UI=Vc;export{UI as EthereumProvider,II as OPTIONAL_EVENTS,xI as OPTIONAL_METHODS,$c as REQUIRED_EVENTS,Cc as REQUIRED_METHODS,Vc as default};
